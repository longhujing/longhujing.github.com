<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>logback.xmlé…ç½®æ¨¡æ¿</title>
      <link href="2020/11/10/a1ed5817.html"/>
      <url>2020/11/10/a1ed5817.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘éœ€è¦ä½¿ç”¨åˆ°<code>logback</code>æ¥è®°å½•æ—¥å¿—ï¼Œè‹¦äºæ²¡æœ‰ç§¯ç´¯ï¼Œæ¸¸äº†å¤§åŠå¤©ç™¾åº¦ï¼Œå…ˆè®°ä¸‹æ¥ç•™ç€ä»¥åç”¨</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">debug</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å®šä¹‰æ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨åœ°å€ï¼Œåé¢é€šè¿‡$&#123;LOG_HOME&#125;è·å–ï¼Œå‹¿åœ¨ LogBack çš„é…ç½®ä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œå­˜åœ¨ç–‘é—®ï¼Ÿ æˆ‘è¿™é‡Œä½¿ç”¨ç›¸å¯¹åœ°å€å°±æ˜¯å½“å‰ç›®å½•ä¸‹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;LOG_HOME&quot;</span> <span class="attr">value</span>=<span class="string">&quot;logs&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¯é€‰ï¼šå®šä¹‰æ–‡ä»¶åç§° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;PROJECT_NAME&quot;</span> <span class="attr">value</span>=<span class="string">&quot;tortoise_blog&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ—¥å¿—æ–‡ä»¶ä¿å­˜æ—¶é—´ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxHistory&quot;</span> <span class="attr">value</span>=<span class="string">&quot;30&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxFileSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;10MB&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ€»æ–‡ä»¶å¤§å° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;totalSizeCap&quot;</span> <span class="attr">value</span>=<span class="string">&quot;50MB&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- appender å¿…é€‰èŠ‚ç‚¹ã€‚ä½œç”¨ï¼šæ—¥å¿—è¾“å‡ºç›®çš„åœ°ï¼Œ é…ç½®åç”± root æ ‡ç­¾è¿›è¡Œé€‰æ‹©æ§åˆ¶æ˜¯å¦è¾“å‡ºåˆ°ç›®çš„åœ° --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ§åˆ¶å°è¾“å‡º --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- encoder æ—¥å¿—æ ¼å¼åŒ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ ¼å¼åŒ–è¾“å‡ºï¼š%dè¡¨ç¤ºæ—¥æœŸï¼Œ%threadè¡¨ç¤ºçº¿ç¨‹åï¼Œ%-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ%næ˜¯æ¢è¡Œç¬¦ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- appender å¿…é€‰èŠ‚ç‚¹ã€‚ä½œç”¨ï¼šæ—¥å¿—è¾“å‡ºç›®çš„åœ°ï¼Œ é…ç½®åç”± root æ ‡ç­¾è¿›è¡Œé€‰æ‹©æ§åˆ¶æ˜¯å¦è¾“å‡ºåˆ°ç›®çš„åœ° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;INFO&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åªè®°å½•INFOçº§åˆ«æ—¥å¿— --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- rollingPolicy æ—¥å¿—ç”Ÿæˆç­–ç•¥ï¼Œä¸åŒçš„ç­–ç•¥ä¸åŒçš„ç±»ã€‚ ç‰¹åˆ«æ³¨æ„ï¼šå°ºå¯¸åˆ‡å‰²å’Œæ—¶é—´åˆ‡å‰²çš„æ—¥å¿—ç±»SizeAndTimeBasedRollingPolicy --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºçš„æ–‡ä»¶å --&gt;</span><span class="comment">&lt;!-- æŒ‰ç…§æ¯å¤©ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">FileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;/info/$&#123;PROJECT_NAME&#125;.%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">FileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•° --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>$&#123;maxHistory&#125;<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ¯ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œå•ä½ kbã€MB ç­‰ï¼Œè¿™ä¸ªåŠŸèƒ½æ§åˆ¶ä¸ç¨³å®šï¼Œå› ä¸ºæ‰“å°æ—¥å¿—é€Ÿåº¦å¤ªå¿«ï¼Œæ¯ä¸ªæ–‡ä»¶ä¼šå˜å¤§ã€‚ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>$&#123;maxFileSize&#125;<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ—¥å¿—æ€»ä½“ç§¯å¤§å°ï¼Œè¶…è¿‡äº†å°±ä¼šåˆ é™¤å‰é¢çš„æ—§æ—¥å¿—æ–‡ä»¶è…¾å‡ºç©ºé—´ï¼Œå¯ä»¥è¾¹æ‰“å°è¾¹çœ‹ç»“æœ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">totalSizeCap</span>&gt;</span>$&#123;totalSizeCap&#125;<span class="tag">&lt;/<span class="name">totalSizeCap</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- encoder æ—¥å¿—æ ¼å¼åŒ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ ¼å¼åŒ–è¾“å‡ºï¼š%dè¡¨ç¤ºæ—¥æœŸï¼Œ%threadè¡¨ç¤ºçº¿ç¨‹åï¼Œ%-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ%næ˜¯æ¢è¡Œç¬¦ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;DEBUG&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åªè®°å½•DEBUGçº§åˆ«æ—¥å¿— --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>DEBUG<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- rollingPolicy æ—¥å¿—ç”Ÿæˆç­–ç•¥ï¼Œä¸åŒçš„ç­–ç•¥ä¸åŒçš„ç±»ã€‚ ç‰¹åˆ«æ³¨æ„ï¼šå°ºå¯¸åˆ‡å‰²å’Œæ—¶é—´åˆ‡å‰²çš„æ—¥å¿—ç±»SizeAndTimeBasedRollingPolicy --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºçš„æ–‡ä»¶å --&gt;</span><span class="comment">&lt;!-- æŒ‰ç…§æ¯å¤©ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">FileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;/debug/$&#123;PROJECT_NAME&#125;.%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">FileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•° --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>$&#123;maxHistory&#125;<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ¯ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œå•ä½ kbã€MB ç­‰ï¼Œè¿™ä¸ªåŠŸèƒ½æ§åˆ¶ä¸ç¨³å®šï¼Œå› ä¸ºæ‰“å°æ—¥å¿—é€Ÿåº¦å¤ªå¿«ï¼Œæ¯ä¸ªæ–‡ä»¶ä¼šå˜å¤§ã€‚ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>$&#123;maxFileSize&#125;<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ—¥å¿—æ€»ä½“ç§¯å¤§å°ï¼Œè¶…è¿‡äº†å°±ä¼šåˆ é™¤å‰é¢çš„æ—§æ—¥å¿—æ–‡ä»¶è…¾å‡ºç©ºé—´ï¼Œå¯ä»¥è¾¹æ‰“å°è¾¹çœ‹ç»“æœ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">totalSizeCap</span>&gt;</span>$&#123;totalSizeCap&#125;<span class="tag">&lt;/<span class="name">totalSizeCap</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- encoder æ—¥å¿—æ ¼å¼åŒ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ ¼å¼åŒ–è¾“å‡ºï¼š%dè¡¨ç¤ºæ—¥æœŸï¼Œ%threadè¡¨ç¤ºçº¿ç¨‹åï¼Œ%-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ%næ˜¯æ¢è¡Œç¬¦ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;WARN&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åªè®°å½•WARNçº§åˆ«æ—¥å¿— --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>WARN<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- rollingPolicy æ—¥å¿—ç”Ÿæˆç­–ç•¥ï¼Œä¸åŒçš„ç­–ç•¥ä¸åŒçš„ç±»ã€‚ ç‰¹åˆ«æ³¨æ„ï¼šå°ºå¯¸åˆ‡å‰²å’Œæ—¶é—´åˆ‡å‰²çš„æ—¥å¿—ç±»SizeAndTimeBasedRollingPolicy --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºçš„æ–‡ä»¶å --&gt;</span><span class="comment">&lt;!-- æŒ‰ç…§æ¯å¤©ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">FileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;/warn/$&#123;PROJECT_NAME&#125;.%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">FileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•° --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>$&#123;maxHistory&#125;<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ¯ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œå•ä½ kbã€MB ç­‰ï¼Œè¿™ä¸ªåŠŸèƒ½æ§åˆ¶ä¸ç¨³å®šï¼Œå› ä¸ºæ‰“å°æ—¥å¿—é€Ÿåº¦å¤ªå¿«ï¼Œæ¯ä¸ªæ–‡ä»¶ä¼šå˜å¤§ã€‚ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>$&#123;maxFileSize&#125;<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ—¥å¿—æ€»ä½“ç§¯å¤§å°ï¼Œè¶…è¿‡äº†å°±ä¼šåˆ é™¤å‰é¢çš„æ—§æ—¥å¿—æ–‡ä»¶è…¾å‡ºç©ºé—´ï¼Œå¯ä»¥è¾¹æ‰“å°è¾¹çœ‹ç»“æœ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">totalSizeCap</span>&gt;</span>$&#123;totalSizeCap&#125;<span class="tag">&lt;/<span class="name">totalSizeCap</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- encoder æ—¥å¿—æ ¼å¼åŒ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ ¼å¼åŒ–è¾“å‡ºï¼š%dè¡¨ç¤ºæ—¥æœŸï¼Œ%threadè¡¨ç¤ºçº¿ç¨‹åï¼Œ%-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ%næ˜¯æ¢è¡Œç¬¦ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ERROR&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åªè®°å½•INFOçº§åˆ«æ—¥å¿— --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>ERROR<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- rollingPolicy æ—¥å¿—ç”Ÿæˆç­–ç•¥ï¼Œä¸åŒçš„ç­–ç•¥ä¸åŒçš„ç±»ã€‚ ç‰¹åˆ«æ³¨æ„ï¼šå°ºå¯¸åˆ‡å‰²å’Œæ—¶é—´åˆ‡å‰²çš„æ—¥å¿—ç±»SizeAndTimeBasedRollingPolicy --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºçš„æ–‡ä»¶å --&gt;</span><span class="comment">&lt;!-- æŒ‰ç…§æ¯å¤©ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">FileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;/error/$&#123;PROJECT_NAME&#125;.%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">FileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•° --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>$&#123;maxHistory&#125;<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ¯ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œå•ä½ kbã€MB ç­‰ï¼Œè¿™ä¸ªåŠŸèƒ½æ§åˆ¶ä¸ç¨³å®šï¼Œå› ä¸ºæ‰“å°æ—¥å¿—é€Ÿåº¦å¤ªå¿«ï¼Œæ¯ä¸ªæ–‡ä»¶ä¼šå˜å¤§ã€‚ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>$&#123;maxFileSize&#125;<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ—¥å¿—æ€»ä½“ç§¯å¤§å°ï¼Œè¶…è¿‡äº†å°±ä¼šåˆ é™¤å‰é¢çš„æ—§æ—¥å¿—æ–‡ä»¶è…¾å‡ºç©ºé—´ï¼Œå¯ä»¥è¾¹æ‰“å°è¾¹çœ‹ç»“æœ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">totalSizeCap</span>&gt;</span>$&#123;totalSizeCap&#125;<span class="tag">&lt;/<span class="name">totalSizeCap</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- encoder æ—¥å¿—æ ¼å¼åŒ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ ¼å¼åŒ–è¾“å‡ºï¼š%dè¡¨ç¤ºæ—¥æœŸï¼Œ%threadè¡¨ç¤ºçº¿ç¨‹åï¼Œ%-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ%næ˜¯æ¢è¡Œç¬¦ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- rootå¿…é€‰èŠ‚ç‚¹ï¼š1.åŸºç¡€çš„æ—¥å¿—è¾“å‡ºçº§åˆ«é…ç½®ï¼Œ2.æ§åˆ¶é‚£äº›appenderè¾“å‡º --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ³¨æ„ï¼šå…¨éƒ¨æ³¨é‡Šäº†ï¼Œé‚£ä¹ˆä¸è¾“å‡ºæ—¥å¿—äº†ã€‚ ä½†æ˜¯ä¸å½±å“ logger æ ‡ç­¾çš„é…ç½®è¾“å‡ºã€‚ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;INFO&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;WARN&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ERROR&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;DEBUG&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> logback </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥å¿— </tag>
            
            <tag> logback </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kongç½‘å…³åŠWebæ§åˆ¶å°å®‰è£…</title>
      <link href="2020/11/08/6b05edee.html"/>
      <url>2020/11/08/6b05edee.html</url>
      
        <content type="html"><![CDATA[<p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201108131854.svg"></p><div class="note info simple"><p>æœ¬æ–‡ä¸»è¦æè¿°åœ¨<code>Centos7</code>ä¸­ï¼Œå¦‚ä½•é€šè¿‡<code>Docker</code>å®‰è£…<code>Kong</code>ç½‘å…³ä»¥åŠWebæ§åˆ¶å°</p></div><h2 id="åˆ›å»ºDockerç½‘ç»œ"><a href="#åˆ›å»ºDockerç½‘ç»œ" class="headerlink" title="åˆ›å»ºDockerç½‘ç»œ"></a>åˆ›å»ºDockerç½‘ç»œ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network create kong-net</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®åº“ç¯å¢ƒå‡†å¤‡"><a href="#æ•°æ®åº“ç¯å¢ƒå‡†å¤‡" class="headerlink" title="æ•°æ®åº“ç¯å¢ƒå‡†å¤‡"></a>æ•°æ®åº“ç¯å¢ƒå‡†å¤‡</h2><div class="note info simple"><p>è¿™é‡Œä½¿ç”¨çš„æ•°æ®åº“æ˜¯PostgreSQL</p><p>ç‰ˆæœ¬å¿…é¡»æ˜¯9.6ï¼Œä¸è¦ä½¿ç”¨å¤ªé«˜çš„ç‰ˆæœ¬ï¼Œä¸ç„¶åé¢å®‰è£…æ§åˆ¶å°ä¼šæŠ¥é”™!</p><p>è¿™é‡Œçš„ç”¨æˆ·åå’Œå¯†ç ç»Ÿä¸€ä½¿ç”¨<code>kong</code>ï¼Œå¯ä»¥è‡ªå®šä¹‰</p></div><h3 id="å®‰è£…æ•°æ®åº“"><a href="#å®‰è£…æ•°æ®åº“" class="headerlink" title="å®‰è£…æ•°æ®åº“"></a>å®‰è£…æ•°æ®åº“</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name kong-database \</span><br><span class="line">               --network=kong-net \</span><br><span class="line">               -p 5432:5432 \</span><br><span class="line">               -e <span class="string">&quot;POSTGRES_USER=kong&quot;</span> \</span><br><span class="line">               -e <span class="string">&quot;POSTGRES_DB=kong&quot;</span> \</span><br><span class="line">               -e <span class="string">&quot;KONG_PG_PASSWORD=kong&quot;</span> \</span><br><span class="line">               -e <span class="string">&quot;POSTGRES_PASSWORD=kong&quot;</span> \</span><br><span class="line">               postgres:9.6</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºæ•°æ®åº“"><a href="#åˆ›å»ºæ•°æ®åº“" class="headerlink" title="åˆ›å»ºæ•°æ®åº“"></a>åˆ›å»ºæ•°æ®åº“</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run --rm \</span><br><span class="line">     --network=kong-net \</span><br><span class="line">     -e <span class="string">&quot;KONG_DATABASE=postgres&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_PG_HOST=kong-database&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_PG_USER=kong&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_PG_PASSWORD=kong&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_CASSANDRA_CONTACT_POINTS=kong-database&quot;</span> \</span><br><span class="line">     kong:latest kong migrations bootstrap</span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨Kong"><a href="#å¯åŠ¨Kong" class="headerlink" title="å¯åŠ¨Kong"></a>å¯åŠ¨Kong</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name kong \</span><br><span class="line">     --network=kong-net \</span><br><span class="line">     -e <span class="string">&quot;KONG_DATABASE=postgres&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_PG_HOST=kong-database&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_PG_USER=kong&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_PG_PASSWORD=kong&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_CASSANDRA_CONTACT_POINTS=kong-database&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_PROXY_ACCESS_LOG=/dev/stdout&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_ADMIN_ACCESS_LOG=/dev/stdout&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_PROXY_ERROR_LOG=/dev/stderr&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_ADMIN_ERROR_LOG=/dev/stderr&quot;</span> \</span><br><span class="line">     -e <span class="string">&quot;KONG_ADMIN_LISTEN=0.0.0.0:8001, 0.0.0.0:8444 ssl&quot;</span> \</span><br><span class="line">     -p 8000:8000 \</span><br><span class="line">     -p 8443:8443 \</span><br><span class="line">     -p 8001:8001 \</span><br><span class="line">     -p 8444:8444 \</span><br><span class="line">     kong:latest</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•Kongæ˜¯å¦å¯åŠ¨æˆåŠŸ"><a href="#æµ‹è¯•Kongæ˜¯å¦å¯åŠ¨æˆåŠŸ" class="headerlink" title="æµ‹è¯•Kongæ˜¯å¦å¯åŠ¨æˆåŠŸ"></a>æµ‹è¯•Kongæ˜¯å¦å¯åŠ¨æˆåŠŸ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i http://localhost:8001/</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…æ§åˆ¶å°"><a href="#å®‰è£…æ§åˆ¶å°" class="headerlink" title="å®‰è£…æ§åˆ¶å°"></a>å®‰è£…æ§åˆ¶å°</h2><h3 id="kong-dashboard"><a href="#kong-dashboard" class="headerlink" title="kong-dashboard"></a>kong-dashboard</h3><div class="note info simple"><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>kong-dashboard</code>ä¸æ”¯æŒ<code>kong v2.0+</code>ï¼Œé«˜ç‰ˆæœ¬çš„<code>kong</code>è¯·é€‰æ‹©ä½¿ç”¨<code>konga</code></p></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --netword kong-net --name kong-dashboard -p 8080:8080 pgbi/kong-dashboard start --kong-url http://localhost:8001  --basic-auth kongUser=kong</span><br></pre></td></tr></table></figure><h3 id="konga"><a href="#konga" class="headerlink" title="konga"></a>konga</h3><h4 id="å‡†å¤‡æ•°æ®åº“ç¯å¢ƒ"><a href="#å‡†å¤‡æ•°æ®åº“ç¯å¢ƒ" class="headerlink" title="å‡†å¤‡æ•°æ®åº“ç¯å¢ƒ"></a>å‡†å¤‡æ•°æ®åº“ç¯å¢ƒ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --rm pantsel/konga:latest -c prepare -a postgres -u postgresql://kong:kong@localhost:5432/konga</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 1337:1337 \</span><br><span class="line">        --network kong-net \</span><br><span class="line">        --name konga \</span><br><span class="line">        -e <span class="string">&quot;NODE_ENV=production&quot;</span>  \</span><br><span class="line">        -e <span class="string">&quot;DB_ADAPTER=postgres&quot;</span> \</span><br><span class="line">        -e <span class="string">&quot;DB_URI=postgresql://kong:kong@localhost:5432/konga&quot;</span> \</span><br><span class="line">        pantsel/konga</span><br></pre></td></tr></table></figure><p>è®¿é—®<code>http://localhost:1337/</code>æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201108131652.png"></p>]]></content>
      
      
      <categories>
          
          <category> Kong </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘å…³ </tag>
            
            <tag> Kong </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GitBash ä¸»é¢˜</title>
      <link href="2020/11/03/4dbe01c1.html"/>
      <url>2020/11/03/4dbe01c1.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>Windowså®‰è£…çš„GitBashåˆå§‹çš„æ—¶å€™ä¸‘çš„ä¸€æ¯”ï¼Œå¯¹äºæˆ‘è¿™ç§è¿½ç©¶å¤–è¡¨ã€çˆ±æ£é¼“ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿç©æ„çš„äººæ˜¯æ— æ³•æ¥å—çš„ğŸ˜‚</p></blockquote><h2 id="è®¾ç½®GitBashä¸»é¢˜"><a href="#è®¾ç½®GitBashä¸»é¢˜" class="headerlink" title="è®¾ç½®GitBashä¸»é¢˜"></a>è®¾ç½®GitBashä¸»é¢˜</h2><div class="note info simple"><p>æ‰“å¼€<code>GitBash</code>ï¼Œè¾“å…¥å‘½ä»¤<code>vim ~/.minttyrc</code></p></div><h3 id="ä¸»é¢˜1"><a href="#ä¸»é¢˜1" class="headerlink" title="ä¸»é¢˜1"></a>ä¸»é¢˜1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">BoldAsFont&#x3D;-1</span><br><span class="line">FontHeight&#x3D;12</span><br><span class="line">Scrollbar&#x3D;none</span><br><span class="line">Term&#x3D;xterm-256color</span><br><span class="line">BoldAsColour&#x3D;yes</span><br><span class="line">Black&#x3D;7,54,66</span><br><span class="line">Red&#x3D;220,50,47</span><br><span class="line">Green&#x3D;133,153,0</span><br><span class="line">Yellow&#x3D;181,137,0</span><br><span class="line">Blue&#x3D;38,139,210</span><br><span class="line">Magenta&#x3D;211,54,130</span><br><span class="line">Cyan&#x3D;42,161,152</span><br><span class="line">White&#x3D;238,232,213</span><br><span class="line">BoldBlack&#x3D;0,43,54</span><br><span class="line">BoldRed&#x3D;203,75,22</span><br><span class="line">BoldGreen&#x3D;88,110,117</span><br><span class="line">BoldYellow&#x3D;101,123,131</span><br><span class="line">BoldBlue&#x3D;131,148,150</span><br><span class="line">BoldMagenta&#x3D;108,113,196</span><br><span class="line">BoldCyan&#x3D;147,161,161</span><br><span class="line">BoldWhite&#x3D;253,246,227</span><br><span class="line">ForegroundColour&#x3D;192,192,192</span><br><span class="line">BackgroundColour&#x3D;0,43,54</span><br><span class="line">CursorColour&#x3D;133,153,0</span><br><span class="line">Columns&#x3D;140</span><br><span class="line">Rows&#x3D;40</span><br><span class="line"></span><br><span class="line">Locale&#x3D;zh_CN</span><br><span class="line">Charset&#x3D;UTF-8</span><br><span class="line">Font&#x3D;YaHei Consolas Hybrid</span><br><span class="line">Transparency&#x3D;off</span><br><span class="line">CursorType&#x3D;block</span><br><span class="line">CursorBlinks&#x3D;yes</span><br></pre></td></tr></table></figure><p>æ•ˆæœå°±æ˜¯è¿™æ ·å•¦</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201103014402.jpg"></p><h3 id="ä¸»é¢˜2"><a href="#ä¸»é¢˜2" class="headerlink" title="ä¸»é¢˜2"></a>ä¸»é¢˜2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Font&#x3D;Consolas</span><br><span class="line">FontHeight&#x3D;9</span><br><span class="line"></span><br><span class="line">BackgroundColour&#x3D;216,230,206</span><br><span class="line">ForegroundColour&#x3D;0,0,0</span><br><span class="line">CursorColour&#x3D;0,0,0</span><br><span class="line">Black&#x3D;0,0,0</span><br><span class="line">BoldBlack&#x3D;0,0,0</span><br><span class="line">Red&#x3D;130,68,6</span><br><span class="line">BoldRed&#x3D;246,155,64</span><br><span class="line">Green&#x3D;6,130,68</span><br><span class="line">BoldGreen&#x3D;64,246,155</span><br><span class="line">Yellow&#x3D;68,130,6</span><br><span class="line">BoldYellow&#x3D;155,246,64</span><br><span class="line">Blue&#x3D;68,6,130</span><br><span class="line">BoldBlue&#x3D;155,64,246</span><br><span class="line">Magenta&#x3D;130,6,68</span><br><span class="line">BoldMagenta&#x3D;246,64,155</span><br><span class="line">Cyan&#x3D;6,68,130</span><br><span class="line">BoldCyan&#x3D;64,155,246</span><br><span class="line">White&#x3D;255,255,255</span><br><span class="line">BoldWhite&#x3D;255,255,255</span><br><span class="line"></span><br><span class="line">Columns&#x3D;120</span><br><span class="line">Rows&#x3D;34</span><br><span class="line">CursorType&#x3D;block</span><br><span class="line">BoldAsFont&#x3D;-1</span><br><span class="line">FontWeight&#x3D;400</span><br><span class="line">FontIsBold&#x3D;no</span><br></pre></td></tr></table></figure><p>æ•ˆæœå°±æ˜¯è¿™æ ·å•¦~</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201103014439.png"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GitBash </tag>
            
            <tag> ä¸»é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLç´¢å¼•å¤±æ•ˆ</title>
      <link href="2020/10/29/90fd26f6.html"/>
      <url>2020/10/29/90fd26f6.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯å¤±æ•ˆ"><a href="#ä»€ä¹ˆæ˜¯å¤±æ•ˆ" class="headerlink" title="ä»€ä¹ˆæ˜¯å¤±æ•ˆ"></a>ä»€ä¹ˆæ˜¯å¤±æ•ˆ</h2><p>æ˜æ˜åˆ›å»ºå¥½äº†ç´¢å¼•ï¼Œä½†æ˜¯æ‰§è¡Œçš„æ—¶å€™å´æ²¡æœ‰æ—¶ç”¨åˆ°è¿™ä¸ªç´¢å¼•ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`demo_table`</span> (</span><br><span class="line">  <span class="string">`a`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`b`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`a`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`idx_b`</span> (<span class="string">`b`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8mb4 <span class="keyword">COLLATE</span>=utf8mb4_0900_ai_ci;</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> demo_table <span class="keyword">WHERE</span> a = <span class="string">&#x27;1&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201029014815.png"></p><p>è¡¨ä¸­ï¼Œ<code>a</code>ä¸ºä¸»é”®åˆ—ï¼Œæ¡ˆä¾‹æ¥è¯´åº”è¯¥ä½¿ç”¨åˆ°ä¸»é”®ç´¢å¼•æ‰å¯¹ï¼Œä½†æ˜¯å®é™…ä¸Šå¹¶æ²¡æœ‰</p><h2 id="ä»€ä¹ˆæ—¶å€™ä¼šå¤±æ•ˆ"><a href="#ä»€ä¹ˆæ—¶å€™ä¼šå¤±æ•ˆ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä¼šå¤±æ•ˆ"></a>ä»€ä¹ˆæ—¶å€™ä¼šå¤±æ•ˆ</h2><p>ç´¢å¼•å¤±æ•ˆä¸€å…±æœ‰7ç§æƒ…å†µï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ol><li><code>LIKE</code>æŸ¥è¯¢ä»¥<code>%</code>å¼€å¤´</li><li><code>WHERE</code>æ¡ä»¶ä¸­çš„ç´¢å¼•åˆ—å‚ä¸äº†è®¡ç®—</li><li><code>WHERE</code>æ¡ä»¶ä¸­çš„ç´¢å¼•è°ƒç”¨äº†å‡½æ•°</li><li>ç´¢å¼•åˆ—éœ€è¦è¿›è¡Œç±»å‹è½¬æ¢</li><li>å¤åˆç´¢å¼•æœªèƒ½æ»¡è¶³<code>æœ€å·¦åŒ¹é…åŸåˆ™</code></li><li>ä½¿ç”¨äº†<code>OR</code></li><li><code>MySQL</code>è§‰å¾—æ²¡æœ‰å¿…è¦èµ°ç´¢å¼•</li></ol><h2 id="ä¸ºä»€ä¹ˆä¼šå¤±æ•ˆ"><a href="#ä¸ºä»€ä¹ˆä¼šå¤±æ•ˆ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šå¤±æ•ˆ"></a>ä¸ºä»€ä¹ˆä¼šå¤±æ•ˆ</h2><p>è¦å¼„æ˜ç™½ä¸ºä»€ä¹ˆä¼šå¤±æ•ˆï¼Œé¦–å…ˆéœ€è¦ææ¸…æ¥š<code>MySQL</code>çš„ç´¢å¼•æ˜¯ä»€ä¹ˆï¼Œå…¶åº•å±‚çš„ç»“æ„æ˜¯ä»€ä¹ˆæ ·çš„ä»¥åŠ<code>MySQL</code>åˆ°åº•æ˜¯æ€ä¹ˆé€šè¿‡ç´¢å¼•æ¥æ£€ç´¢æ•°æ®çš„ã€‚</p><p>MySQLä¸­çš„ç´¢å¼•ä¸»è¦æ˜¯Hashç´¢å¼•å’ŒB+æ ‘ç´¢å¼•ï¼Œè€ŒInnoDBä¸­çš„ç´¢å¼•å°±æ˜¯B+æ ‘ç´¢å¼•ã€‚æ€»æ‰€å‘¨çŸ¥ï¼ŒMySQLçš„èšç°‡ç´¢å¼•æ¯ä¸ªéå¶å­èŠ‚ç‚¹å­˜å‚¨çš„å…¶å®æ˜¯ä¸»é”®å€¼ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯æ•´è¡Œçš„å€¼ï¼Œè€Œä¸”æ¯è¡Œä¹‹é—´æ˜¯æ ¹æ®ä¸»é”®è¿›è¡Œæ’åºçš„ã€‚äºŒçº§ç´¢å¼•çš„ç»“æ„å’Œèšç°‡ç´¢å¼•å·®ä¸å¤šï¼Œå¶å­èŠ‚ç‚¹ä¸Šå­˜å‚¨çš„æ˜¯ç´¢å¼•åˆ—çš„å€¼+ä¸»é”®ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯æ ¹æ®ç´¢å¼•åˆ—+ä¸»é”®åˆ—è¿›è¡Œæ’åºã€‚</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201031155759.png" alt="ç´¢å¼•ç»“æ„å›¾"></p><p>å¯¹äºèšç°‡ç´¢å¼•è€Œè¨€ï¼ŒæŸ¥è¯¢çš„æ—¶å€™å°±æ˜¯é€šè¿‡ä¸»é”®åˆ—çš„å€¼ä¸€ä¸ªä¸€ä¸ªçš„æ¯”è¾ƒè¿‡å»å°±å¯ä»¥æŸ¥åˆ°äº†ï¼Œå¯¹äºéèšç°‡ç´¢å¼•ï¼Œé‚£ä¹ˆå°±éœ€è¦<span style="color:red">ä¾æ¬¡</span>æ¯”è¾ƒç´¢å¼•åˆ—çš„å€¼ï¼Œç„¶åæœ€ç»ˆç¡®å®šåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå¶å­èŠ‚ç‚¹ï¼Œå¦‚æœé‡‡ç”¨çš„æ˜¯è¦†ç›–ç´¢å¼•ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¿”å›äº†ï¼Œå¦åˆ™è¿˜éœ€è¦æ ¹æ®ä¸»é”®å€¼æ¥ä¸€æ¬¡å›è¡¨æŸ¥è¯¢ã€‚</p><p>ä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œä½¿ç”¨è¿™å¼ è¡¨è¿›è¡Œæ¼”ç¤º</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`demo_table`</span> (</span><br><span class="line">  <span class="string">`a`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`b`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`c`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`d`</span> <span class="built_in">varchar</span>(<span class="number">32</span>),</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`a`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`idx_b`</span> (<span class="string">`b`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`idx_b_c_d`</span> (<span class="string">`b`</span>, <span class="string">`c`</span>, <span class="string">`d`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8mb4 <span class="keyword">COLLATE</span>=utf8mb4_0900_ai_ci;</span><br></pre></td></tr></table></figure><h3 id="LIKEæŸ¥è¯¢å¤±æ•ˆ"><a href="#LIKEæŸ¥è¯¢å¤±æ•ˆ" class="headerlink" title="LIKEæŸ¥è¯¢å¤±æ•ˆ"></a>LIKEæŸ¥è¯¢å¤±æ•ˆ</h3><p>LIKEæŸ¥è¯¢å¤±æ•ˆæŒ‡çš„æ˜¯ä»¥<code>%</code>å¼€å¤´çš„æŸ¥è¯¢æ‰ä¼šå¤±æ•ˆï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„éƒ½ä¼šå¤±æ•ˆï¼Œæ¯”å¦‚è¯´è¿™ä¸ªLIKEå°±ä¸ä¼šå¤±æ•ˆ</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201031164743.png"></p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201031164846.png"></p><p>ä½†æ˜¯è¿™ä¹ˆç©å°±ä¼šå¤±æ•ˆäº†</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201031170818.png"></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœLIKEæŸ¥è¯¢æ˜¯<code>%</code>å¼€å¤´ï¼Œé‚£ä¹ˆè¿™ä¸ªç´¢å¼•å°±ç”¨ä¸ä¸Šäº†ã€‚</p><p>ä¹‹å‰è¯´è¿‡ç´¢å¼•çš„ç»“æ„å’ŒæŸ¥è¯¢ä½¿ç”¨çš„è¿‡ç¨‹ï¼Œæ˜¯é€šè¿‡ç´¢å¼•åˆ—ä¸€ä¸ªä¸€ä¸ªæ¯”è¾ƒçš„ï¼Œ<code>%</code>çš„æ„æ€æ˜¯å¯ä»¥ä¸ºä»»æ„é•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œé‚£è¿™è¿˜æ€ä¹ˆå»æ¯”è¾ƒå‘¢ï¼Ÿæ¯•ç«Ÿéœ€è¦ä»å¤´æ¯”è¾ƒä¸æ˜¯</p><h3 id="ç´¢å¼•åˆ—å‚ä¸äº†è®¡ç®—æˆ–ä½¿ç”¨äº†å‡½æ•°"><a href="#ç´¢å¼•åˆ—å‚ä¸äº†è®¡ç®—æˆ–ä½¿ç”¨äº†å‡½æ•°" class="headerlink" title="ç´¢å¼•åˆ—å‚ä¸äº†è®¡ç®—æˆ–ä½¿ç”¨äº†å‡½æ•°"></a>ç´¢å¼•åˆ—å‚ä¸äº†è®¡ç®—æˆ–ä½¿ç”¨äº†å‡½æ•°</h3><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201031171302.png"></p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201031172817.png"></p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201031173933.png"></p><p>è¿™ç§æƒ…å†µä¸»è¦æ˜¯å› ä¸ºå‚ä¸è®¡ç®—æˆ–è€…ä½¿ç”¨äº†å‡½æ•°ä»¥åï¼Œæœ¬æ¥åº”è¯¥æ˜¯ç¡®å®šçš„å€¼ï¼Œç°åœ¨ä¸ç¡®å®šäº†ï¼å°±å¥½æ¯”ç¬¬ä¸€å¼ å›¾ï¼Œä¸€çœ¼çœ‹è¿‡å»å°±çŸ¥é“ç»“æœæ˜¯<code>b = &#39;12&#39;</code>ï¼Œä½†æ˜¯ä½ ä¸èƒ½è¦æ±‚MySQLè·Ÿä½ ä¸€æ ·èªæ˜å•Šï¼ŒMySQLåœ¨è¿™ç§æƒ…å†µä¸‹åªèƒ½å½“ä½œä¸€ä¸ªæœªçŸ¥æ•°æ¥å¤„ç†ï¼Œä¸€ä¸ªæœªçŸ¥æ•°åˆæ€ä¹ˆå¯èƒ½æ ¹æ®ç´¢å¼•å»åšæ¯”è¾ƒå‘¢ï¼Ÿ</p><h3 id="ç´¢å¼•åˆ—éœ€è¦è¿›è¡Œç±»å‹è½¬æ¢"><a href="#ç´¢å¼•åˆ—éœ€è¦è¿›è¡Œç±»å‹è½¬æ¢" class="headerlink" title="ç´¢å¼•åˆ—éœ€è¦è¿›è¡Œç±»å‹è½¬æ¢"></a>ç´¢å¼•åˆ—éœ€è¦è¿›è¡Œç±»å‹è½¬æ¢</h3><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201031174811.png"></p><p>ç±»å‹è½¬æ¢çš„åŸå› å’Œä¹‹å‰çš„éœ€è¦è®¡ç®—æˆ–è€…ä½¿ç”¨äº†å‡½æ•°çš„åŸå› ç›¸åŒï¼Œå•ç‹¬åˆ—å‡ºæ¥æ˜¯ä¸ºäº†ç€é‡è¯´æ˜ï¼Œå› ä¸ºå¹³æ—¶å¾ˆå®¹æ˜“å¿½ç•¥è¿™ä¸ªé—®é¢˜</p><h3 id="ä¸æ»¡è¶³æœ€å·¦åŒ¹é…åŸåˆ™"><a href="#ä¸æ»¡è¶³æœ€å·¦åŒ¹é…åŸåˆ™" class="headerlink" title="ä¸æ»¡è¶³æœ€å·¦åŒ¹é…åŸåˆ™"></a>ä¸æ»¡è¶³æœ€å·¦åŒ¹é…åŸåˆ™</h3><p>æœ€å·¦åŒ¹é…åŸåˆ™çš„æ„æ€å°±æ˜¯ï¼Œä»å·¦å¾€å³åŒ¹é…å‘—ï¼Œæ¯”å¦‚ç°åœ¨æœ‰çš„ç´¢å¼•æ˜¯<code>idx_b_c_d</code>ï¼Œç„¶åæ¯”è¾ƒçš„æ—¶å€™å½“ç„¶å°±æ˜¯å…ˆæ¯”è¾ƒ<code>b</code>ï¼Œç„¶åæ¯”è¾ƒ<code>c</code>ï¼Œæœ€åæ¯”è¾ƒ<code>d</code>è¿™æ ·æã€‚</p><p>é‚£ä¹ˆä¸æ»¡è¶³æœ€å·¦åŒ¹é…åŸåˆ™å°±æ˜¯æ²¡æœ‰æŒ‰ç…§ä¸Šè¿°çš„è§„åˆ™æ¥å‘—</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201031175222.png"></p><p>åƒè¿™æ ·ï¼Œè™½ç„¶<code>c</code>å’Œ<code>d</code>éƒ½åœ¨ç´¢å¼•<code>idx_b_c_d</code>ä¸­ï¼Œä½†æ˜¯ç”±äºæ²¡æœ‰ç”¨åˆ°<code>b</code>ï¼Œå¯¼è‡´ä»å·¦å¾€å³åŒ¹é…çš„æ—¶å€™æ— æ³•è¿›è¡Œï¼Œå› æ­¤æ²¡æœ‰ä½¿ç”¨åˆ°ç´¢å¼•</p><h3 id="ä½¿ç”¨äº†OR"><a href="#ä½¿ç”¨äº†OR" class="headerlink" title="ä½¿ç”¨äº†OR"></a>ä½¿ç”¨äº†OR</h3><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201031175519.png"></p><p>æŒ‰ç†æ¥è¯´ï¼Œ<code>b = &#39;2&#39; AND c = &#39;2&#39;</code>æ»¡è¶³æœ€å·¦åŒ¹é…åŸåˆ™ï¼Œåº”è¯¥æ˜¯å¯ä»¥ä½¿ç”¨åˆ°ç´¢å¼•<code>idx_b_c_d</code>çš„ï¼Œä½†æ˜¯é—®é¢˜åœ¨äºä½¿ç”¨<code>b = &#39;2&#39; AND c = &#39;2&#39;</code>è¿™ä¸ªæ¡ä»¶å¹¶ä¸èƒ½å›Šæ‹¬æ‰€æœ‰çš„å¯èƒ½æ•°æ®ï¼Œå› ä¸º<code>c = 1</code>è¿™ä¸€ç±»çš„æ•°æ®å°±æ²¡æœ‰è¢«è€ƒè™‘è¿›å»ï¼Œå› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯æ— æ³•ä½¿ç”¨ç´¢å¼•çš„ã€‚</p><h3 id="MySQLè§‰å¾—æ²¡å¿…è¦èµ°ç´¢å¼•"><a href="#MySQLè§‰å¾—æ²¡å¿…è¦èµ°ç´¢å¼•" class="headerlink" title="MySQLè§‰å¾—æ²¡å¿…è¦èµ°ç´¢å¼•"></a>MySQLè§‰å¾—æ²¡å¿…è¦èµ°ç´¢å¼•</h3><p>ä¹‹å‰è¯´è¿‡äºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯äºŒçº§ç´¢å¼•çš„ç´¢å¼•åˆ—å€¼+ä¸»é”®å€¼ï¼Œå¦‚æœæŸ¥è¯¢çš„æ—¶å€™æ²¡æœ‰ç”¨åˆ°è¦†ç›–ç´¢å¼•ï¼Œé‚£ä¹ˆå°±ä¼šæ ¹æ®ä¸»é”®å€¼å›è¡¨ä¸€æ¬¡ï¼Œè¿™ç§æƒ…å†µä¸‹å…¶å®æŸ¥è¯¢äº†ä¸€å…±2æ¬¡ç´¢å¼•</p><p>å‡è®¾æŸ¥è¯¢çš„ä»£ä»·æ˜¯<code>n</code>ï¼Œé‚£ä¹ˆå¦‚æœæ‰«æä¸€æ¬¡å…¨è¡¨çš„ä»£ä»·æ˜¯<code>m</code>ä¸”<code>n &gt; m</code>çš„æ—¶å€™ï¼ŒMySQLå°±ä¼šé€‰æ‹©èµ°å…¨è¡¨è€Œä¸èµ°ç´¢å¼•äº†ï¼Œæ¯•ç«Ÿèµ°ç´¢å¼•è¿˜ä¸å¦‚èµ°å…¨è¡¨ä¸æ˜¯</p>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
            <tag> ç´¢å¼• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLä¸­çš„æ—¥å¿—</title>
      <link href="2020/10/18/937fe6d5.html"/>
      <url>2020/10/18/937fe6d5.html</url>
      
        <content type="html"><![CDATA[<p>MySQLæ“ä½œæ•°æ®çš„æ—¶å€™ï¼Œæ¯æ¬¡æ˜¯ä»ç£ç›˜ä¸­æŒ‰é¡µè¯»å–æ•°æ®çš„ï¼Œå¯¹è¿™éƒ¨åˆ†æ•°æ®è¿›è¡Œä¿®æ”¹ä»¥åï¼Œé¦–å…ˆä¼šå°†ä¿®æ”¹æ”¾åˆ°ä¸€å—å†…å­˜åŒºåŸŸ<code>Buffer Pool</code>ä¸­ï¼Œç„¶åå†åˆ·åˆ°ç£ç›˜ä¸­ã€‚å‡å¦‚è¯´æ­¤æ—¶å‘ç”Ÿäº†ä¸€äº›æ•…éšœï¼Œæ¯”å¦‚çªç„¶æ–­ç”µï¼Œå¯¼è‡´<code>Buffer Pool</code>ä¸­çš„ä¸€äº›æ•°æ®è¿˜æ²¡æœ‰æ¥å¾—åŠåˆ·åˆ°ç£ç›˜ä¸Šï¼Œé‚£ä¸å°±ä¸¢å¤±äº†æ•´ä¸ª<code>Buffer Pool</code>çš„æ•°æ®ï¼Ÿ</p><p>ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒMySQLé‡‡ç”¨äº†ä¸€ç§<code>WAL(Write Ahead Log)</code>æœºåˆ¶ï¼Œå³é¢„å†™æ—¥å¿—æœºåˆ¶ï¼Œå…¶æ ¸å¿ƒå°±æ˜¯åˆ·æ–°å†…å­˜ä¹‹å‰ï¼Œå…ˆæŠŠæ—¥å¿—è®°å½•åˆ°ç£ç›˜é‡Œé¢æ°¸ä¹…ä¿å­˜ï¼Œè€Œä¸”ä¸ºäº†æå‡æ€§èƒ½ï¼Œå†™æ—¥å¿—éƒ½æ˜¯é¡ºåºIOã€‚</p><p>MySQLä¸­çš„æ—¥å¿—å¤§è‡´æœ‰7ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯</p><p><code>redo log</code>ã€<code>undo log</code>ã€<code>bin log</code>ã€<code>error log</code>ã€<code>slow query log</code>ã€<code>general log</code>ã€<code>relay log</code></p><h2 id="redo-log"><a href="#redo-log" class="headerlink" title="redo log"></a>redo log</h2><p>æœ‰è¿™ä¹ˆä¸€ç§æƒ…å†µï¼Œä¸€ä¸ªäº‹åŠ¡å·²ç»<code>commit</code>äº†ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æŠŠæ•°æ®åˆ·æ–°åˆ°ç£ç›˜ï¼Œæ­¤æ—¶çªç„¶å‘ç”Ÿæ•…éšœï¼Œå¯¼è‡´è¿™ä¸€éƒ¨åˆ†æ•°æ®ä¸¢å¤±ï¼Œä¸ºäº†è®©MySQLé‡å¯ä»¥åæ¢å¤åˆ°åŸæ¥çš„çŠ¶æ€ï¼Œå°±éœ€è¦ä½¿ç”¨<code>redo log</code>ã€‚</p><h3 id="redo-log-buffer"><a href="#redo-log-buffer" class="headerlink" title="redo log buffer"></a>redo log buffer</h3><p>å’Œ<code>Buffer Pool</code>ä¸€æ ·ï¼Œredo logä¹Ÿæœ‰è‡ªå·±çš„ä¸€ä¸ªç¼“å†²æ± <code>redo log buffer</code>ï¼Œäº‹åŠ¡æ‰§è¡Œ<code>DML</code>è¯­å¥çš„æ—¶å€™ï¼Œä¼šå‘<code>redo log buffer</code>ä¸­è®°å½•ä¸€æ¡ä¿®æ”¹çš„æ—¥å¿—ï¼Œç„¶ååˆ·æ–°åˆ°ç£ç›˜ä¸Šçš„æ—¥å¿—æ–‡ä»¶ä¸­å»ã€‚</p><p>é»˜è®¤çš„ï¼Œ<code>redo log buffer</code>çš„å¤§å°æ˜¯<code>16M</code>ï¼ˆMySQL 8.0ï¼‰ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">&#x27;%innodb_log_buffer_size%&#x27;</span>;</span><br><span class="line"></span><br><span class="line">+<span class="comment">------------------------+----------+</span></span><br><span class="line">| Variable_name          | Value    |</span><br><span class="line">+<span class="comment">------------------------+----------+</span></span><br><span class="line">| innodb_log_buffer_size | 16777216 |</span><br><span class="line">+<span class="comment">------------------------+----------+</span></span><br></pre></td></tr></table></figure><p>redo log buffer åˆ·ç›˜ç­–ç•¥</p><ol><li>å½“äº‹åŠ¡æäº¤çš„æ—¶å€™</li><li>å½“<code>redo log buffer</code>å‰©ä½™ç©ºé—´å°äºä¸€åŠçš„æ—¶å€™</li><li>åå°çº¿ç¨‹æ¯éš”1såˆ·æ–°ä¸€æ¬¡</li></ol><h3 id="redo-log-file"><a href="#redo-log-file" class="headerlink" title="redo log file"></a>redo log file</h3><p>æ­£å¸¸æƒ…å†µä¸‹ï¼ŒMySQLä¸å‘ç”Ÿä»»ä½•æ•…éšœï¼Œäº‹åŠ¡å¯¹æ•°æ®åº“çš„ä¿®æ”¹æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šäº†ï¼Œé‚£ä¹ˆè¿™ä¸€éƒ¨åˆ†çš„<code>redo log</code>å…¶å®å°±æ²¡æœ‰ä¿å­˜çš„å¿…è¦ï¼Œç•™ç€ä¹Ÿæ˜¯æµªè´¹ç©ºé—´ï¼Œå› æ­¤<code>redo log</code>é‡‡ç”¨çš„æ˜¯å¾ªç¯å†™çš„æ–¹å¼æ¥è®°å½•æ—¥å¿—ã€‚</p><p>é»˜è®¤çš„ï¼ŒMySQLä¸­<code>redo log</code>æ—¥å¿—æ–‡ä»¶æ˜¯2ä¸ªï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">&#x27;%innodb_log_files_in_group%&#x27;</span>;</span><br><span class="line"></span><br><span class="line">+<span class="comment">---------------------------+-------+</span></span><br><span class="line">| Variable_name             | Value |</span><br><span class="line">+<span class="comment">---------------------------+-------+</span></span><br><span class="line">| innodb_log_files_in_group | 2     |</span><br><span class="line">+<span class="comment">---------------------------+-------+</span></span><br></pre></td></tr></table></figure><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201018124146.png"></p><p><code>redo log</code>å¾ªç¯å†™å›¾ä¾‹å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªæ¯”è¾ƒå…³é”®çš„å˜é‡</p><ol><li><code>write_pos</code>ï¼Œè¡¨ç¤ºä¸‹ä¸€æ¬¡å†™<code>redo log</code>çš„ä½ç½®</li><li><code>check_point</code>ï¼Œè¡¨ç¤ºå°šæœªåˆ·æ–°åˆ°ç£ç›˜çš„äº‹åŠ¡ä¿®æ”¹çš„èµ·å§‹ä½ç½®</li></ol><p><code>write_pos ~ check_point</code>å°±æ˜¯ç›®å‰å‰©ä½™çš„ç©ºé—´ï¼Œ<code>check_point ~ write_pos</code>å°±æ˜¯å°šæœªåˆ·æ–°åˆ°ç£ç›˜çš„äº‹åŠ¡ä¿®æ”¹ã€‚</p><p>ä¹‹å‰è®²è¿‡ï¼Œå¦‚æœå·²ç»åˆ·æ–°åˆ°ç£ç›˜çš„äº‹åŠ¡ä¿®æ”¹ï¼Œé‚£ä¹ˆè¿™ä¸€æ®µ<code>redo log</code>æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå¯ä»¥éšä¾¿è¦†ç›–æ‰ï¼Œä½†æ˜¯é‚£äº›è¿˜æ²¡æœ‰åˆ·åˆ°ç£ç›˜çš„å°±ä¸èƒ½éšä¾¿ä¹±æäº†ã€‚é‚£ä¹ˆè¿™æ ·ä¸€æ¥å°±å¾ˆæœ‰å¯èƒ½å‡ºç°â€è¿½å°¾â€çš„æƒ…å†µï¼š<code>redo log</code>ç–¯ç‹‚çš„å†™ï¼Œä½†æ˜¯äº‹åŠ¡ä¿®æ”¹è¿Ÿè¿Ÿæ²¡æœ‰åˆ·æ–°åˆ°ç£ç›˜é‡Œé¢ã€‚é‚£ä¹ˆæ­¤æ—¶<code>write_pos</code>å°±è¦æ¨ç€<code>check_point</code>å¾€å‰èµ°ï¼Œå¼ºåˆ¶è®©äº‹åŠ¡çš„ä¿®æ”¹åˆ·æ–°åˆ°ç£ç›˜é‡Œé¢å»ï¼Œåœ¨è¿™ä¸ªæ—¶å€™ï¼ŒMySQLæ˜¯ä¸æ¥å—ä»»ä½•<code>DML</code>è¯­å¥çš„ï¼Œä¹Ÿå°±ä¼šå‡ºç°â€æŠ–åŠ¨â€ã€‚</p><h3 id="innodb-flush-log-at-trx-commit"><a href="#innodb-flush-log-at-trx-commit" class="headerlink" title="innodb_flush_log_at_trx_commit"></a>innodb_flush_log_at_trx_commit</h3><p>å¦‚æœæ¯ä¸€æ¬¡äº‹åŠ¡<code>commit</code>åï¼Œéƒ½è¦æŠŠæœŸé—´äº§ç”Ÿçš„<code>redo log</code>åˆ·æ–°åˆ°ç£ç›˜é‡Œé¢ï¼Œé‚£ä¹ˆè¿™æ ·ä¸€æ¥è™½ç„¶ä¿è¯äº†æŒä¹…æ€§ï¼Œä½†ä¸æ­¤åŒæ—¶ä¹Ÿä¼šä¸¥é‡å½±å“æ•°æ®åº“çš„æ€§èƒ½ï¼ˆäº‹åŠ¡æ‰§è¡Œæ—¶é—´ = è¯»å–æ•°æ®é¡µæ—¶é—´ + DMLæ—¶é—´ + åˆ·æ–°<code>redo log</code>åˆ°ç£ç›˜æ—¶é—´ï¼‰</p><p>å¦‚æœå¯¹æŒä¹…æ€§è¦æ±‚ä¸æ˜¯å¾ˆé«˜çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä¿®æ”¹<code>innodb_flush_log_at_trx_commit</code>ï¼Œè¯¥å˜é‡æœ‰ä¸‰ä¸ªå¯é€‰å€¼ï¼š</p><ol><li><code>0</code>: äº‹åŠ¡æäº¤ä»¥åï¼Œä¸ä¼šç«‹åˆ»æŠŠæ—¥å¿—åˆ·åˆ°ç£ç›˜é‡Œé¢ï¼Œè€Œæ˜¯äº¤ç»™ä¸€ä¸ªåå°çº¿ç¨‹å»åšã€‚è¿™æ ·ä¸€æ¥è¯·æ±‚çš„é€Ÿåº¦ä¼šå¿«å¾ˆå¤šï¼Œä½†æ˜¯è¿™æ ·å°±ä¸èƒ½ä¿è¯æŒä¹…æ€§äº†ã€‚</li><li><code>1</code>: äº‹åŠ¡æäº¤ä»¥åç«‹é©¬å°†æ—¥å¿—åˆ·åˆ°ç£ç›˜</li><li><code>2</code>: äº‹åŠ¡æäº¤ä»¥åï¼Œå°†<code>redo log</code>æäº¤åˆ°<code>æ“ä½œç³»ç»Ÿ</code>ç¼“å†²åŒºï¼Œå¹¶æ²¡æœ‰çœŸæ­£åˆ·æ–°åˆ°ç£ç›˜ã€‚è¿™æ ·å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿è¯æŒä¹…æ€§ï¼Œåªè¦æ“ä½œç³»ç»Ÿæ²¡æŒ‚å°±æ²¡äº‹ã€‚</li></ol><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ol><li><code>redo log</code>æ˜¯ä¸ºäº†ä¿è¯æŒä¹…æ€§è€Œç”Ÿçš„</li><li><code>redo log</code>é»˜è®¤æ–‡ä»¶å¤§å°æ˜¯<code>16M</code>ï¼ˆMySQL8.0ï¼‰ï¼Œé»˜è®¤æœ‰ä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶</li><li><code>redo log</code>é‡‡ç”¨å¾ªç¯å†™çš„æ–¹å¼è®°å½•</li><li>å¦‚æœå‘ç”Ÿè¿½å°¾ï¼Œé‚£ä¹ˆå°±ä¼šå¼ºåˆ¶åˆ·ç›˜ï¼Œåœ¨æ­¤æœŸé—´MySQLä¸æ¥å—å¤–ç•Œçš„DMLè¯·æ±‚</li><li>å¯ä»¥é€šè¿‡ä¿®æ”¹<code>innodb_flush_log_at_trx_commit</code>æ¥è°ƒæ•´<code>redo log</code>åˆ·ç›˜æœºåˆ¶</li></ol><h2 id="undo-log"><a href="#undo-log" class="headerlink" title="undo log"></a>undo log</h2><p>åœ¨å®é™…æ“ä½œè¿‡ç¨‹ä¸­ï¼Œä¼šå‡ºç°è¿™ä¹ˆä¸€ç§æƒ…å†µï¼šäº‹åŠ¡æ‰§è¡Œé”™äº†ä¸€æ¡DMLï¼Œè¿™æ—¶å€™éœ€è¦å›é€€ï¼Œä¹‹å‰çš„é‚£äº›ä¸ªDMLæ“ä½œæ ¹æ®åŸå­æ€§çš„è¦æ±‚ï¼Œä¹Ÿåº”è¯¥å›é€€ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦<code>undo log</code>æ¥æ•‘åœºäº†ã€‚</p><p>ä¸Šè¿°åœºæ™¯å°±åƒä¸‹æ£‹ä¸€æ ·ï¼Œå¾€å·¦èµ°äº†ä¸€æ­¥ï¼Œè¦æ‚”æ£‹å°±åº”è¯¥å‘å³èµ°ä¸€æ­¥ï¼Œå›åˆ°åŸæ¥çš„åœ°æ–¹ã€‚å¦‚æœè¦åšä¸€ä¸ªç±»ä¼¼æ‚”æ£‹çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆåŠ¿å¿…éœ€è¦ä¿å­˜ä¸Šä¸€æ­¥çš„ä½ç½®æ‰èƒ½å¤Ÿåšåˆ°ã€‚<code>undo log</code>é‡Œé¢ä¿å­˜çš„å°±æ˜¯ä¿®æ”¹å‰çš„çŠ¶æ€ã€‚å¥½æ¯”è¯´<code>UPDATE</code>ä¹‹å‰ï¼Œå€¼æ˜¯3ï¼Œ<code>UPDATE</code>ä¹‹åï¼Œå€¼æ˜¯2ï¼Œé‚£ä¹ˆMySQLä¼šå†æ‰§è¡Œ<code>UPDATE</code>ä¹‹å‰è®°å½•<code>undo log</code>ï¼Œè®°å½•çš„å€¼æ˜¯3ï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹å‰çš„å€¼ã€‚</p><h3 id="undo-log-ç±»å‹"><a href="#undo-log-ç±»å‹" class="headerlink" title="undo log ç±»å‹"></a>undo log ç±»å‹</h3><p><code>undo log</code>æ—¥å¿—ä¸»è¦åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š</p><ol><li><code>INSERT UNDO LOG</code>: è®°å½•<code>INSERT</code>æ“ä½œçš„<code>undo log</code></li><li><code>UPDATE UNDO LOG</code>: è®°å½•<code>UPDATE</code>æ“ä½œçš„<code>undo log</code>ï¼Œ<code>UPDATE</code>åŒ…æ‹¬äº†<code>update</code>å’Œ<code>delete</code></li></ol><h4 id="INSERTç±»å‹çš„undo-log"><a href="#INSERTç±»å‹çš„undo-log" class="headerlink" title="INSERTç±»å‹çš„undo log"></a>INSERTç±»å‹çš„undo log</h4><p>MySQLä¸­ï¼ŒInsertç±»å‹çš„<code>undo log</code>é‡‡ç”¨<code>TRX_UNDO_INSERT_REC</code>ç±»å‹çš„<code>undo log</code>æ¥å­˜å‚¨ï¼Œæ¯æ’å…¥ä¸€æ¡è®°å½•ï¼Œå°±ä¼šç”Ÿæˆä¸€æ¡<code>undo log</code>ï¼Œè€Œè¿™æ¡è®°å½•çš„<code>roll_pointer</code>éšè—åˆ—å°±ä¼šæŒ‡å‘è¿™ä¸ª<code>undo log</code>ï¼Œå½“éœ€è¦å›æ»šçš„æ—¶å€™ï¼Œæ ¹æ®<code>undo log</code>å°±èƒ½æ‰¾åˆ°è¿™æ¡æ’å…¥çš„è®°å½•ï¼Œç„¶ååˆ é™¤æ‰å°±èƒ½å¤Ÿæ¢å¤åˆ°åŸæ¥çš„æ ·å­äº†ã€‚</p><h4 id="UPDATEç±»å‹çš„undo-log"><a href="#UPDATEç±»å‹çš„undo-log" class="headerlink" title="UPDATEç±»å‹çš„undo log"></a>UPDATEç±»å‹çš„undo log</h4><ol><li>ä¸æ›´æ–°ä¸»é”®çš„UPDATE<ul><li>åŸåœ°æ›´æ–°ï¼šå¦‚æœä¿®æ”¹ååˆ—çš„å€¼å’ŒåŸæ¥åˆ—çš„å€¼å ç”¨çš„å­—èŠ‚æ•°æ˜¯ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥åœ¨åŸæ¥çš„åˆ—ä¸Šè¿›è¡Œä¿®æ”¹å³å¯ã€‚</li><li>åˆ é™¤åé‡æ–°åˆ›å»ºï¼šå¦‚æœä¿®æ”¹åˆ—çš„å€¼å’ŒåŸæ¥çš„ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆå°±éœ€è¦åˆ é™¤ï¼ˆçœŸå®çš„åˆ é™¤ï¼‰åŸæ¥çš„è®°å½•ï¼Œç„¶åæ’å…¥ä¸€æ¡æ–°çš„è®°å½•</li></ul></li><li>æ›´æ–°ä¸»é”®çš„UPDATE<ul><li>æ›´æ–°ä¸»é”®æ¯”è¾ƒéº»çƒ¦ï¼Œå› ä¸ºMySQLçš„èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•åº•å±‚éƒ½æ˜¯é€šè¿‡ä¸»é”®è¿›è¡Œæ’åºçš„ï¼Œå¦‚æœæ›´æ–°äº†ä¸»é”®ï¼Œé‚£ä¹ˆç´¢å¼•å˜åŠ¨èµ·æ¥éå¸¸çš„éº»çƒ¦ï¼Œå› æ­¤æ­¤æ—¶é¦–å…ˆè¦å¯¹åŸæ¥çš„å°±åš<code>delete mark</code>ï¼ˆä¸æ˜¯çœŸå®çš„åˆ é™¤ï¼Œå› ä¸ºæ­¤æ—¶æœ‰å¯èƒ½æœ‰å…¶ä»–çš„äº‹åŠ¡åœ¨è®¿é—®è¿™æ¡è®°å½•ï¼‰ï¼Œç„¶åå†æ’å…¥ä¸€æ¡æ–°çš„è®°å½•ã€‚</li></ul></li></ol><h3 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ol><li><code>undo log</code>çš„ç›®çš„æ˜¯ä¸ºäº†å®ç°æ•°æ®å›æ»šï¼Œä¿è¯äº‹åŠ¡çš„åŸå­æ€§</li><li><code>undo log</code>è®°å½•çš„æ˜¯ä¿®æ”¹å‰çš„çŠ¶æ€ï¼Œè€Œä¸”æ˜¯åœ¨ä¿®æ”¹ä¹‹å‰è¿›è¡Œè®°å½•</li></ol><h2 id="bin-log"><a href="#bin-log" class="headerlink" title="bin log"></a>bin log</h2><p>MySQLä¸­çš„<code>bin log</code>åŒºåˆ«äº<code>redo log</code>å’Œ<code>undo log</code>ï¼Œæ˜¯ä¸€ç§äºŒè¿›åˆ¶æ—¥å¿—ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ï¼š</p><ol><li>å¤åˆ¶ï¼šæ­å»ºä¸»ä»ä»¥åï¼Œé€šè¿‡<code>bin log</code>å®ç°ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®åŒæ­¥</li><li>æ•°æ®æ¢å¤ï¼šæ•°æ®åº“è¢«åˆ äº†ï¼Œè¿˜å¯ä»¥é€šè¿‡<code>bin log</code>æ¥æ¢å¤</li><li>å¢é‡å¤‡ä»½</li></ol><h3 id="bin-logç›¸å…³æ“ä½œ"><a href="#bin-logç›¸å…³æ“ä½œ" class="headerlink" title="bin logç›¸å…³æ“ä½œ"></a>bin logç›¸å…³æ“ä½œ</h3><ol><li><p>æŸ¥çœ‹<code>bin log</code>çš„å­˜æ”¾ç›®å½•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">&#x27;%log_bin%&#x27;</span>;</span><br><span class="line"></span><br><span class="line">+<span class="comment">---------------------------------+------------------------------------------+</span></span><br><span class="line">| Variable_name                   | Value                                    |</span><br><span class="line">+<span class="comment">---------------------------------+------------------------------------------+</span></span><br><span class="line">| log_bin                         | ON                                       |</span><br><span class="line">| log_bin_basename                | C:\Program Files\MySQL\Data\binlog       |</span><br><span class="line">| log_bin_index                   | C:\Program Files\MySQL\Data\binlog.index |</span><br><span class="line">| log_bin_trust_function_creators | OFF                                      |</span><br><span class="line">| log_bin_use_v1_row_events       | OFF                                      |</span><br><span class="line">| sql_log_bin                     | ON                                       |</span><br><span class="line">+<span class="comment">---------------------------------+------------------------------------------+</span></span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹<code>bin log</code>çš„çŠ¶æ€</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">master</span> <span class="keyword">status</span>;</span><br><span class="line"></span><br><span class="line">+<span class="comment">---------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| File          | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+<span class="comment">---------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| binlog.000047 |      155 |              |                  |                   |</span><br><span class="line">+<span class="comment">---------------+----------+--------------+------------------+-------------------+</span></span><br></pre></td></tr></table></figure></li><li><p>æ¸…ç©º<code>bin log</code>æ–‡ä»¶</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">reset</span> <span class="keyword">master</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="error-log"><a href="#error-log" class="headerlink" title="error log"></a>error log</h2><p>MySQLä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæ€»ä¼šé‡åˆ°ä¸€äº›é”™è¯¯ï¼ˆæœ€å¸¸è§çš„å°±æ˜¯SQLå†™é”™äº†è¿™ç§ï¼‰ï¼Œè¿™äº›é”™è¯¯ä¼šè¢«è®°å½•åˆ°<code>error log</code>ä¸­ã€‚</p><p>å¯ä»¥ä½¿ç”¨<code>--log-error[=file_name]</code>çš„æ–¹å¼æ¥å¼€å¯<code>error log</code>ï¼Œå¦‚æœ<code>file_name</code>ç¼ºçœï¼Œé‚£ä¹ˆé»˜è®¤ä½¿ç”¨<code>hostname</code></p><p>å¯ä»¥é€šè¿‡<code>show variables like &#39;log_error&#39;;</code>æŸ¥çœ‹<code>error log</code>æ—¥å¿—æ¸…ç©º</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">&#x27;log_error&#x27;</span>;</span><br><span class="line"></span><br><span class="line">+<span class="comment">---------------+-------------------------------------------------+</span></span><br><span class="line">| Variable_name | Value                                           |</span><br><span class="line">+<span class="comment">---------------+-------------------------------------------------+</span></span><br><span class="line">| log_error     | C:\Program Files\MySQL\Data\DESKTOP-4QRSVC9.err |</span><br><span class="line">+<span class="comment">---------------+-------------------------------------------------+</span></span><br></pre></td></tr></table></figure><h2 id="slow-query-log"><a href="#slow-query-log" class="headerlink" title="slow query log"></a>slow query log</h2><p>æ…¢æŸ¥è¯¢æ—¥å¿—ä¸»è¦æ˜¯ç”¨äºè®°å½•æ‰§è¡Œæ—¶é—´è¶…è¿‡æŒ‡å®šæœ€é•¿æ—¶é—´çš„SQLè¯­å¥çš„ä¸€ç§æ—¥å¿—ï¼Œå’Œè¯¥æ—¥å¿—ç›¸å…³çš„é…ç½®é¡¹æ˜¯ï¼š</p><ol><li><code>slow_query_log</code>: æ˜¯å¦å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—</li><li><code>slow_query_log_file</code>: æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶åç§°</li><li><code>long_query_time</code>: æ…¢æŸ¥è¯¢æ—¶é—´é˜ˆå€¼ï¼Œè¶…è¿‡è¯¥å€¼çš„æŸ¥è¯¢SQLä¼šè¢«è®°å½•ä¸‹æ¥</li><li><code>min_examined_row_limit</code>: å¦‚æœæŸ¥è¯¢çš„è®°å½•æ•°å°‘äºè¿™ä¸ªå€¼ï¼Œå³ä¾¿è¶…æ—¶äº†ä¹Ÿä¸ä¼šè¢«è®°å½•</li><li><code>log_queries_not_using_indexes</code>: è®¾ç½®æ²¡æœ‰ä½¿ç”¨ç´¢å¼•çš„SQLæ˜¯å¦éœ€è¦è¢«è®°å½•</li></ol><h3 id="æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—çš„å†…å®¹"><a href="#æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—çš„å†…å®¹" class="headerlink" title="æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—çš„å†…å®¹"></a>æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—çš„å†…å®¹</h3><p>æ‰“å¼€æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶ï¼Œå…¶ä¸­ä¸€æ¡è®°å½•æ˜¯è¿™æ ·çš„</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Time: 2020-10-18T18:55:20.823837Z  </span></span><br><span class="line"><span class="comment"># User@Host: root[root] @ localhost []  Id:     7  </span></span><br><span class="line"><span class="comment"># Query_time: 2.898604  Lock_time: 0.000295 Rows_sent: 2700216  Rows_examined: 300033  </span></span><br><span class="line"><span class="keyword">use</span> emp;  </span><br><span class="line"><span class="keyword">SET</span> <span class="built_in">timestamp</span>=<span class="number">1603018520</span>;  </span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> demo_talbe;</span><br></pre></td></tr></table></figure><h2 id="general-log"><a href="#general-log" class="headerlink" title="general log"></a>general log</h2><p>å‰é¢è®²åˆ°çš„æ—¥å¿—ç±»å‹å¦‚<code>redo log</code>ã€<code>undo log</code>ã€<code>bin log</code>ã€<code>error log</code>å’Œ<code>slow query log</code>ï¼Œæ¶µç›–äº†æŸ¥è¯¢ã€ä¿®æ”¹ã€é”™è¯¯ä¿¡æ¯ã€å¯åŠ¨ä¿¡æ¯ç­‰æ‰€æœ‰å†…å®¹ï¼Œä½†æ˜¯é—®é¢˜åœ¨äºè®°å½•çš„ä¸æ˜¯å¾ˆå…¨é¢ï¼Œè€Œ<code>slow query log</code>è™½ç„¶å¾ˆå…¨é¢ï¼Œä½†ä¹Ÿåªé’ˆå¯¹æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ŒMySQLä¸­çš„<code>general log</code>è®°å½•äº†æ‰€æœ‰çš„æ“ä½œæ—¥å¿—ï¼Œä¸è¿‡ä¸€èˆ¬ä¼šæ¶ˆè€—<code>5% - 10%</code>çš„æ€§èƒ½ï¼Œä¸€èˆ¬æ²¡äº‹ä¸ä¼šå»å¼€å¯ã€‚</p><h2 id="relay-log"><a href="#relay-log" class="headerlink" title="relay log"></a>relay log</h2><blockquote><p>The relay log, like the binary log, consists of a set of numbered files containing events that describe database changes, and an index file that contains the names of all used relay log files.</p><p>The term â€œrelay log fileâ€ generally denotes an individual numbered file containing database events. The termâ€relay logâ€ collectively denotes the set of numbered relay log files plus the index file</p></blockquote><p><code>relay log</code>å’Œ<code>bin log</code>å¾ˆç±»ä¼¼ï¼Œéƒ½åŒ…å«äº†æ•°æ®åº“å˜æ›´çš„è®°å½•ï¼ŒåŒºåˆ«åœ¨äº: <code>bin log</code>æ˜¯ä¸»æœåŠ¡å™¨è®°å½•ä¸‹æ¥çš„ä¸€äº›æ•°æ®åº“å˜æ›´ï¼Œè€Œ<code>relay log</code>æ˜¯ä»æœåŠ¡å™¨ä»ä¸»æœåŠ¡å™¨é€šè¿‡<code>I/O</code>å¤åˆ¶è¿‡æ¥çš„ä¸€ä»½æ•°æ®ï¼Œç„¶åä»æœåŠ¡å™¨é€šè¿‡è¯»å–<code>relay log</code>æ¥å®Œæˆå’Œä¸»æœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®åŒæ­¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>INSERT INTO SELECT...åŠ é”</title>
      <link href="2020/10/12/2e64bb50.html"/>
      <url>2020/10/12/2e64bb50.html</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>è¯´å‡ºæ¥å¯èƒ½ä¸ä¿¡ï¼Œä»Šæ™šä¸Šå› ä¸ºæ´—æ•°æ®çš„é—®é¢˜ï¼Œç»ç†å¯¹æˆ‘å‘å‡ºçµé­‚æ‹·é—®ã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆè¦é‡‡ç”¨<code>rename</code>è¡¨çš„æ–¹å¼æ¥åšï¼Ÿä½ ä¸çŸ¥é“<code>rename</code>æ˜¯ä¼šé”è¡¨çš„å—ï¼Ÿè¿™æ®µæ—¶é—´æœåŠ¡ä¸å¯ç”¨æ€ä¹ˆåŠï¼Ÿä¸ºä»€ä¹ˆä¸ç”¨<code>INSERT INTO SELECT...</code>æ¥åšï¼Ÿ</p></blockquote><p>å½“æ—¶è¢«é—®å¾—å¿ƒé‡Œæ¯”è¾ƒæ…Œï¼Œä¾ç¨€è®°å¾—çœ‹è¿‡ä¸€ç¯‡æ–‡ç« å†™åˆ°äº†<code>INSERT INTO SELECT...</code>å¦‚æœä¸é‡‡ç”¨ç´¢å¼•ä¹Ÿä¼šæœ‰é”è¡¨çš„é—®é¢˜ï¼Œè€Œè¿™ä¸ªæ´—æ•°æ®çš„è¿‡ç¨‹çš„WHEREæ¡ä»¶é‡Œé¢å°±æ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼Œåªæ˜¯å½“æ—¶æ²¡æœ‰æƒ³èµ·æ¥ï¼Œè¢«é—®çš„ä¸€æ„£ä¸€æ„£çš„ï¼Œæœ‰äº›è¯­æ— ä¼¦æ¬¡ï¼Œå¤ªä¸¢è„¸äº†ğŸ˜‚</p><p>å½“æ—¶è€ƒè™‘çš„è¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œç»ç†æ˜¯å¸Œæœ›æˆ‘å¯ä»¥æƒ³çš„æ›´æœ‰æ·±åº¦ä¸€äº›ï¼Œè€ƒè™‘çš„æ›´å…¨é¢ä¸€ç‚¹ï¼Œæ„è¯†è¿˜æ˜¯è¦åŸ¹å…»èµ·æ¥ã€‚</p><h2 id="INSERT-INTO-SELECTâ€¦"><a href="#INSERT-INTO-SELECTâ€¦" class="headerlink" title="INSERT INTO SELECTâ€¦"></a>INSERT INTO SELECTâ€¦</h2><p>ä¹‹å‰çœ‹è¿‡çš„æ–‡ç« æ˜¯ã€Š<a href="https://juejin.im/post/6844904086173646862">Insert into selectè¯­å¥å¼•å‘çš„ç”Ÿäº§äº‹æ•…</a>ã€‹ï¼Œçœ‹è¿™ç¯‡æ–‡ç« ä¹Ÿå¯ä»¥ç†è§£<code>INSERT INTO SELECT...</code>åŠ é”çš„é—®é¢˜ã€‚</p><h3 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><blockquote><p>ç”±äºä»£ç é—®é¢˜ï¼Œç¬¬ä¸‰æ–¹æœ‰ä¸€ä¸ªå¾ªç¯æ’å…¥æ•°æ®åˆ°è¡¨<code>dirty_table</code>é‡Œé¢ï¼Œå¯¼è‡´çŸ­æ—¶é—´å†…è¿™ä¸ªè¡¨å°±è¾¾åˆ°äº†å‡ ç™¾ä¸‡çš„æ•°æ®é‡ï¼Œå…³é”®æ˜¯è¿˜æ²¡æœ‰å»ºç´¢å¼•ï¼Œç„¶åæŸ¥è¯¢ç‰¹åˆ«æ…¢ï¼Œä¸€æ¬¡è€—æ—¶5ç§’å·¦å³ï¼äºæ˜¯ä¸‹å®šå†³å¿ƒè¦æ”¹å˜è¿™ç§æƒ…å†µã€‚</p><p>å¥½ä¸å®¹æ˜“ä»£ç ä¿®å¤å®Œäº†ã€æœ‰æ•ˆçš„æ•°æ®ä¹Ÿè¿ç§»åˆ°<code>new_table</code>é‡Œé¢å»äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ”¹æ”¹è¡¨åå°±å¥½äº†ï¼Œç„¶åå°±â€¦</p></blockquote><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ç›®å‰æˆ‘éœ€è¦æ‰§è¡Œçš„SQLè¯­å¥æ˜¯</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RENAME</span> <span class="keyword">TABLE</span> dirty_table <span class="keyword">TO</span> dirty_table_old;</span><br><span class="line"><span class="keyword">RENAME</span> <span class="keyword">TABLE</span> new_table <span class="keyword">TO</span> dirty_table;</span><br><span class="line"><span class="comment">-- dirty_tableä¸èƒ½ç›´æ¥åˆ äº†ï¼Œåœ¨new_tableé‡Œé¢çš„æ•°æ®å¹¶ä¸æ˜¯å…¨éƒ¨çš„ï¼Œdirty_tableæ­¤æ—¶è¿˜åœ¨ä¸æ–­çš„æ¥æ”¶æ–°çš„æ•°æ®è¿›æ¥ï¼Œéœ€è¦åšå¢é‡æ›´æ–°</span></span><br></pre></td></tr></table></figure><p>è¿™ç§åšæ³•æ¯«æ— ç–‘é—®åœ¨RENAMEæœŸé—´æ•´ä¸ªå’Œ<code>dirty_table</code>ç›¸å…³çš„ä¸šåŠ¡éƒ½è¦å—åˆ°å½±å“ï¼Œç»ç†å¸Œæœ›æ‰¾ä¸€ç§èƒ½å¤Ÿä¸å½±å“ä¸šåŠ¡çš„æ–¹æ³•æ¥åšåˆ°æ•°æ®çš„åˆ‡æ¢ï¼Œç»ç†çš„æƒ³æ³•æ˜¯è¿™æ ·ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dirty_table <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> new_table <span class="keyword">WHERE</span> ...;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> dirty_table <span class="keyword">WHERE</span> ...;</span><br></pre></td></tr></table></figure><p>çœ‹ä¸Šå»å¥½åƒæ²¡å•¥é—®é¢˜ï¼Œç”šè‡³ç”©æˆ‘å‡ æ¡è¡—ï¼Œä½†æ˜¯è„‘å­é‡Œä¾ç¨€è®°å¾—è¿™ä¹ˆææ˜¯æœ‰é—®é¢˜çš„ã€‚</p><p>ç”±äºWHEREæ¡ä»¶é‡Œé¢çš„åˆ—æ²¡æœ‰åŠ ä¸Šç´¢å¼•ï¼Œå› æ­¤åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¼šå¯¹<code>dirty_table</code>åŠ è¡¨é”ï¼Œå¯¹<code>new_table</code>é€è¡ŒåŠ é”ï¼Œæœ€ç»ˆçš„æ•ˆæœå’ŒRENAMEå…¶å®æ„Ÿè§‰éƒ½å·®ä¸å¤šäº†â€¦</p><h3 id="åœºæ™¯æ¨¡æ‹Ÿ"><a href="#åœºæ™¯æ¨¡æ‹Ÿ" class="headerlink" title="åœºæ™¯æ¨¡æ‹Ÿ"></a>åœºæ™¯æ¨¡æ‹Ÿ</h3><p>ç»“è®ºæ˜¯æœ‰äº†ï¼Œä½†æ˜¯è¿˜éœ€è¦å®é™…æ“ä½œæ¥éªŒè¯ã€‚</p><h4 id="æ•°æ®å‡†å¤‡"><a href="#æ•°æ®å‡†å¤‡" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`dirty_table`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`c1`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`c2`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8mb4 <span class="keyword">COLLATE</span>=utf8mb4_0900_ai_ci;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`new_table`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`c1`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`c2`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8mb4 <span class="keyword">COLLATE</span>=utf8mb4_0900_ai_ci;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line">chars = &#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="keyword">open</span>(<span class="string">&#x27;insert_into_select_simulation.sql&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> <span class="keyword">file</span>:</span><br><span class="line">    file.write(<span class="string">&#x27;INSERT INTO dirty_table (`c1`, `c2`) VALUES &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="keyword">open</span>(<span class="string">&#x27;insert_into_select_simulation.sql&#x27;</span>, <span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> <span class="keyword">file</span>:</span><br><span class="line">    <span class="keyword">max</span> = <span class="number">1000000</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">1</span>, <span class="keyword">max</span>):</span><br><span class="line">        file.write(<span class="string">&quot;(&#x27;&#123;0&#125;&#x27;, &#x27;&#123;1&#125;&#x27;),&quot;</span>.format(i, chars[i % <span class="keyword">len</span>(chars)]))</span><br><span class="line">    file.write(<span class="string">&quot;(&#x27;&#123;0&#125;&#x27;, &#x27;&#123;1&#125;&#x27;);&quot;</span>.format(<span class="keyword">max</span>, chars[<span class="keyword">max</span> % <span class="keyword">len</span>(chars)]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="keyword">open</span>(<span class="string">&#x27;insert.sql&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> <span class="keyword">file</span>:</span><br><span class="line">    <span class="keyword">start</span> = <span class="number">1000001</span></span><br><span class="line">    <span class="keyword">end</span> = <span class="number">1001001</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="keyword">start</span>, <span class="keyword">end</span>):</span><br><span class="line">        file.write(<span class="string">&quot;INSERT INTO dirty_table (`id`, `c1`, `c2`) VALUES (&#x27;&#123;0&#125;&#x27;, &#x27;&#123;1&#125;&#x27;, &#x27;&#123;2&#125;&#x27;);\n&quot;</span>.format(i, i, chars[i % <span class="keyword">len</span>(chars)]))</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ•°æ®è½¬ç§»è„šæœ¬</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dirty_table <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> dirty_table <span class="keyword">WHERE</span> c1 &gt; <span class="number">1000</span>;</span><br><span class="line"><span class="comment">-- åŒæ—¶æ‰§è¡Œinsert.sqlé‡Œé¢çš„è„šæœ¬ï¼Œæ¨¡æ‹Ÿæ­¤æ—¶æœ‰ç”¨æˆ·æ“ä½œçš„æƒ…å†µ</span></span><br></pre></td></tr></table></figure><h4 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h4><p>å…ˆè¿è¡Œ<code>INSERT INTO ... SELECT ...</code>è¯­å¥ï¼Œç„¶åå†è¿è¡Œ<code>INSERT INTO ...</code>è¯­å¥ï¼Œæ¨¡æ‹Ÿæ­¤æ—¶æœ‰ç”¨æˆ·åœ¨ä½¿ç”¨ã€‚</p><p>ç„¶åä½ ä¼šå‘ç°å¹¶æ²¡æœ‰å¦‚é¢„æœŸä¸­é‚£æ ·è¢«é˜»å¡ğŸ˜‚</p><p>ä¸€å¼€å§‹æˆ‘ä¹Ÿå¾ˆæ‡µé€¼ï¼Œç”šè‡³æœ‰ç‚¹æ…Œï¼ˆæ¯•ç«Ÿæˆ‘åé¢è¿˜ä¿¡èª“æ—¦æ—¦å»æ‰¾æˆ‘ç»ç†è¯´è¿™ç©æ„ä¹Ÿä¼šé”è¡¨çš„ğŸ˜‚ï¼‰</p><p>ç„¶åå¼€å§‹ç¿»èµ„æ–™ï¼Œåœ¨<a href="https://www.percona.com/blog/2006/07/12/insert-into-select-performance-with-innodb-tables/">INSERT INTO â€¦ SELECT Performance with Innodb tables.</a>è¿™ç¯‡æ–‡ç« é‡Œä»‹ç»äº†ä¸ºä»€ä¹ˆä¼šåŠ é”ã€‚è¿™ç¯‡æ–‡ç« çš„å¤§è‡´æ„æ€æ˜¯ï¼šä¸€èˆ¬çš„<code>SELECT</code>é¢„è®¡æ˜¯ä¸ä¼šåŠ é”çš„ï¼Œé™¤éæ˜¾ç¤ºçš„ç”³æ˜<code>IN SHARE MODE</code>æˆ–è€…<code>FOR UPDATE</code>ï¼Œä½†æ˜¯<code>INSERT INTO table1 SELECT * FORM table2</code>æ˜¯ä¸ªç‰¹ä¾‹ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™ä¼šé”ä½è¡¨<code>table2</code>ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢åœ¨<code>SELECT</code>çš„æ—¶å€™æœ‰å…¶ä»–çš„äº‹åŠ¡æ›´æ–°æ•°æ®å¯¼è‡´å¤åˆ¶çš„æ—¶å€™å‡ºç°ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ä¸è¿‡è¿™ç¯‡èµ„æ–™æœ‰ç‚¹è€äº†ï¼Œæ˜¯2008å¹´çš„ï¼Œè€Œä¸”å†™çš„æ—¶å€™ç”¨çš„å¥½åƒæ˜¯MySQL 5.1ğŸ˜‚ï¼Œä¸è¿‡é“ç†è¿˜æ˜¯å¯¹çš„ã€‚</p><p>ç„¶è€Œè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°ä¸ºä»€ä¹ˆè¿™é‡Œæ²¡æœ‰åŠ é”çš„åŸå› ï¼Œäºæ˜¯åˆå¼€å§‹åœ¨Googleçš„æµ·æ´‹é‡Œé¨æ¸¸ï¼Œç»ˆäºç»™æˆ‘æ‰¾åˆ°äº†<code>Stackover Flow</code>é‡Œé¢çš„ä¸€ä¸ªé—®é¢˜ï¼š<a href="https://stackoverflow.com/questions/2640898/how-to-improve-insert-into-select-locking-behavior">How to improve INSERT INTO â€¦ SELECT locking behavior</a>ï¼Œè¿™ä½å¤§ä½¬çš„é—®é¢˜å¤§è‡´æ„æ€æ˜¯ä»–ä»¬å…¬å¸æœ‰ä¸ª<code>INSERT INTO ... SELECT ... </code>ï¼Œç„¶åå®šæ—¶çš„è·‘ï¼Œä»–å‘ç°æ‰§è¡Œè¿™ä¸ªä¸œè¥¿çš„æ—¶å€™å…¶å®ƒæŸ¥è¯¢æ¶‰åŠåˆ°çš„è¡¨çš„æ—¶å€™è€—æ—¶å¾ˆé•¿ï¼Œé—®é—®è¯¥æ€ä¹ˆæå‡æ€§èƒ½ã€‚ä¸‹é¢çš„ä¸€ä¸ªå›ç­”ç»™æˆ‘å¯å‘ï¼š</p><p>å¯ä»¥è®¾ç½®<code>binlog_format = ROWS</code></p><p>è«éæˆ‘çš„è¿™ä¸ªè®¾ç½®ä¸æ˜¯ROWSï¼Ÿ</p><p>èµ¶ç´§æŸ¥æŸ¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> <span class="keyword">VARIABLES</span> <span class="keyword">LIKE</span> <span class="string">&#x27;%binlog_format%&#x27;</span></span><br></pre></td></tr></table></figure><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201013231111.png"></p><p>æœç„¶å¦‚æ­¤ï¼Œèµ¶ç´§ä¿®æ”¹ï¼ˆè¿™é‡Œè¿˜æœ‰æŸ¥é˜…binlog_formatçš„èµ„æ–™ï¼Œä½†æ˜¯ç”±äºç¯‡å¹…é—®é¢˜å°±ä¸å±•å¼€è®¨è®ºäº†ï¼Œåç»­ä¼šä¸“é—¨å¯¹binlog_formatè¿›è¡Œæ·±å…¥çš„åˆ†æäº†è§£ï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> binlog_format = <span class="keyword">STATEMENT</span>;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¥ä¸ºè¿™æ ·å°±ä¸‡äº‹å¤§å‰äº†ï¼Œç„¶è€Œæµ‹è¯•çš„æ—¶å€™è¿˜æ˜¯æ²¡æœ‰å‡ºç°é¢„æœŸä¸­çš„æƒ…å†µï¼Œçœ‹æ¥è¿˜æœ‰ä¸€äº›æˆ‘æ²¡æ³¨æ„åˆ°çš„åœ°æ–¹ï¼Œç»§ç»­GoogleğŸ˜¶</p><p>åœ¨<a href="https://cloud.tencent.com/developer/article/1639457">insertè¯­å¥çš„åŠ é”æƒ…å†µåˆ†æ</a>ä¸­ç®€å•ä»‹ç»äº†<code>innodb_autoinc_lock_mode</code>çš„ä¸‰ç§æ¨¡å¼ï¼ŒåŸæ¥è¿˜éœ€è¦ä¿®æ”¹è¿™ä¸ªä¸œè¥¿ã€‚å’Œ<code>binlog_format</code>ä¸åŒï¼Œè¿™ä¸ªéœ€è¦åˆ°<code>my.cnf</code>é‡Œé¢ä¿®æ”¹ï¼Œç„¶åé‡æ–°å¯åŠ¨MySQLæ‰èƒ½ç”Ÿæ•ˆã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">VARIABLES</span> <span class="keyword">LIKE</span> <span class="string">&#x27;%innodb_autoinc_lock_mode%&#x27;</span></span><br></pre></td></tr></table></figure><p>åˆ°æ­¤ï¼Œç»ˆäºå¾—åˆ°æˆ‘é¢„æœŸçš„æ•ˆæœäº†ï¼ŒçœŸçš„æ˜¯å¤ªéš¾äº†~</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201013224411.jpg"></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ä»éªŒè¯çš„è¿‡ç¨‹ä¸­æ¥çœ‹ï¼ŒMySQLï¼ˆæˆ‘çš„ç‰ˆæœ¬æ˜¯8.0+çš„ï¼‰é»˜è®¤çš„<code>binlog_format</code>ã€<code>innodb_autoinc_lock_mode</code>è®¾ç½®ï¼Œå¯ä»¥ä¿è¯åœ¨æ‰§è¡Œçš„æ—¶å€™ä¸ä¼šé”å…¨è¡¨ï¼Œå½±å“å…¶å®ƒä¸šåŠ¡çš„æ­£å¸¸è¿è¡Œï¼Œå› æ­¤å»ºè®®è¿˜æ˜¯ä½¿ç”¨<code>INSERT INTO ... SELECT ... </code>è€Œä¸æ˜¯<code>RENAME</code></p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><ol><li><a href="https://juejin.im/post/6844904086173646862">Insert into selectè¯­å¥å¼•å‘çš„ç”Ÿäº§äº‹æ•…</a></li><li><a href="https://www.percona.com/blog/2006/07/12/insert-into-select-performance-with-innodb-tables/">INSERT INTO â€¦ SELECT Performance with Innodb tables.</a></li><li><a href="https://stackoverflow.com/questions/2640898/how-to-improve-insert-into-select-locking-behavior">How to improve INSERT INTO â€¦ SELECT locking behavior</a></li><li><a href="https://cloud.tencent.com/developer/article/1639457">insertè¯­å¥çš„åŠ é”æƒ…å†µåˆ†æ</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
            <tag> é” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLä¸­çš„é”</title>
      <link href="2020/10/08/f312680c.html"/>
      <url>2020/10/08/f312680c.html</url>
      
        <content type="html"><![CDATA[<h2 id="å…±äº«é”-æ’ä»–é”"><a href="#å…±äº«é”-æ’ä»–é”" class="headerlink" title="å…±äº«é”/æ’ä»–é”"></a>å…±äº«é”/æ’ä»–é”</h2><p>å…±äº«é”ä¹Ÿç§°ä¸ºè¯»é”ï¼Œä¸€ä¸ªäº‹åŠ¡å¯¹æŸä¸€è¡Œè®°å½•åŠ äº†å…±äº«é”çš„æƒ…å†µä¸‹ï¼Œ å…¶å®ƒçš„äº‹åŠ¡ä¹Ÿå¯ä»¥å¯¹è¿™ä¸€è¡Œè®°å½•åŠ å…±äº«é”ï¼Œä½†æ˜¯ä¸å¯ä»¥åŠ æ’ä»–é”ã€‚</p><p>æ’ä»–é”ä¹Ÿç§°ä¸ºå†™é”ï¼Œä¸€ä¸ªäº‹åŠ¡å¯¹æŸä¸€è¡ŒåŠ äº†æ’ä»–é”çš„æƒ…å†µä¸‹ï¼Œå…¶ä»–çš„äº‹åŠ¡ä¸å¯ä»¥å¯¹è¿™ä¸€è¡Œå†åŠ è¯»é”æˆ–è€…å†™é”ã€‚</p><p>åœ¨æŸ¥è¯¢æ—¶åŠ ä¸Š<code>IN SHARE MODE</code>å¯ä»¥è·å–å…±äº«é”ï¼ŒåŠ ä¸Š<code>LOCK FOR UPDATE</code>å¯ä»¥è·å–æ’ä»–é”ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒUPDATEã€INSERTç­‰è¯­å¥ä¼šè‡ªåŠ¨åŠ ä¸Šæ’ä»–é”ã€‚</p><h2 id="è¡Œé”"><a href="#è¡Œé”" class="headerlink" title="è¡Œé”"></a>è¡Œé”</h2><p>åœ¨MySQLå®˜ç½‘ä¸Šå…³äºè¡Œé”æœ‰è¿™ä¹ˆä¸€æ®µè¯</p><blockquote><p>Record locks always lock index records, even if a table is defined with no indexes. For such cases, <code>InnoDB</code> creates a hidden clustered index and uses this index for record locking</p></blockquote><p>æ„æ€æ˜¯ï¼Œè¡Œé”ä¸€å®šæ˜¯é€šè¿‡ç´¢å¼•åŠ ä¸Šçš„ï¼ŒMySQLæœ¬èº«å¹¶æ²¡æœ‰å®ç°è¡Œé”çš„æ–¹å¼ï¼Œè¡Œé”æ˜¯ç”±å­˜å‚¨å¼•æ“å®ç°çš„ï¼Œå› æ­¤æœ‰çš„å­˜å‚¨å¼•æ“æ”¯æŒè¡Œé”ï¼ˆä¾‹å¦‚InnoDBï¼‰ï¼Œæœ‰çš„ä¸æ”¯æŒï¼ˆä¾‹å¦‚MyISAMï¼‰ï¼Œè¡Œé”çš„ä¸€ä¸ªä¼˜åŠ¿æ˜¯ç²’åº¦å°ï¼Œå¹¶å‘é«˜ï¼Œç¼ºç‚¹æ˜¯å®ç°å¤æ‚ï¼Œå¼€é”€å¤§ã€‚</p><h2 id="æ„å‘é”"><a href="#æ„å‘é”" class="headerlink" title="æ„å‘é”"></a>æ„å‘é”</h2><p>åœ¨MySQLä¸­ä¼šæœ‰è¿™ä¹ˆä¸€ç§æƒ…å†µï¼Œäº‹åŠ¡Aå¯¹è¡¨TåŠ äº†è¡Œé”ï¼Œç„¶åäº‹åŠ¡Bå¯¹è¡¨TåŠ äº†è¡¨é”ã€‚æ­¤æ—¶ä¼šå‡ºç°ä¸€ä¸ªé©³è®ºï¼šäº‹åŠ¡AåŠ äº†è¡Œé”çš„è¿™ä¸€è¡Œä»…å…è®¸äº‹åŠ¡Aè¿›è¡Œä¿®æ”¹ï¼Œäº‹åŠ¡BåŠ äº†è¡¨é”ï¼Œå¯ä»¥å¯¹è¡¨ä¸­çš„ä»»æ„è¡Œè¿›è¡Œä¿®æ”¹ã€‚æ„å‘é”çš„ç›®çš„å°±æ˜¯ä¸ºäº†è®©è¡Œé”å’Œè¡¨é”å…±å­˜ã€‚</p><p>å½“äº‹åŠ¡Aè¦ç»™æŸä¸€è¡ŒåŠ è¡Œé”æ—¶ï¼Œé¦–å…ˆä¼šç»™äº‹åŠ¡Aè·å–ä¸€ä¸ªè¯¥è¡¨çš„æ„å‘æ’ä»–é”ï¼Œç„¶åæ‰èƒ½å¤Ÿè·å–åˆ°è¿™ä¸€è¡Œçš„è¡Œé”ï¼Œå½“Bäº‹åŠ¡è¦åŠ è¡¨é”çš„æ—¶å€™ï¼Œç”±äºæ­¤æ—¶è¡¨ä¸Šå·²ç»æœ‰äº†æ„å‘æ’ä»–é”äº†ï¼Œå› æ­¤äº‹åŠ¡BåŠ é”å¤±è´¥ï¼Œè¢«é˜»å¡äº†ã€‚å…¶æ•´ä¸ªè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><table><thead><tr><th>äº‹åŠ¡A</th><th>äº‹åŠ¡B</th></tr></thead><tbody><tr><td>begin;</td><td></td></tr><tr><td>SELECT â€¦ FOR UPDATE;<br />è·å–åˆ°æ„å‘æ’ä»–é”ï¼ˆIXï¼‰ã€è·å–åˆ°æ’ä»–é”ï¼ˆXï¼‰</td><td></td></tr><tr><td></td><td>LOCK TABLES â€¦.;<br />é˜»å¡ï¼Œç­‰å¾…é”é‡Šæ”¾</td></tr><tr><td>commit;</td><td></td></tr><tr><td></td><td>è·å–è¡¨é”æˆåŠŸ</td></tr></tbody></table><p>æ„å‘é”å’Œå…¶ä»–é”çš„å…¼å®¹æƒ…å†µï¼š</p><table><thead><tr><th></th><th>X</th><th>IX</th><th>S</th><th>IS</th></tr></thead><tbody><tr><td>X</td><td>å†²çª</td><td>å†²çª</td><td>å†²çª</td><td>å†²çª</td></tr><tr><td>IX</td><td>å†²çª</td><td>å…¼å®¹</td><td>å†²çª</td><td>å…¼å®¹</td></tr><tr><td>S</td><td>å†²çª</td><td>å†²çª</td><td>å…¼å®¹</td><td>å…¼å®¹</td></tr><tr><td>IS</td><td>å†²çª</td><td>å…¼å®¹</td><td>å…¼å®¹</td><td>å…¼å®¹</td></tr></tbody></table><div class="note info simple"><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ„å‘é”ä¸€å®šæ˜¯è¡¨çº§é”</p></div><h2 id="é—´éš™é”"><a href="#é—´éš™é”" class="headerlink" title="é—´éš™é”"></a>é—´éš™é”</h2><p>MySQLå¯¹é—´éš™é”çš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼š</p><blockquote><p>A gap lock is a lock on a gap between index records, or a lock on the gap before the first or after the last index record. For example, <code>SELECT c1 FROM t WHERE c1 BETWEEN 10 and 20 FOR UPDATE;</code> prevents other transactions from inserting a value of <code>15</code> into column <code>t.c1</code>, whether or not there was already any such value in the column, because the gaps between all existing values in the range are locked.</p></blockquote><p>è¿™æ®µè¯è¯´æ˜ï¼š</p><ol><li>é—´éš™é”ä¸€å®šæ˜¯ä¸€ä¸ªå¼€åŒºé—´</li><li>é—´éš™é”ä¼šé˜²æ­¢å…¶å®ƒäº‹åŠ¡æ’å…¥é—´éš™åŒºé—´å†…çš„å€¼</li></ol><p>å¦ä¸€æ®µè¯´æ˜æ˜¯è¿™æ ·çš„ï¼š</p><blockquote><p>Gap locks in <code>InnoDB</code> are â€œpurely inhibitiveâ€, which means that their only purpose is to prevent other transactions from inserting to the gap. Gap locks can co-exist. A gap lock taken by one transaction does not prevent another transaction from taking a gap lock on the same gap. There is no difference between shared and exclusive gap locks. They do not conflict with each other, and they perform the same function.</p></blockquote><p>è¿™æ®µè¯çš„æ„æ€æ˜¯ï¼Œä¸åŒçš„äº‹åŠ¡åŒä¸€ä¸ªé—´éš™é”å¹¶ä¸ä¼šå†²çªï¼Œç”šè‡³æœ‰åŒ…å«å…³ç³»ä¹Ÿæ²¡äº‹ã€‚</p><p>è¿˜æœ‰ä¸€æ®µè¯´æ˜æ˜¯è¿™æ ·çš„ï¼š</p><blockquote><p>There are also other effects of using the <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-transaction-isolation-levels.html#isolevel_read-committed"><code>READ COMMITTED</code></a> isolation level. Record locks for nonmatching rows are released after MySQL has evaluated the <code>WHERE</code> condition. For <code>UPDATE</code> statements, <code>InnoDB</code> does a â€œsemi-consistentâ€ read, such that it returns the latest committed version to MySQL so that MySQL can determine whether the row matches the <code>WHERE</code> condition of the <a href="https://dev.mysql.com/doc/refman/8.0/en/update.html"><code>UPDATE</code></a>.</p></blockquote><p>è¿™æ®µè¯çš„æ„æ€æ˜¯ï¼Œåœ¨ä½äºæˆ–ç­‰äºè¯»å·²æäº¤çš„éš”ç¦»çº§åˆ«ä¸‹ï¼Œé—´éš™é”æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºè¿™ç§éš”ç¦»çº§åˆ«æ€»ä¼šè¯»å–åˆ°æœ€æ–°çš„æ•°æ®ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼š</p><ol><li>é—´éš™é”é”å®šçš„æ˜¯ä¸€ä¸ªå¼€åŒºé—´</li><li>å…¶ä»–äº‹åŠ¡ä¸å¯ä»¥å‘é—´éš™é”åŒºé—´å†…æ’å…¥å€¼</li><li>å¤šä¸ªäº‹åŠ¡å¯ä»¥è·å–åŒä¸€ä¸ªé—´éš™é”</li><li>é—´éš™é”åªåœ¨å¯é‡å¤è¯»çš„æƒ…å†µä¸‹ç”Ÿæ•ˆï¼ˆä¸²è¡ŒåŒ–æ²¡æœ‰å¿…è¦äº†ï¼‰</li></ol><h3 id="é—´éš™é”æµ‹è¯•"><a href="#é—´éš™é”æµ‹è¯•" class="headerlink" title="é—´éš™é”æµ‹è¯•"></a>é—´éš™é”æµ‹è¯•</h3><h4 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_lock_test`</span> (</span><br><span class="line">  <span class="string">`a`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`b`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`a`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`idx_b`</span> (<span class="string">`b`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8mb4 <span class="keyword">COLLATE</span>=utf8mb4_0900_ai_ci</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_lock_test <span class="keyword">VALUES</span> (<span class="number">0</span>, <span class="string">&#x27;a&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;c&#x27;</span>), (<span class="number">5</span>, <span class="string">&#x27;d&#x27;</span>), (<span class="number">6</span>, <span class="string">&#x27;g&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sql&gt; SELECT * FROM t_lock_test;</span><br><span class="line">+<span class="comment">---+---+</span></span><br><span class="line">| a | b |</span><br><span class="line">+<span class="comment">---+---+</span></span><br><span class="line">| 0 | a |</span><br><span class="line">| 3 | c |</span><br><span class="line">| 5 | d |</span><br><span class="line">| 6 | g |</span><br><span class="line">+<span class="comment">---+---+</span></span><br></pre></td></tr></table></figure><h3 id="æ­£å¼å¼€å§‹"><a href="#æ­£å¼å¼€å§‹" class="headerlink" title="æ­£å¼å¼€å§‹"></a>æ­£å¼å¼€å§‹</h3><h4 id="æŒ‰ç…§ä¸»é”®ç´¢å¼•åŠ é—´éš™é”"><a href="#æŒ‰ç…§ä¸»é”®ç´¢å¼•åŠ é—´éš™é”" class="headerlink" title="æŒ‰ç…§ä¸»é”®ç´¢å¼•åŠ é—´éš™é”"></a>æŒ‰ç…§ä¸»é”®ç´¢å¼•åŠ é—´éš™é”</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- session1</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_lock_test <span class="keyword">WHERE</span> a = <span class="number">3</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- session2</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_lock_test <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;c&#x27;</span>); <span class="comment">-- æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h4 id="æŒ‰ç…§ä¸»é”®ç´¢å¼•èŒƒå›´åŠ é—´éš™é”"><a href="#æŒ‰ç…§ä¸»é”®ç´¢å¼•èŒƒå›´åŠ é—´éš™é”" class="headerlink" title="æŒ‰ç…§ä¸»é”®ç´¢å¼•èŒƒå›´åŠ é—´éš™é”"></a>æŒ‰ç…§ä¸»é”®ç´¢å¼•èŒƒå›´åŠ é—´éš™é”</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- session1</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_lock_test <span class="keyword">WHERE</span> a <span class="keyword">BETWEEN</span> <span class="number">3</span> <span class="keyword">AND</span> <span class="number">5</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- session2</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_lock_test <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;a&#x27;</span>); <span class="comment">-- å¤±è´¥</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_lock_test <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;d&#x27;</span>); <span class="comment">-- å¤±è´¥</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_lock_test <span class="keyword">VALUES</span> (<span class="number">7</span>, <span class="string">&#x27;h&#x27;</span>); <span class="comment">-- æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h4 id="é”ä½ä¸å­˜åœ¨çš„æ•°æ®"><a href="#é”ä½ä¸å­˜åœ¨çš„æ•°æ®" class="headerlink" title="é”ä½ä¸å­˜åœ¨çš„æ•°æ®"></a>é”ä½ä¸å­˜åœ¨çš„æ•°æ®</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- session1</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_lock_test <span class="keyword">WHERE</span> a = <span class="number">2</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- session2</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_lock_test <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;m&#x27;</span>); <span class="comment">-- å¤±è´¥</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_lock_test <span class="keyword">VALUES</span> (<span class="number">7</span>, <span class="string">&#x27;h&#x27;</span>); <span class="comment">-- æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h4 id="æŒ‰ç…§éä¸»é”®ç´¢å¼•åŠ é—´éš™é”"><a href="#æŒ‰ç…§éä¸»é”®ç´¢å¼•åŠ é—´éš™é”" class="headerlink" title="æŒ‰ç…§éä¸»é”®ç´¢å¼•åŠ é—´éš™é”"></a>æŒ‰ç…§éä¸»é”®ç´¢å¼•åŠ é—´éš™é”</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- session1</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_lock_test <span class="keyword">WHERE</span> b = <span class="string">&#x27;c&#x27;</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- session2</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_lock_test <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;a&#x27;</span>); <span class="comment">-- å¤±è´¥</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_lock_test <span class="keyword">VALUES</span> (<span class="number">7</span>, <span class="string">&#x27;d&#x27;</span>); <span class="comment">-- æˆåŠŸ</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_lock_test <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;b&#x27;</span>); <span class="comment">-- å¤±è´¥</span></span><br></pre></td></tr></table></figure><h3 id="åˆ¤æ–­é—´éš™é”çš„èŒƒå›´"><a href="#åˆ¤æ–­é—´éš™é”çš„èŒƒå›´" class="headerlink" title="åˆ¤æ–­é—´éš™é”çš„èŒƒå›´"></a>åˆ¤æ–­é—´éš™é”çš„èŒƒå›´</h3><p>ä»ä¸Šè¿°ä¾‹å­ä¸­ï¼Œä¸éš¾çœ‹å‡ºé—´éš™é”çš„èŒƒå›´ï¼Œä»¥æŒ‰ç…§ä¸ºä¸»é”®ç´¢å¼•åŠ é—´éš™é”ä¸ºä¾‹</p><p>å…¶èŒƒå›´åŒºé—´å¯ä»¥åˆ’åˆ†ä¸º</p><p><code>(-âˆ, a) -- (a, c) -- (c, d)</code></p><p>ç”±äºéèšç°‡ç´¢å¼•çš„ç‰¹æ€§ï¼Œå¦‚æœéèšç°‡ç´¢å¼•ç›¸åŒçš„è¯ï¼Œå°±ä¼šæŒ‰ç…§ä¸»é”®ç´¢å¼•è¿›è¡Œæ’åºï¼Œå› æ­¤å®é™…ä¸Šæ ¹æ®ç´¢å¼•ç»“æ„æ¥åˆ’åˆ†çš„è¯ï¼Œå…¶é”å®šçš„åŒºé—´åº”è¯¥æ˜¯è¿™æ ·çš„</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201011214945.png"></p><p>åœ¨è¿™ä¸ªèŒƒå›´å†…æ’å…¥å€¼éƒ½ä¼šè¢«é”å®š</p><h3 id="é—´éš™é”æ€»ç»“"><a href="#é—´éš™é”æ€»ç»“" class="headerlink" title="é—´éš™é”æ€»ç»“"></a>é—´éš™é”æ€»ç»“</h3><p>ä»ä¸Šè¿°çš„å‡ ä¸ªä¾‹å­ä¸­ä¸éš¾çœ‹å‡ºé—´éš™é”çš„å‡ ä¸ªç‰¹æ€§ï¼š</p><ol><li>æŒ‰ç…§ä¸»é”®ç´¢å¼•ä¸ä¸ä¼šåŠ é—´éš™é”</li><li>æŒ‰ç…§ä¸»é”®ç´¢å¼•èŒƒå›´æˆ–è€…é”ä½ä¸å­˜åœ¨çš„å€¼çš„æ—¶å€™æ‰ä¼šåŠ é—´éš™é”</li><li>æŒ‰ç…§éä¸»é”®ç´¢å¼•ä¸€å®šä¼šåŠ é—´éš™é”</li><li>è¿˜æœ‰ä¸€ç‚¹æ²¡æœ‰åœ¨æµ‹è¯•ä¸­å±•ç°ï¼Œä¸»é”®ç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•çš„æ•ˆæœæ˜¯ä¸€æ ·çš„</li></ol><h2 id="ä¸´é”®é”"><a href="#ä¸´é”®é”" class="headerlink" title="ä¸´é”®é”"></a>ä¸´é”®é”</h2><p>MySQLå¯¹ä¸´é”®é”çš„å®šä¹‰æ˜¯è¿™æ ·çš„</p><blockquote><p>A next-key lock is a combination of a record lock on the index record and a gap lock on the gap before the index record.</p></blockquote><p>å¤§è‡´çš„æ„æ€å°±æ˜¯ï¼Œä¸´é”®é”æ˜¯è¡Œé”å’Œé—´éš™é”çš„ä¸€ç§ç»„åˆï¼Œä¸´é”®é”ä¸ä»…è¦é”ä½ç´¢å¼•è¡Œï¼Œè¿˜è¦é”ä½èŒƒå›´åŒºé—´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„é—´éš™é”</p><p>MySQLå¯¹ä¸´é”®é”è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„æè¿°</p><blockquote><p>By default, <code>InnoDB</code> operates in <code>REPEATABLE READ</code> transaction isolation level. In this case, <code>InnoDB</code> uses next-key locks for searches and index scans, which prevents phantom rows </p></blockquote><p>InnoDBåœ¨å¯é‡å¤è¯»è¿™ç§éš”ç¦»çº§åˆ«ä¸‹ï¼Œæ˜¯é€šè¿‡ä¸´é”®é”æ¥è¿›è¡Œæœç´¢å’Œç´¢å¼•æ‰«æçš„ï¼Œè¿™æ ·çš„ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢å¹»è¯»çš„å‡ºç°ã€‚é˜²æ­¢å¹»è¯»çš„åŸç†å¾ˆç®€å•ï¼Œå› ä¸ºé”çš„æ˜¯ä¸€ä¸ªåŒºé—´ï¼Œå¦‚æœè¦åœ¨è¿™ä¸ªåŒºé—´é‡Œé¢æ’å…¥å€¼ï¼Œé‚£ä¹ˆæ˜¯ä¼šé˜»å¡çš„ï¼Œè€Œä¹‹æ‰€ä»¥è¯´æ˜¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šï¼Œé‚£æ˜¯å› ä¸ºé¦–å…ˆéœ€è¦åŠ é”ï¼Œå¦‚æœé‡‡ç”¨çš„æ˜¯æ™®é€šçš„<code>SELECT</code>è€Œä¸æ˜¯<code>SELECT ... IN SHARE MODE</code>æˆ–è€…<code>SELECT ... FOR UPDATE</code>ï¼Œé‚£ä¹ˆMySQLé‡‡ç”¨çš„è¿˜æ˜¯å¿«ç…§è¯»ï¼Œå¹¶ä¸ä¼šåŠ é”ã€‚</p><h2 id="æ’å…¥æ„å‘é”"><a href="#æ’å…¥æ„å‘é”" class="headerlink" title="æ’å…¥æ„å‘é”"></a>æ’å…¥æ„å‘é”</h2><p>MySQLå¯¹æ’å…¥æ„å‘é”çš„æè¿°æ˜¯è¿™æ ·çš„ï¼š</p><blockquote><p>An insert intention lock is a type of gap lock set by <a href="https://dev.mysql.com/doc/refman/8.0/en/insert.html"><code>INSERT</code></a> operations prior to row insertion. This lock signals the intent to insert in such a way that multiple transactions inserting into the same index gap need not wait for each other if they are not inserting at the same position within the gap. Suppose that there are index records with values of 4 and 7. Separate transactions that attempt to insert values of 5 and 6, respectively, each lock the gap between 4 and 7 with insert intention locks prior to obtaining the exclusive lock on the inserted row, but do not block each other because the rows are nonconflicting.</p></blockquote><p>è¿™æ®µè¯çš„å¤§æ„æ˜¯è¿™æ ·çš„ï¼šæ’å…¥æ„å‘é”æ˜¯ä¸€ç§<code>é—´éš™é”</code>ï¼Œæ’å…¥æ„å‘é”çš„ç›®çš„æ˜¯åœ¨å¤šä¸ªäº‹åŠ¡å¹¶å‘æ’å…¥çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½è¿™äº›äº‹åŠ¡æ’å…¥çš„ä¸æ˜¯åŒä¸€ä¸ªåœ°æ–¹ï¼Œä¸ºäº†é¿å…äº’ç›¸ç­‰å¾…è€Œå¼„å‡ºæ¥çš„ä¸œè¥¿ã€‚</p><p>æ€»ç»“å½’çº³ä¸€ä¸‹æ’å…¥æ„å‘é”ï¼š</p><ol><li>æ˜¯ä¸€ä¸ªé—´éš™é”</li><li>å’Œé—´éš™é”ä¸åŒçš„åœ°æ–¹æ˜¯ï¼Œæ’å…¥æ„å‘é”é”å®šçš„åŒºé—´æ˜¯ä¸€æ¡è®°å½•ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªèŒƒå›´</li><li>æ’å…¥æ„å‘é”çš„ç›®çš„æ˜¯ä¸ºäº†æå‡å¹¶å‘æ’å…¥çš„æ•ˆç‡</li></ol><h2 id="è‡ªå¢é”"><a href="#è‡ªå¢é”" class="headerlink" title="è‡ªå¢é”"></a>è‡ªå¢é”</h2><p>è¿˜æ˜¯å…ˆæ¥ä¸€æ®µMySQLå®˜æ–¹çš„æè¿°</p><blockquote><p>An <code>AUTO-INC</code> lock is a special table-level lock taken by transactions inserting into tables with <code>AUTO_INCREMENT</code> columns. In the simplest case, if one transaction is inserting values into the table, any other transactions must wait to do their own inserts into that table, so that rows inserted by the first transaction receive consecutive primary key values.</p></blockquote><p>MySQLæ•°æ®åº“é‡Œé¢å­—æ®µå®å¯ä»¥è®¾ç½®è‡ªå¢çš„ï¼Œè¿™äº›è‡ªå¢çš„å­—æ®µåœ¨å¹¶å‘çš„æƒ…å†µä¸‹ä¿è¯ä¸ä¼šå‡ºç°æ•°æ®å®‰å…¨é—®é¢˜ï¼Œå…¨é è‡ªå¢é”ç»´æŒï¼Œåœ¨å¾€è‡ªå¢å­—æ®µé‡Œé¢æ’å…¥å€¼çš„æ—¶å€™ï¼Œä¼šåŠ ä¸€ä¸ªè‡ªå¢é”ï¼Œè¿™ä¸ªé”æ˜¯<span style="color:red;">è¡¨é”</span>ï¼Œæ‰€ä»¥å…¶å®ƒçš„äº‹åŠ¡åœ¨æ’å…¥çš„æ—¶å€™ï¼Œåªèƒ½ç­‰å¾…å‰é¢é‚£ä¸ªè·å–åˆ°è‡ªå¢é”çš„äº‹åŠ¡å¼„å¥½äº†æ‰èƒ½å¾€é‡Œé¢æ’å…¥ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½¿ç”¨MySQLçš„ä¸»é”®è‡ªå¢ç­–ç•¥ä¼šæœ‰ç“¶é¢ˆé—®é¢˜çš„åŸå› æ‰€åœ¨ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-locking.html">MySQLå®˜ç½‘</a></li><li><a href="https://blog.csdn.net/Saintyyu/article/details/91269087">MySQLå¸¸è§çš„ä¸ƒç§é”è¯¦ç»†ä»‹ç»</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
            <tag> é” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL JOINæ‰§è¡Œç»†èŠ‚</title>
      <link href="2020/10/08/1ceae895.html"/>
      <url>2020/10/08/1ceae895.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¶ç„¶é—´çœ‹åˆ°è¿™ä¸€ç¯‡åšå®¢ã€Š<a href="https://segmentfault.com/a/1190000015572505">Mysql - JOINè¯¦è§£</a>ã€‹ï¼Œå…¶ä¸­æœ‰ä¸€éƒ¨åˆ†æ˜¯å¯¹è”è¡¨è¿‡ç¨‹çš„æè¿°ï¼Œè¿™æ®µæè¿°çœ‹å®Œä»¥åæ„Ÿè§‰æ€ªæ€ªçš„ï¼Œå¦‚ä¸‹:</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://i.loli.net/2020/10/08/ucHMS5lYomRaDbi.png" alt="3__8CHW8T~ZITUX9MYVE_@T.png"></p><p>å¦‚æœä¸¤ä¸ªè¡¨çš„æ•°æ®é‡éƒ½åœ¨ç™¾ä¸‡çº§åˆ«ï¼Œé‚£ä¹ˆç…§è¿™ä¸ªè¯´æ³•ï¼Œå…ˆæ¥ä¸€æ¬¡ç¬›å¡å°”ç§¯ï¼Œå¾—åˆ°çš„<code>vt1</code>è¡¨å°†æ˜¯åä¸‡äº¿+çº§åˆ«çš„ï¼Œè¿™ç›´æ¥å°±å¯ä»¥æŠŠå†…å­˜æç‚¸äº†å§â€¦â€¦</p><p>ä¹‹åçœ‹äº†å…¶å®ƒçš„åšå®¢å’Œå®˜æ–¹æ–‡æ¡£ä»¥åï¼ŒJOINæ˜¯é€šè¿‡ä¸¤ç§ç®—æ³•<code>Nested-Loop Join</code>å’Œ<code>Block Nested-Loop Join</code>å®ç°çš„</p><h2 id="Nested-Loop-Join"><a href="#Nested-Loop-Join" class="headerlink" title="Nested-Loop Join"></a>Nested-Loop Join</h2><p>å½“ONæ¡ä»¶ä½¿ç”¨ç´¢å¼•æ—¶ï¼Œé‡‡ç”¨çš„æ˜¯<code>Nested-Loop Join</code>ç®—æ³•ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t_student.*, t_score.* <span class="keyword">FROM</span> t_student <span class="keyword">JOIN</span> t_score <span class="keyword">ON</span> t_student.stu_id = t_score.stu_id <span class="keyword">WHERE</span> t_student.stu_id = <span class="string">&#x27;1&#x27;</span></span><br></pre></td></tr></table></figure><p>å‡è®¾åœ¨<code>stu_id</code>ä¸ŠåŠ äº†ç´¢å¼•ï¼Œé‚£ä¹ˆè¿™ä¸ªJOINçš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼ˆå‡è®¾ä»¥<code>t_student</code>åšé©±åŠ¨è¡¨ï¼‰ï¼š</p><ol><li><p>æ ¹æ®æ¡ä»¶<code>t_student.stu_id = &#39;1&#39;</code>ä»<code>t_student</code>ä¸­è·å–å¯¹åº”çš„ä¸»é”®</p></li><li><p>æ ¹æ®ä¸Šä¸€æ­¥è·å–çš„ä¸»é”®å›è¡¨è·å–<code>t_student</code>çš„æ•°æ®</p></li><li><p>æ ¹æ®è¿™ä¸€è¡Œæ•°æ®çš„<code>stu_id</code>ä¸<code>t_score</code>å…³è”ï¼Œè·å–<code>t_score</code>çš„ä¸»é”®</p></li><li><p>æ ¹æ®ä¸Šä¸€æ­¥è·å–çš„ä¸»é”®å›è¡¨è·å–<code>t_score</code>çš„æ•°æ®</p></li><li><p>å°†ä¸¤è¡Œæ•°æ®ç»„æˆä¸€æ¡å®Œæ•´çš„ç»“æœï¼Œå­˜å…¥<code>NET BUFFER</code>ä¸­</p></li><li><p>é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°<code>t_student</code>æ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„è¡Œä¸ºæ­¢</p></li></ol><p>ä»ä¸Šè¿°çš„æè¿°ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¦æŸ¥è¯¢å‡ºæ•°æ®æ¯æ¬¡éƒ½è¦è¿›è¡Œå›è¡¨æ“ä½œï¼Œè€Œå›è¡¨æ“ä½œæ˜¯éšæœºIOï¼Œæ€§èƒ½ä¸Šé¢è‚¯å®šä¸è¡Œã€‚MySQLå¯¹è¿™ä¸€æ­¥åšäº†ä¸€äº›ä¼˜åŒ–ï¼Œæ“ä½œç³»ç»Ÿè¯»å–æ•°æ®çš„æ—¶å€™ï¼Œä¸æ˜¯æŒ‡å®šäº†<code>id=xxx</code>å°±åªä¼šç»™ä½ è¯»è¿™ä¸€æ¡æ•°æ®å‡ºæ¥ï¼Œè€Œæ˜¯ä¸€æ¬¡åŠ è½½ä¸€é¡µçš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¿™æ¡æ•°æ®å‘¨è¾¹çš„å…¶å®ƒæ•°æ®ä¹Ÿä¸€èµ·åŠ è½½è¿›æ¥äº†ã€‚åŸºäºæ­¤ï¼Œåœ¨ç¬¬2æ­¥å’Œç¬¬4æ­¥çš„æ—¶å€™ï¼Œä¸ä¼šç«‹åˆ»å»å›è¡¨æŸ¥è¯¢ï¼Œè€Œæ˜¯å…ˆå­˜å…¥<code>read_md_buffer</code>ï¼ŒæŒ‰ç…§ä¸»é”®æ’åºä»¥åï¼Œå†å»å›è¡¨æŸ¥è¯¢ï¼Œè¿™æ ·æœ‰å¯èƒ½ä¸‹ä¸€æ¡éœ€è¦æŸ¥è¯¢çš„æ•°æ®åœ¨ä¸Šä¸€æ¬¡æŸ¥è¯¢çš„æ—¶å€™å·²ç»åŠ è½½è¿›å†…å­˜äº†ï¼ŒèŠ‚çœäº†IOçš„æ¬¡æ•°ã€‚</p><h2 id="Block-Nested-Loop-Join"><a href="#Block-Nested-Loop-Join" class="headerlink" title="Block Nested-Loop Join"></a>Block Nested-Loop Join</h2><p>å¦‚æœæ²¡æœ‰ä½¿ç”¨ç´¢å¼•çš„è¯ï¼Œé‚£ä¹ˆå°±åœ¨åªèƒ½åšå…¨è¡¨æ‰«æäº†ï¼Œè¿˜æ˜¯åŸæ¥çš„SQLï¼Œä»ç„¶å‡è®¾<code>t_student</code>åšé©±åŠ¨è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t_student.*, t_score.* <span class="keyword">FROM</span> t_student <span class="keyword">JOIN</span> t_score <span class="keyword">ON</span> t_student.stu_id = t_score.stu_id <span class="keyword">WHERE</span> t_student.stu_id = <span class="string">&#x27;1&#x27;</span></span><br></pre></td></tr></table></figure><ol><li><p>æ ¹æ®æ¡ä»¶<code>t_student.stu_id = &#39;1&#39;</code>ä»<code>t_student</code>ä¸­è·å–å¯¹åº”çš„ä¸»é”®</p></li><li><p>æ ¹æ®ä¸Šä¸€æ­¥è·å–çš„ä¸»é”®å›è¡¨è·å–<code>t_student</code>çš„æ•°æ®ï¼Œæ”¾å…¥<code>JOIN BUFFER</code></p></li><li><p>å†æ ¹æ®<code>JOIN BUFFER</code>ä¸­çš„æ•°æ®ï¼Œæ ¹æ®ONæ¡ä»¶å¯¹<code>t_score</code>åšå…¨è¡¨æ‰«æï¼Œæ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„å€¼</p></li><li><p>å¦‚æœ<code>t_student</code>è¡¨çš„æ•°æ®æ²¡æœ‰æ‰«æå®Œï¼Œæ¸…ç©º<code>JOIN BUFFER</code>ï¼Œç»§ç»­æ‰«æ<code>t_student</code>ï¼Œé‡å¤</p></li></ol><h2 id="é©±åŠ¨è¡¨ä¸ºä»€ä¹ˆä¸€å®šæ˜¯å°è¡¨"><a href="#é©±åŠ¨è¡¨ä¸ºä»€ä¹ˆä¸€å®šæ˜¯å°è¡¨" class="headerlink" title="é©±åŠ¨è¡¨ä¸ºä»€ä¹ˆä¸€å®šæ˜¯å°è¡¨"></a>é©±åŠ¨è¡¨ä¸ºä»€ä¹ˆä¸€å®šæ˜¯å°è¡¨</h2><div class="note info simple"><p>æš‚ä¸”å¿½ç•¥å¯èƒ½çš„å›è¡¨æ“ä½œ</p></div><p>MySQL JOINçš„æƒ…å†µåˆ†ä¸ºä½¿ç”¨äº†ç´¢å¼•å’Œæœªä½¿ç”¨ç´¢å¼•è¿™ä¸¤ç§æƒ…å†µï¼Œå‡è®¾é©±åŠ¨è¡¨è¡Œæ•°ä¸ºNï¼Œè¢«é©±åŠ¨è¡¨è¡Œæ•°ä¸ºM</p><ol><li>ä½¿ç”¨ç´¢å¼•çš„æƒ…å†µ<ul><li>é¦–å…ˆå¯¹é©±åŠ¨è¡¨æ ¹æ®æ¡ä»¶åšä¸€æ¬¡å…¨è¡¨æ‰«æï¼Œæ‰«æè¡Œæ•°ä¸ºN</li><li>æ¥ç€æ ¹æ®ç´¢å¼•æŸ¥è¯¢è¢«é©±åŠ¨è¡¨ï¼Œæ‰«æè¡Œæ•°ä¸º$N * \log_2M$</li><li>æ€»çš„æ¬¡æ•°ä¸º$N + N * \log_2M$</li></ul></li><li>ä¸é€‚ç”¨ç´¢å¼•çš„æƒ…å†µ<ul><li>å‡è®¾é©±åŠ¨è¡¨åˆ†æ®µæ”¾å…¥JOIN BUFFERéœ€è¦åˆ†æˆKæ®µï¼Œ$K = \lambda * N$</li><li>æ€»çš„æ‰«ææ¬¡æ•°æ˜¯$N + \lambda * N * M$</li></ul></li></ol><p>ä»ä¸Šè¿°ä¸¤ç§æƒ…å†µæ¥çœ‹ï¼ŒNæˆ–è€…Mè¶Šå°ï¼Œæ‰«ææ¬¡æ•°å°±è¶Šå°‘ï¼Œæ•ˆç‡ä¹Ÿå°±è¶Šé«˜ã€‚å‡å°Nå¯¹äºå‡å°æ¬¡æ•°çš„å¹…åº¦ä¼šæ¯”å‡å°Mçš„æ›´å¤§ä¸€äº›ï¼Œå› æ­¤é©±åŠ¨è¡¨é€‰æ‹©å°è¡¨æ›´åˆé€‚</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><ol><li><a href="https://segmentfault.com/a/1190000015572505">Mysql - JOINè¯¦è§£</a></li><li><a href="https://dev.mysql.com/doc/refman/8.0/en/nested-loop-joins.html">MySQLå®˜ç½‘</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåˆ·é¢˜</title>
      <link href="2020/10/08/af355a99.html"/>
      <url>2020/10/08/af355a99.html</url>
      
        <content type="html"><![CDATA[<h2 id="0001-ä¸¤æ•°ä¹‹å’Œ"><a href="#0001-ä¸¤æ•°ä¹‹å’Œ" class="headerlink" title="0001 ä¸¤æ•°ä¹‹å’Œ"></a>0001 ä¸¤æ•°ä¹‹å’Œ</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000711.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ ä¸¤ä¸ª æ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚<p>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ ä¸èƒ½ä½¿ç”¨ä¸¤éã€‚</p><div class="tabs" id="0001"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0001-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li><li class="tab"><button type="button" data-href="#0001-2"><i class="fas fa-pen"></i>è§£æ³•2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0001-1"><p>æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ä¸¤å±‚å¾ªç¯éå†ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç»„åˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] twoSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> n1 = nums[i];</span><br><span class="line">        <span class="keyword">int</span> n2 = target - n1;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; nums.length; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[j] == n2) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i, j&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> nums;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0001-2"><p>ç¬¬ä¸€ç§åšæ³•æ˜¾ç„¶ä¼šæ¯”è¾ƒè€—æ—¶ä¸€ç‚¹ï¼Œå…¶è€—æ—¶ä¸»è¦ä½“ç°åœ¨éœ€è¦é‡å¤çš„å»å¯»æ‰¾åŒ¹é…çš„å€¼ï¼Œè¿™ä¸ªå€¼å¯èƒ½æ˜¯ä¸å­˜åœ¨çš„ï¼Œé‚£ä¹ˆè¿™é‡Œå°±è¦åšä¸€æ¬¡æ— ç”¨åŠŸã€‚ä¸ºäº†èŠ‚çœè¿™ä¸€éƒ¨åˆ†æ—¶é—´ï¼Œå¯ä»¥å°†å€¼å…¨éƒ¨é€šè¿‡hashæ•£åˆ—å­˜å‚¨èµ·æ¥ï¼Œä¹‹åæŸ¥æ‰¾çš„æ—¶å€™å°±å¯ä»¥åœ¨O(1)æ—¶é—´å¤æ‚åº¦å†…æ‰¾åˆ°å¯¹åº”çš„å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] twoSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    Map&lt;Integer, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> n1 = nums[i];</span><br><span class="line">        <span class="keyword">int</span> n2 = target - n1;</span><br><span class="line">        <span class="keyword">if</span> (map.containsKey(n2)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i, map.get(n2)&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        map.put(n1, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0002-ä¸¤æ•°ç›¸åŠ "><a href="#0002-ä¸¤æ•°ç›¸åŠ " class="headerlink" title="0002 ä¸¤æ•°ç›¸åŠ "></a>0002 ä¸¤æ•°ç›¸åŠ </h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001141.svg" /></div><p>ç»™å‡ºä¸¤ä¸ª éç©º çš„é“¾è¡¨ç”¨æ¥è¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°ã€‚å…¶ä¸­ï¼Œå®ƒä»¬å„è‡ªçš„ä½æ•°æ˜¯æŒ‰ç…§ é€†åº çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸”å®ƒä»¬çš„æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨ ä¸€ä½ æ•°å­—ã€‚</p><p>å¦‚æœï¼Œæˆ‘ä»¬å°†è¿™ä¸¤ä¸ªæ•°ç›¸åŠ èµ·æ¥ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªæ–°çš„é“¾è¡¨æ¥è¡¨ç¤ºå®ƒä»¬çš„å’Œã€‚</p><p>æ‚¨å¯ä»¥å‡è®¾é™¤äº†æ•°å­— 0 ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªæ•°éƒ½ä¸ä¼šä»¥ 0 å¼€å¤´ã€‚</p><p>ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥ï¼š(2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)<br>è¾“å‡ºï¼š7 -&gt; 0 -&gt; 8<br>åŸå› ï¼š342 + 465 = 807</p></blockquote><div class="tabs" id="0002"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0002-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0002-1"><p>å¾ˆç®€å•çš„ä¸€ä¸ªé“¾è¡¨ç›¸åŠ çš„ç®—å¼ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯æœ€åçš„ç»“æœå¯èƒ½æœ‰è¿›ä½éœ€è¦å•ç‹¬å¤„ç†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">addTwoNumbers</span><span class="params">(ListNode l1, ListNode l2)</span> </span>&#123;</span><br><span class="line">    ListNode res = <span class="keyword">new</span> ListNode(-<span class="number">1</span>);</span><br><span class="line">    ListNode p1 = l1, p2 = l2, curr = res;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (p1 != <span class="keyword">null</span> || p2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> val1 = p1 == <span class="keyword">null</span> ? <span class="number">0</span> : p1.val;</span><br><span class="line">        <span class="keyword">int</span> val2 = p2 == <span class="keyword">null</span> ? <span class="number">0</span> : p2.val;</span><br><span class="line">        p1 = p1 == <span class="keyword">null</span> ? <span class="keyword">null</span> : p1.next;</span><br><span class="line">        p2 = p2 == <span class="keyword">null</span> ? <span class="keyword">null</span> : p2.next;</span><br><span class="line">        <span class="keyword">int</span> sum = flag + val1 + val2;</span><br><span class="line">        flag = sum / <span class="number">10</span>;</span><br><span class="line">        curr.next = <span class="keyword">new</span> ListNode(sum % <span class="number">10</span>);</span><br><span class="line">        curr = curr.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag != <span class="number">0</span>) &#123;</span><br><span class="line">        curr.next = <span class="keyword">new</span> ListNode(flag);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0004-å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°"><a href="#0004-å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°" class="headerlink" title="0004 å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°"></a>0004 å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001204.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div>ç»™å®šä¸¤ä¸ªå¤§å°ä¸º m å’Œ n çš„æ­£åºï¼ˆä»å°åˆ°å¤§ï¼‰æ•°ç»„ nums1 å’Œ nums2ã€‚è¯·ä½ æ‰¾å‡ºå¹¶è¿”å›è¿™ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°ã€‚<p>è¿›é˜¶ï¼šä½ èƒ½è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º O(log (m+n)) çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜å—ï¼Ÿ</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums1 = [1,3], nums2 = [2]<br>è¾“å‡ºï¼š2.00000<br>è§£é‡Šï¼šåˆå¹¶æ•°ç»„ = [1,2,3] ï¼Œä¸­ä½æ•° 2</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums1 = [1,2], nums2 = [3,4]<br>è¾“å‡ºï¼š2.50000<br>è§£é‡Šï¼šåˆå¹¶æ•°ç»„ = [1,2,3,4] ï¼Œä¸­ä½æ•° (2 + 3) / 2 = 2.5</p></blockquote><p>ç¤ºä¾‹ 3ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums1 = [0,0], nums2 = [0,0]<br>è¾“å‡ºï¼š0.00000</p></blockquote><p>ç¤ºä¾‹ 4ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums1 = [], nums2 = [1]<br>è¾“å‡ºï¼š1.00000</p></blockquote><p>ç¤ºä¾‹ 5ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums1 = [2], nums2 = []<br>è¾“å‡ºï¼š2.00000</p></blockquote><div class="note info simple"><p>nums1.length == m<br>nums2.length == n<br>0 &lt;= m &lt;= 1000<br>0 &lt;= n &lt;= 1000<br>1 &lt;= m + n &lt;= 2000<br>-106 &lt;= nums1[i], nums2[i] &lt;= 106</p></div><div class="tabs" id="0004"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0004-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li><li class="tab"><button type="button" data-href="#0004-2"><i class="fas fa-pen"></i>è§£æ³•2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0004-1"><p>æœ€ç®€å•çš„å°±æ˜¯åˆå¹¶ä¸¤ä¸ªæ•°ç»„äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] nums = merge(nums1, nums2);</span><br><span class="line">    <span class="keyword">if</span> (nums.length % <span class="number">2</span> == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> nums[nums.length / <span class="number">2</span>] / <span class="number">1.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (nums[nums.length / <span class="number">2</span>] + nums[nums.length / <span class="number">2</span> - <span class="number">1</span>]) / <span class="number">2.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] merge(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2) &#123;</span><br><span class="line">    <span class="keyword">int</span>[] mergeArr = <span class="keyword">new</span> <span class="keyword">int</span>[nums1.length + nums2.length];</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; nums1.length &amp;&amp; j &lt; nums2.length) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums1[i] &lt; nums2[j]) &#123;</span><br><span class="line">            mergeArr[index++] = nums1[i++];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            mergeArr[index++] = nums2[j++];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; nums1.length) &#123;</span><br><span class="line">        mergeArr[index++] = nums1[i++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (j &lt; nums2.length) &#123;</span><br><span class="line">        mergeArr[index++] = nums2[j++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mergeArr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0004-2"><p>å…¶å®å¹¶ä¸éœ€è¦åˆå¹¶ä¸¤ä¸ªæ•°ç»„ï¼Œä»–ä»¬æœ¬èº«æ˜¯æœ‰åºçš„ï¼Œå¦‚æœæ€»çš„é•¿åº¦æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆåªè¦æ‰¾åˆ°ä¸­é—´é‚£ä¸ªå°±å¥½ï¼Œå¦åˆ™æ‰¾åˆ°ä¸­é—´é‚£ä¸¤ä¸ªã€‚å®é™…ä¸Šå°±æ˜¯æ¯”è¾ƒå°çš„æ•°ä¸¢æ‰<code>len / 2</code>ä¸ªï¼Œç„¶åå–<code>len / 2 + 1</code>æˆ–è€…åé¢ä¸¤ä¸ªæ•°çš„å¹³å‡æ•°å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len1 = nums1.length, len2 = nums2.length, len = len1 + len2;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt;= len / <span class="number">2</span>; index++) &#123;</span><br><span class="line">        left = right;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; len1 &amp;&amp; (j &gt;= len2 || nums1[i] &lt; nums2[j])) &#123;</span><br><span class="line">            right = nums1[i++];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            right = nums2[j++];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (len % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (left + right) / <span class="number">2.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> right;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0011-ç››æœ€å¤šæ°´çš„å®¹å™¨"><a href="#0011-ç››æœ€å¤šæ°´çš„å®¹å™¨" class="headerlink" title="0011 ç››æœ€å¤šæ°´çš„å®¹å™¨"></a>0011 ç››æœ€å¤šæ°´çš„å®¹å™¨</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™ä½  n ä¸ªéè´Ÿæ•´æ•° a1ï¼Œa2ï¼Œâ€¦ï¼Œanï¼Œæ¯ä¸ªæ•°ä»£è¡¨åæ ‡ä¸­çš„ä¸€ä¸ªç‚¹ (i, ai) ã€‚åœ¨åæ ‡å†…ç”» n æ¡å‚ç›´çº¿ï¼Œå‚ç›´çº¿ i çš„ä¸¤ä¸ªç«¯ç‚¹åˆ†åˆ«ä¸º (i, ai) å’Œ (i, 0)ã€‚æ‰¾å‡ºå…¶ä¸­çš„ä¸¤æ¡çº¿ï¼Œä½¿å¾—å®ƒä»¬ä¸ x è½´å…±åŒæ„æˆçš„å®¹å™¨å¯ä»¥å®¹çº³æœ€å¤šçš„æ°´ã€‚</p><p>è¯´æ˜ï¼šä½ ä¸èƒ½å€¾æ–œå®¹å™¨ï¼Œä¸” n çš„å€¼è‡³å°‘ä¸º 2ã€‚</p><p> <img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://aliyun-lc-upload.oss-cn-hangzhou.aliyuncs.com/aliyun-lc-upload/uploads/2018/07/25/question_11.jpg"></p><p>å›¾ä¸­å‚ç›´çº¿ä»£è¡¨è¾“å…¥æ•°ç»„ [1,8,6,2,5,4,8,3,7]ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œå®¹å™¨èƒ½å¤Ÿå®¹çº³æ°´ï¼ˆè¡¨ç¤ºä¸ºè“è‰²éƒ¨åˆ†ï¼‰çš„æœ€å¤§å€¼ä¸º 49ã€‚</p><p>ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥ï¼š[1,8,6,2,5,4,8,3,7]<br>è¾“å‡ºï¼š49</p></blockquote><div class="tabs" id="0004"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0004-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li><li class="tab"><button type="button" data-href="#0004-2"><i class="fas fa-pen"></i>è§£æ³•2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0004-1"><p>å¾ˆç®€å•çš„æ€è·¯ï¼Œä¸¤ä¸ªå·¦å³æŒ‡é’ˆä¸æ–­åœ°å‘ä¸­é—´é æ‹¢ï¼Œæ­¤æ—¶ä»–ä»¬çš„è·ç¦»ä¸€å®šä¼šç¼©çŸ­ï¼Œä¸ºäº†ä¿è¯å®¹é‡æœ‰å¯èƒ½æ˜¯åœ¨å¢å¤§çš„ï¼Œå› æ­¤ä»–ä»¬ä¸¤ä¸ªæŒ‡é’ˆçš„æœ€å°çš„é‚£ä¸ªå‘å‰ç§»åŠ¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxArea</span><span class="params">(<span class="keyword">int</span>[] height)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (height == <span class="keyword">null</span> || height.length &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = height.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        <span class="keyword">int</span> temp = Math.min(height[left], height[right]) * (right - left);</span><br><span class="line">        res = Math.max(res, temp);</span><br><span class="line">        <span class="keyword">if</span> (height[left] &lt; height[right]) &#123;</span><br><span class="line">            left++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            right--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0004-2"><p>è§£æ³•2æ˜¯å¯¹è§£æ³•1çš„ä¸€æ¬¡ä¼˜åŒ–ï¼Œè§£æ³•1æœ‰ä¸€äº›ä¸å¿…è¦çš„å°è¯•ï¼Œä¾‹å¦‚å¦‚æœå°çš„é‚£ä¸ªæŒ‡é’ˆå‘å‰ç§»åŠ¨ä»¥åï¼Œé«˜åº¦æ¯”åŸæ¥çš„è¿˜å°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ˜¯æ²¡æœ‰å¿…è¦å»è®¡ç®—çš„ï¼Œå› ä¸ºå®½åº¦å·²ç»å˜å°äº†ï¼Œé«˜åº¦å†å˜å°åªä¼šæ¯”åŸæ¥çš„æ›´å°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxArea</span><span class="params">(<span class="keyword">int</span>[] height)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (height == <span class="keyword">null</span> || height.length &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = height.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        <span class="keyword">int</span> minWidth = Math.min(height[left], height[right]);</span><br><span class="line">        <span class="keyword">int</span> temp = minWidth * (right - left);</span><br><span class="line">        res = Math.max(res, temp);</span><br><span class="line">        <span class="keyword">if</span> (height[left] &lt; height[right]) &#123;</span><br><span class="line">            left++;</span><br><span class="line">            <span class="keyword">while</span> (left &lt; right &amp;&amp; height[left] &lt;= minWidth) &#123;</span><br><span class="line">                left++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            right--;</span><br><span class="line">            <span class="keyword">while</span> (left &lt; right &amp;&amp; height[right] &lt;= minWidth) &#123;</span><br><span class="line">                right--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0015-ä¸‰æ•°ä¹‹å’Œ"><a href="#0015-ä¸‰æ•°ä¹‹å’Œ" class="headerlink" title="0015 ä¸‰æ•°ä¹‹å’Œ"></a>0015 ä¸‰æ•°ä¹‹å’Œ</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™ä½ ä¸€ä¸ªåŒ…å« n ä¸ªæ•´æ•°çš„æ•°ç»„ numsï¼Œåˆ¤æ–­ nums ä¸­æ˜¯å¦å­˜åœ¨ä¸‰ä¸ªå…ƒç´  aï¼Œbï¼Œc ï¼Œä½¿å¾— a + b + c = 0 ï¼Ÿè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ»¡è¶³æ¡ä»¶ä¸”ä¸é‡å¤çš„ä¸‰å…ƒç»„ã€‚</p><p>æ³¨æ„ï¼šç­”æ¡ˆä¸­ä¸å¯ä»¥åŒ…å«é‡å¤çš„ä¸‰å…ƒç»„ã€‚</p><p>ç¤ºä¾‹ï¼š</p><blockquote><p>ç»™å®šæ•°ç»„ nums = [-1, 0, 1, 2, -1, -4]ï¼Œ</p><p>æ»¡è¶³è¦æ±‚çš„ä¸‰å…ƒç»„é›†åˆä¸ºï¼š<br>[<br>  [-1, 0, 1],<br>  [-1, -1, 2]<br>]</p></blockquote><div class="tabs" id="0015"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0015-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li><li class="tab"><button type="button" data-href="#0015-2"><i class="fas fa-pen"></i>è§£æ³•2</button></li><li class="tab"><button type="button" data-href="#0015-3"><i class="fas fa-pen"></i>è§£æ³•3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0015-1"><p>æœ€æœ€ç®€å•çš„ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ï¼Œç›´æ¥ä¸‰å±‚å¾ªç¯å»æœç´¢å°±å¥½äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; threeSum(<span class="keyword">int</span>[] nums) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length - <span class="number">2</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; nums[i - <span class="number">1</span>] == nums[i]) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; nums.length - <span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (j &gt; i + <span class="number">1</span> &amp;&amp; nums[j - <span class="number">1</span>] == nums[j]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> h = j + <span class="number">1</span>; h &lt; nums.length; h++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (h &gt; j + <span class="number">1</span> &amp;&amp; nums[h - <span class="number">1</span>] == nums[h]) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (nums[i] + nums[j] + nums[h] == <span class="number">0</span>) &#123;</span><br><span class="line">                    res.add(Arrays.asList(nums[i], nums[j], nums[h]));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0015-2"><p>å…¶å®ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæ¯”è¾ƒå…³é”®çš„ä¸€æ­¥æ˜¯è¦å…ˆå¯¹è¿™ä¸ªæ•°ç»„æ’åºï¼Œç„¶åè¿˜è¦æ³¨æ„çš„å°±æ˜¯ä¸è¦æœ‰é‡å¤çš„ç»„åˆå‡ºç°ï¼Œåšåˆ°ä¸é‡å¤ä¹Ÿç®€å•ï¼Œåªè¦æ–°çš„ç»„åˆå¼€å¤´ä¸æ˜¯ä¹‹å‰å‡ºç°è¿‡çš„é‚£ä¸ªå…ƒç´ å°±å¥½äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; threeSum(<span class="keyword">int</span>[] nums) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    <span class="keyword">if</span> (nums[<span class="number">0</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    findThreeNumsSum(nums, res, <span class="keyword">new</span> ArrayList&lt;&gt;(), <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">findThreeNumsSum</span><span class="params">(<span class="keyword">int</span>[] nums, List&lt;List&lt;Integer&gt;&gt; res, List&lt;Integer&gt; temp, <span class="keyword">int</span> index, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (temp.size() == <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (target == <span class="number">0</span>) &#123;</span><br><span class="line">            res.add(<span class="keyword">new</span> ArrayList&lt;&gt;(temp));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = index; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; index) &#123;</span><br><span class="line">            <span class="comment">// é¿å…é‡å¤</span></span><br><span class="line">            <span class="keyword">if</span> (nums[i] == nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        temp.add(nums[i]);</span><br><span class="line">        findThreeNumsSum(nums, res, temp, i + <span class="number">1</span>, target + nums[i]);</span><br><span class="line">        temp.remove(temp.size() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0015-3"><p>å‰é¢ä¸¤ç§æ–¹å¼éƒ½æ˜¯ä¸èƒ½é€šè¿‡çš„ï¼Œè¶…å‡ºäº†æ—¶é—´é™åˆ¶ã€‚å…¶å®å‰é¢ä¸¤ç§æ–¹å¼çš„æ ¸å¿ƒæ€æƒ³éƒ½æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„å»å°è¯•ï¼Œä½†æ˜¯è¿™æ˜¯å®Œå…¨æ²¡æœ‰å¿…è¦çš„ï¼Œå‰é¢ä¸¤ç§æ–¹å¼éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„åœ°æ–¹ï¼šå¯¹æ•°ç»„è¿›è¡Œäº†æ’åºï¼Œè¿™ä¸ªå¾ˆé‡è¦ï¼Œè¯´æ˜æ•°ç»„æ˜¯æœ‰åºçš„ï¼Œè¿™æ ·çš„è¯å…¶å®å¯ä»¥å°†é—®é¢˜ç®€åŒ–ä¸º ï¼šç¡®å®šäº†æŸä¸€ä¸ªæ•°ï¼Œæ±‚å¦å¤–ä¸¤ä¸ªæ•°çš„å’Œä¸ºæŸä¸€ä¸ªæ•°çš„ç»„åˆï¼Œè¿™ä¸å°±åˆå›åˆ°äº†ä¸¤æ•°ä¹‹å’Œçš„åœºæ™¯äº†å—ï¼Ÿä¹‹å‰çš„ä¸¤æ•°ä¹‹å’Œå› ä¸ºæ˜¯æ— åºçš„ï¼Œæ‰€ä»¥ç”¨äº†é¢å¤–çš„å­˜å‚¨ç©ºé—´è®°å½•ä½ç½®ä¿¡æ¯ï¼Œè€Œæ­¤æ—¶æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆå°±å®Œå…¨å¯ä»¥ä½¿ç”¨åŒæŒ‡é’ˆçš„æ–¹å¼æ‰¾åˆ°æŒ‡å®šçš„å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; threeSum(<span class="keyword">int</span>[] nums) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length - <span class="number">2</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; nums[i - <span class="number">1</span>] == nums[i]) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> l = i + <span class="number">1</span>, r = nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">            <span class="keyword">int</span> sum = nums[i] + nums[l] + nums[r];</span><br><span class="line">            <span class="keyword">if</span> (sum == <span class="number">0</span>) &#123;</span><br><span class="line">                res.add(Arrays.asList(nums[i], nums[l], nums[r]));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (sum &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">while</span> (l &lt; r &amp;&amp; nums[l] == nums[++l]) &#123;&#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (l &lt; r &amp;&amp; nums[r] == nums[--r]) &#123;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0016-æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ"><a href="#0016-æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ" class="headerlink" title="0016 æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ"></a>0016 æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><div class="tabs" id="0016"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0016-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0016-1"><p>å’Œé¢˜ç›® <a href="#0015">0015</a> ä¸€æ ·ï¼Œæ€è·¯éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡æ¢äº†ä¸€ä¸ªæ¨¡å¼è€Œå·²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">threeSumClosest</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    <span class="keyword">int</span> res = Integer.MAX_VALUE;</span><br><span class="line">    <span class="keyword">int</span> minDis = Integer.MAX_VALUE;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> left = i + <span class="number">1</span>, right = nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">            <span class="keyword">int</span> sum = nums[i] + nums[left] + nums[right];</span><br><span class="line">            <span class="keyword">if</span> (sum == target) &#123;</span><br><span class="line">                <span class="keyword">return</span> target;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> dis = sum - target;</span><br><span class="line">            <span class="keyword">if</span> (dis &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                left++;</span><br><span class="line">                <span class="keyword">while</span> (left &lt; right &amp;&amp; nums[left - <span class="number">1</span>] == nums[left]) &#123;</span><br><span class="line">                    left++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                right--;</span><br><span class="line">                <span class="keyword">while</span> (left &lt; right &amp;&amp; nums[right + <span class="number">1</span>] == nums[right]) &#123;</span><br><span class="line">                    right--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (Math.abs(dis) &lt; minDis) &#123;</span><br><span class="line">                minDis = Math.abs(dis);</span><br><span class="line">                res = sum;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0018-å››æ•°ä¹‹å’Œ"><a href="#0018-å››æ•°ä¹‹å’Œ" class="headerlink" title="0018 å››æ•°ä¹‹å’Œ"></a>0018 å››æ•°ä¹‹å’Œ</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®šä¸€ä¸ªåŒ…å« n ä¸ªæ•´æ•°çš„æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œåˆ¤æ–­ nums ä¸­æ˜¯å¦å­˜åœ¨å››ä¸ªå…ƒç´  aï¼Œbï¼Œc å’Œ d ï¼Œä½¿å¾— a + b + c + d çš„å€¼ä¸ target ç›¸ç­‰ï¼Ÿæ‰¾å‡ºæ‰€æœ‰æ»¡è¶³æ¡ä»¶ä¸”ä¸é‡å¤çš„å››å…ƒç»„ã€‚</p><p>æ³¨æ„ï¼š</p><p><strong>ç­”æ¡ˆä¸­ä¸å¯ä»¥åŒ…å«é‡å¤çš„å››å…ƒç»„ã€‚</strong></p><p>ç¤ºä¾‹ï¼š</p><blockquote><p>ç»™å®šæ•°ç»„ nums = [1, 0, -1, 0, -2, 2]ï¼Œå’Œ target = 0ã€‚</p><p>æ»¡è¶³è¦æ±‚çš„å››å…ƒç»„é›†åˆä¸ºï¼š<br>[<br>  [-1,  0, 0, 1],<br>  [-2, -1, 1, 2],<br>  [-2,  0, 0, 2]<br>]</p></blockquote><div class="tabs" id="0018"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0018-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li><li class="tab"><button type="button" data-href="#0018-2"><i class="fas fa-pen"></i>è§£æ³•2</button></li><li class="tab"><button type="button" data-href="#0018-3"><i class="fas fa-pen"></i>è§£æ³•3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0018-1"><p>å‰é¢ç»å†äº†ä¸¤æ•°ä¹‹å’Œã€ä¸‰æ•°ä¹‹å’Œã€æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œä¹‹åï¼Œåˆ°äº†ç°åœ¨ä¸€äº›åŸºæœ¬çš„å¥—è·¯æ€»æ˜¯è¦ä¼šäº†ğŸ˜‚</p><p>è¿˜æ˜¯å‚è€ƒä¸‰æ•°ä¹‹å’Œçš„åšæ³•ï¼ŒåŒå±‚å¾ªç¯ç›´æ¥æ€¼ä¸Šå»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; fourSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">int</span> len = nums.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">3</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; nums[i - <span class="number">1</span>] == nums[i]) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; len - <span class="number">2</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (j &gt; i + <span class="number">1</span> &amp;&amp; nums[j - <span class="number">1</span>] == nums[j]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> left = j + <span class="number">1</span>, right = len - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">                <span class="keyword">int</span> sum = nums[i] + nums[j] + nums[left] + nums[right];</span><br><span class="line">                <span class="keyword">if</span> (sum == target) &#123;</span><br><span class="line">                    res.add(Arrays.asList(nums[i], nums[j], nums[left], nums[right]));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (sum &gt; target) &#123;</span><br><span class="line">                    <span class="keyword">while</span> (left &lt; right &amp;&amp; nums[--right] == nums[right + <span class="number">1</span>]) &#123;&#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">while</span> (left &lt; right &amp;&amp; nums[++left] == nums[left - <span class="number">1</span>]) &#123;&#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0018-2"><p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨DFSçš„æ–¹å¼æ¥è§£å†³è¿™é“é¢˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; fourSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    findRes(nums, target, <span class="number">0</span>, res, <span class="keyword">new</span> ArrayList&lt;&gt;());</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">findRes</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target, <span class="keyword">int</span> index, List&lt;List&lt;Integer&gt;&gt; res, List&lt;Integer&gt; temp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (temp.size() == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (target == <span class="number">0</span>) &#123;</span><br><span class="line">            res.add(<span class="keyword">new</span> ArrayList&lt;&gt;(temp));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = index; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; index &amp;&amp; nums[i - <span class="number">1</span>] == nums[i]) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        temp.add(nums[i]);</span><br><span class="line">        findRes(nums, target - nums[i], i + <span class="number">1</span>, res, temp);</span><br><span class="line">        temp.remove(temp.size() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— æƒ…è¶…æ—¶ğŸ˜‚</p><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0018-3"><p>çœ‹çœ‹åˆ«äººçš„åšæ³•ï¼Œæˆ‘ä¸¢ï¼ŒåŸæ¥è¿˜å¯ä»¥è¿™æ ·å‰ªæ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; fourSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">int</span> len = nums.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">3</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; nums[i - <span class="number">1</span>] == nums[i]) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> min1 = nums[i] + nums[i + <span class="number">1</span>] + nums[i + <span class="number">2</span>] + nums[i + <span class="number">3</span>];</span><br><span class="line">        <span class="keyword">if</span> (min1 &gt; target) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> max1 = nums[i] + nums[len - <span class="number">1</span>] + nums[len - <span class="number">2</span>] + nums[len - <span class="number">3</span>];</span><br><span class="line">        <span class="keyword">if</span> (max1 &lt; target) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; len - <span class="number">2</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (j &gt; i + <span class="number">1</span> &amp;&amp; nums[j - <span class="number">1</span>] == nums[j]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> min2 = nums[i] + nums[j] + nums[j + <span class="number">1</span>] + nums[j + <span class="number">2</span>];</span><br><span class="line">            <span class="keyword">if</span> (min2 &gt; target) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> max2 = nums[i] + nums[j] + nums[len - <span class="number">1</span>] + nums[len - <span class="number">2</span>];</span><br><span class="line">            <span class="keyword">if</span> (max2 &lt; target) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> left = j + <span class="number">1</span>, right = len - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">                <span class="keyword">int</span> sum = nums[i] + nums[j] + nums[left] + nums[right];</span><br><span class="line">                <span class="keyword">if</span> (sum == target) &#123;</span><br><span class="line">                    res.add(Arrays.asList(nums[i], nums[j], nums[left], nums[right]));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (sum &gt; target) &#123;</span><br><span class="line">                    <span class="keyword">while</span> (left &lt; right &amp;&amp; nums[--right] == nums[right + <span class="number">1</span>]) &#123;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">while</span> (left &lt; right &amp;&amp; nums[++left] == nums[left - <span class="number">1</span>]) &#123;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0026-åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹"><a href="#0026-åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹" class="headerlink" title="0026 åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹"></a>0026 åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000711.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®šä¸€ä¸ªæ’åºæ•°ç»„ï¼Œä½ éœ€è¦åœ¨ åŸåœ° åˆ é™¤é‡å¤å‡ºç°çš„å…ƒç´ ï¼Œä½¿å¾—æ¯ä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡ï¼Œè¿”å›ç§»é™¤åæ•°ç»„çš„æ–°é•¿åº¦ã€‚</p><p>ä¸è¦ä½¿ç”¨é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œä½ å¿…é¡»åœ¨ åŸåœ° ä¿®æ”¹è¾“å…¥æ•°ç»„ å¹¶åœ¨ä½¿ç”¨ O(1) é¢å¤–ç©ºé—´çš„æ¡ä»¶ä¸‹å®Œæˆã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>ç»™å®šæ•°ç»„ nums = [1,1,2], </p><p>å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2, å¹¶ä¸”åŸæ•°ç»„ nums çš„å‰ä¸¤ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 1, 2ã€‚ </p><p>ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>ç»™å®š nums = [0,0,1,1,1,2,2,3,3,4],</p><p>å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 5, å¹¶ä¸”åŸæ•°ç»„ nums çš„å‰äº”ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 0, 1, 2, 3, 4ã€‚</p><p>ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p></blockquote><div class="tabs" id="0026"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0026-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0026-1"><p>é¢˜ç›®å¾ˆç®€å•ï¼Œä¸€ä¸ªå¾ˆå®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•å°±æ˜¯ï¼Œå¼„ä¸€ä¸ªé¢å¤–çš„æ•°ç»„å‡ºæ¥ï¼Œç„¶åæŠŠå…¨éƒ¨çš„ä¸é‡å¤çš„å€¼æ”¾åˆ°è¿™ä¸ªé¢å¤–çš„æ•°ç»„é‡Œé¢å»ï¼Œç„¶åè¦†ç›–æ‰åŸæ¥çš„æ•°ç»„å³å¯ï¼Œè¿™ç§æ–¹æ³•å¤ªç®€å•äº†ã€‚</p><p>å¦ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ç›´æ¥åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œä¸¤ä¸ªæŒ‡é’ˆ<code>p1</code>ã€<code>p2</code>ï¼Œ<code>p1</code>ä»£è¡¨æ–°æ•°ç»„ä¸‹ä¸€ä¸ªä¸é‡å¤çš„å…ƒç´ çš„ä¸‹æ ‡ï¼Œ<code>p2</code>ä»£è¡¨å°±æ•°ç»„ä¸‹ä¸€ä¸ªä¸é‡å¤å…ƒç´ çš„ä¸‹æ ‡ï¼Œè¿™ä¹ˆè¯´æ„æ€å°±å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯ç”¨<code>p2</code>å»æ‰¾ä¸‹ä¸€ä¸ªä¸é‡å¤çš„å…ƒç´ ï¼Œç„¶åè¦†ç›–æ‰<code>p1</code>çš„ä½ç½®å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">removeDuplicates</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> nums == <span class="keyword">null</span> ? <span class="number">0</span> : nums.length;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> p1 = <span class="number">1</span>, p2 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (p2 &lt; nums.length) &#123;</span><br><span class="line">        <span class="keyword">while</span> (p2 &lt; nums.length &amp;&amp; nums[p2] == nums[p2 - <span class="number">1</span>]) &#123;</span><br><span class="line">            p2++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (p2 &lt; nums.length &amp;&amp; nums[p2] != nums[p2 - <span class="number">1</span>]) &#123;</span><br><span class="line">            nums[p1++] = nums[p2++];</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0027-ç§»é™¤å…ƒç´ "><a href="#0027-ç§»é™¤å…ƒç´ " class="headerlink" title="0027 ç§»é™¤å…ƒç´ "></a>0027 ç§»é™¤å…ƒç´ </h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000711.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™ä½ ä¸€ä¸ªæ•°ç»„ nums å’Œä¸€ä¸ªå€¼ valï¼Œä½ éœ€è¦ åŸåœ° ç§»é™¤æ‰€æœ‰æ•°å€¼ç­‰äº val çš„å…ƒç´ ï¼Œå¹¶è¿”å›ç§»é™¤åæ•°ç»„çš„æ–°é•¿åº¦ã€‚</p><p>ä¸è¦ä½¿ç”¨é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œä½ å¿…é¡»ä»…ä½¿ç”¨ O(1) é¢å¤–ç©ºé—´å¹¶ åŸåœ° ä¿®æ”¹è¾“å…¥æ•°ç»„ã€‚</p><p>å…ƒç´ çš„é¡ºåºå¯ä»¥æ”¹å˜ã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>ç»™å®š nums = [3,2,2,3], val = 3,</p><p>å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2, å¹¶ä¸” nums ä¸­çš„å‰ä¸¤ä¸ªå…ƒç´ å‡ä¸º 2ã€‚</p><p>ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>ç»™å®š nums = [0,1,2,2,3,0,4,2], val = 2,</p><p>å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 5, å¹¶ä¸” nums ä¸­çš„å‰äº”ä¸ªå…ƒç´ ä¸º 0, 1, 3, 0, 4ã€‚</p><p>æ³¨æ„è¿™äº”ä¸ªå…ƒç´ å¯ä¸ºä»»æ„é¡ºåºã€‚</p><p>ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p></blockquote><div class="tabs" id="0026"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0026-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0026-1"><p>é¢˜ç›®æŒºç®€å•çš„ï¼Œå°±ä¸å¤šè§£é‡Šäº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">removeElement</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> p1 = <span class="number">0</span>, p2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (p2 &lt; nums.length) &#123;</span><br><span class="line">        <span class="keyword">while</span> (p2 &lt; nums.length &amp;&amp; nums[p2] == val) &#123;</span><br><span class="line">            p2++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (p2 &lt; nums.length) &#123;</span><br><span class="line">            nums[p1++] = nums[p2++];</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0031-ä¸‹ä¸€ä¸ªæ’åˆ—"><a href="#0031-ä¸‹ä¸€ä¸ªæ’åˆ—" class="headerlink" title="0031 ä¸‹ä¸€ä¸ªæ’åˆ—"></a>0031 ä¸‹ä¸€ä¸ªæ’åˆ—</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>å®ç°è·å–ä¸‹ä¸€ä¸ªæ’åˆ—çš„å‡½æ•°ï¼Œç®—æ³•éœ€è¦å°†ç»™å®šæ•°å­—åºåˆ—é‡æ–°æ’åˆ—æˆå­—å…¸åºä¸­ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ’åˆ—ã€‚</p><p>å¦‚æœä¸å­˜åœ¨ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ’åˆ—ï¼Œåˆ™å°†æ•°å­—é‡æ–°æ’åˆ—æˆæœ€å°çš„æ’åˆ—ï¼ˆå³å‡åºæ’åˆ—ï¼‰ã€‚</p><p>å¿…é¡»åŸåœ°ä¿®æ”¹ï¼Œåªå…è®¸ä½¿ç”¨é¢å¤–å¸¸æ•°ç©ºé—´ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­ï¼Œè¾“å…¥ä½äºå·¦ä¾§åˆ—ï¼Œå…¶ç›¸åº”è¾“å‡ºä½äºå³ä¾§åˆ—ã€‚<br><code>1,2,3 â†’ 1,3,2</code><br><code>3,2,1 â†’ 1,2,3</code><br><code>1,1,5 â†’ 1,5,1</code></p><div class="tabs" id="0031"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0031-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0031-1"><p>ä¸»è¦çš„æ€è·¯æ˜¯è¿™æ ·çš„: </p><ol><li>é¦–å…ˆè¿™ä¸ªè¦æ±‚æ˜¯ä¸‹ä¸€ä¸ªæ’åˆ—æ˜¯å‡åºçš„ï¼Œé‚£ä¹ˆå°†ä¸¤ä¸ªæ•°ä¸­å‰é¢çš„å¤§æ•°å’Œå‰é¢çš„å°æ•°å¯¹è°ƒä¸€ä¸‹å°±å¥½äº†ï¼Œæ¯”å¦‚<code>1234</code>ï¼Œå°†4å’Œ3å¯¹è°ƒä¸€ä¸‹å°±æ˜¯<code>1243</code>ï¼Œæ»¡è¶³å‡åºçš„æ’åˆ—å°±å‡ºæ¥äº†</li><li>å½“ç„¶è¿™è¾¹çš„ä¸‹ä¸€ä¸ªæ’åˆ—è‚¯å®šè¯´çš„æ˜¯æœ€å°çš„é‚£ä¸€ä¸ªï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¯¹è°ƒçš„è§„åˆ™è¿˜æ˜¯ä¸€æ ·çš„<ol><li>é¦–å…ˆæ‰¾åˆ°ç¬¬ä¸€ä¸ªå‰é¢çš„æ•°å°äºåé¢çš„æ•°çš„æ•°ï¼Œè®°è¿™ä¸ªä½ç½®ä¸º<code>i</code>ï¼Œæ­¤æ—¶<code>i</code>ä¹‹åçš„æ•°åˆ—æ˜¯ä¸€ä¸ªé™åºæ•°åˆ—</li><li>ç„¶åä»åå¾€å‰æ‰¾åˆ°ç¬¬ä¸€ä¸ªå°äºä½ç½®<code>i</code>çš„æ•°ï¼ŒåŠè¿™ä¸ªä½ç½®ä¸º<code>j</code>ï¼Œå°†è¿™ä¸¤ä¸ªæ•°å¯¹è°ƒä½ç½®</li><li>æœ€åå°†<code>i ~ len</code>è¿™ä¸€æ®µæ•°åˆ—è¿›è¡Œåè½¬å³å¯</li></ol></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">nextPermutation</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> i = nums.length - <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &gt;= <span class="number">0</span> &amp;&amp; nums[i + <span class="number">1</span>] &lt;= nums[i]) &#123;</span><br><span class="line">        i--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> j = nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (j &gt;= <span class="number">0</span> &amp;&amp; nums[j] &lt;= nums[i]) &#123;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        swap(nums, i, j);</span><br><span class="line">    &#125;</span><br><span class="line">    reverse(nums, i + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = nums[i];</span><br><span class="line">    nums[i] = nums[j];</span><br><span class="line">    nums[j] = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j = nums.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">        swap(nums, i++, j--);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0033-æœç´¢æ—‹è½¬æ’åºæ•°ç»„"><a href="#0033-æœç´¢æ—‹è½¬æ’åºæ•°ç»„" class="headerlink" title="0033 æœç´¢æ—‹è½¬æ’åºæ•°ç»„"></a>0033 æœç´¢æ—‹è½¬æ’åºæ•°ç»„</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™ä½ ä¸€ä¸ªå‡åºæ’åˆ—çš„æ•´æ•°æ•°ç»„ nums ï¼Œå’Œä¸€ä¸ªæ•´æ•° target ã€‚</p><p>å‡è®¾æŒ‰ç…§å‡åºæ’åºçš„æ•°ç»„åœ¨é¢„å…ˆæœªçŸ¥çš„æŸä¸ªç‚¹ä¸Šè¿›è¡Œäº†æ—‹è½¬ã€‚ï¼ˆä¾‹å¦‚ï¼Œæ•°ç»„ [0,1,2,4,5,6,7] å¯èƒ½å˜ä¸º [4,5,6,7,0,1,2] ï¼‰ã€‚</p><p>è¯·ä½ åœ¨æ•°ç»„ä¸­æœç´¢ target ï¼Œå¦‚æœæ•°ç»„ä¸­å­˜åœ¨è¿™ä¸ªç›®æ ‡å€¼ï¼Œåˆ™è¿”å›å®ƒçš„ç´¢å¼•ï¼Œå¦åˆ™è¿”å› -1 ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums = [4,5,6,7,0,1,2], target = 0<br>è¾“å‡ºï¼š4</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums = [4,5,6,7,0,1,2], target = 3<br>è¾“å‡ºï¼š-1</p></blockquote><p>ç¤ºä¾‹ 3ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums = [1], target = 0<br>è¾“å‡ºï¼š-1</p></blockquote><div class="tabs" id="0033"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0033-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0033-1"><p>ç®€å•çš„æš´åŠ›æ±‚è§£å°±ä¸å¤šè¯´äº†ï¼Œä¸ºäº†æ›´åŠ å¿«ä¸€ç‚¹ï¼Œä¸»è¦æ˜¯è¿ç”¨åˆ°äºŒåˆ†æœç´¢çš„æ€æƒ³ã€‚</p><p>ç»†å¿ƒç ”ç©¶é¢˜ç›®å°±ä¼šå‘ç°ï¼Œæ‰¾åˆ°æ•°ç»„çš„ä¸­ç‚¹ï¼Œä¸æ˜¯å·¦è¾¹æœ‰åºå°±æ˜¯å³è¾¹æœ‰åºã€‚é‚£ä¹ˆå°±å¯ä»¥å°†<code>target</code>å’Œæœ‰åºçš„é‚£ä¸€è¾¹è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœåœ¨æœ‰åºçš„é‡Œé¢ï¼Œé‚£ä¹ˆå°±æœç´¢è¿™ä¸ªæœ‰åºçš„ï¼Œå¦åˆ™æœç´¢æ— åºçš„ï¼Œå¦‚æ­¤ä¸€æ¥ï¼Œæ¯æ¬¡éƒ½ä¼šä¸¢å¼ƒä¸€åŠçš„æ•°æ®ï¼Œå¤§å¤§æé«˜äº†æŸ¥è¯¢çš„æ•ˆç‡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = nums.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (right - left) / <span class="number">2</span> + left;</span><br><span class="line">        <span class="keyword">if</span> (nums[mid] == target) &#123;</span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nums[left] &lt;= nums[mid]) &#123;</span><br><span class="line">            <span class="comment">// å·¦è¾¹æœ‰åº</span></span><br><span class="line">            <span class="keyword">if</span> (target &gt;= nums[left] &amp;&amp; target &lt; nums[mid]) &#123;</span><br><span class="line">                right = mid - <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                left = mid + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å³è¾¹æœ‰åº</span></span><br><span class="line">            <span class="keyword">if</span> (target &gt; nums[mid] &amp;&amp; target &lt;= nums[right]) &#123;</span><br><span class="line">                left = mid + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                right = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0034-åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå‡ºç°çš„ä½ç½®"><a href="#0034-åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå‡ºç°çš„ä½ç½®" class="headerlink" title="0034 åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå‡ºç°çš„ä½ç½®"></a>0034 åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå‡ºç°çš„ä½ç½®</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®šä¸€ä¸ªæŒ‰ç…§å‡åºæ’åˆ—çš„æ•´æ•°æ•°ç»„ numsï¼Œå’Œä¸€ä¸ªç›®æ ‡å€¼ targetã€‚æ‰¾å‡ºç»™å®šç›®æ ‡å€¼åœ¨æ•°ç»„ä¸­çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚</p><p>ä½ çš„ç®—æ³•æ—¶é—´å¤æ‚åº¦å¿…é¡»æ˜¯ O(log n) çº§åˆ«ã€‚</p><p>å¦‚æœæ•°ç»„ä¸­ä¸å­˜åœ¨ç›®æ ‡å€¼ï¼Œè¿”å› [-1, -1]ã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>è¾“å…¥: nums = [5,7,7,8,8,10], target = 8<br>è¾“å‡º: [3,4]</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>è¾“å…¥: nums = [5,7,7,8,8,10], target = 6<br>è¾“å‡º: [-1,-1]</p></blockquote><div class="tabs" id="0034"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0034-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li><li class="tab"><button type="button" data-href="#0034-2"><i class="fas fa-pen"></i>è§£æ³•2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0034-1"><p>æ—¢ç„¶æ˜¯æ’åºçš„æ•°ç»„ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ä¸ŠäºŒåˆ†æœç´¢ã€‚æ ¹æ®äºŒåˆ†æœç´¢æŸ¥æ‰¾å‡ºæ¥çš„ä¸€ä¸ªä½ç½®ï¼Œç„¶åå·¦å³ä¸¤è¾¹æœç´¢æ‰¾åˆ°ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®å°±å¯ä»¥äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] searchRange(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;-<span class="number">1</span>, -<span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> index = binarySearch(nums, target, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (index == -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;-<span class="number">1</span>, -<span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> left = index, right = index;</span><br><span class="line">    <span class="keyword">while</span> (left &gt;= <span class="number">0</span> &amp;&amp; nums[left] == target) &#123;</span><br><span class="line">        left--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (right &lt; nums.length &amp;&amp; nums[right] == target) &#123;</span><br><span class="line">        right++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;left + <span class="number">1</span>, right - <span class="number">1</span>&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">binarySearch</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left &lt;= right) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (right - left) / <span class="number">2</span> + left;</span><br><span class="line">        <span class="keyword">if</span> (nums[mid] == target) &#123;</span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums[mid] &gt; target ? binarySearch(nums, target, left, mid - <span class="number">1</span>)</span><br><span class="line">                : binarySearch(nums, target, mid + <span class="number">1</span>, right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0034-2"><p>ç¬¬ä¸€ç§è§£æ³•å¾ˆç®€å•ä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼Œäº‹å®ä¸Šæˆ‘ä»¬æ›´å¸Œæœ›çš„æ˜¯å¯ä»¥ç›´æ¥ æ‰¾åˆ°ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®ï¼Œè€Œä¸æ˜¯åé¢å†å»æœæœä¸€æ¬¡ã€‚</p><p><strong>æ‰¾åˆ°ç¬¬ä¸€ä¸ªä½ç½®</strong></p><ol><li>å¦‚æœæ‰¾åˆ°çš„ä¸­ç‚¹<code>nums[mid] == target</code>ï¼Œé‚£ä¹ˆè¿™ä¸ª<code>mid</code>å¯èƒ½æ˜¯ç¬¬ä¸€ä¸ªä½ç½®ä¹Ÿå¯èƒ½ä¸æ˜¯ç¬¬ä¸€ä¸ªä½ç½®ï¼Œå› æ­¤æ­¤æ—¶ä¸æ˜¯åŸæ¥çš„äºŒåˆ†æœç´¢é‚£æ ·ç›´æ¥è¿”å›è€Œæ˜¯ç»§ç»­å¾€å·¦è¾¹æ‰¾ï¼Œå³<code>right = mid - 1</code></li><li>å¦‚æœæ­¤æ—¶<code>nums[mid] &gt; target</code>ï¼Œé‚£ä¹ˆå°±éœ€è¦åˆ°<code>mid</code>çš„å·¦è¾¹æ‰¾ï¼Œå³<code>right = mid - 1</code></li><li>å¦‚æœæ­¤æ—¶<code>nums[mid] &lt; target</code>ï¼Œé‚£ä¹ˆå°±éœ€è¦åˆ°<code>mid</code>çš„å³è¾¹æ‰¾ï¼Œå³<code>left = mid + 1</code></li></ol><p><strong>æ‰¾åˆ°æœ€åä¸€ä¸ªä½ç½®</strong></p><p>å’Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä½ç½®å”¯ä¸€ä¸åŒçš„åœ°æ–¹åœ¨äºç¬¬ä¸€æ­¥ï¼Œå¦‚æœæ­¤æ—¶æ‰¾åˆ°çš„<code>mid</code>æ»¡è¶³<code>nums[mid] == target</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªä½ç½®å¯èƒ½æ˜¯æœ€åä¸€ä¸ªä¹Ÿå¯èƒ½ä¸æ˜¯ï¼Œå°±éœ€è¦åˆ°å³è¾¹ç»§ç»­æ‰¾ï¼Œå³<code>left = mid + 1</code>ï¼Œä¹‹åçš„ä¸¤æ­¥ç›¸åŒ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] searchRange(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;-<span class="number">1</span>, -<span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> left = findFirstPosition(nums, target, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (left == -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;-<span class="number">1</span>, -<span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> right = findLastPosition(nums, target, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;left, right&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">findFirstPosition</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left &lt;= right) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (right - left) / <span class="number">2</span> + left;</span><br><span class="line">        <span class="keyword">if</span> (nums[mid] == target) &#123;</span><br><span class="line">            <span class="keyword">return</span> findFirstPosition(nums, target, left, mid - <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[mid] &lt; target) &#123;</span><br><span class="line">            <span class="keyword">return</span> findFirstPosition(nums, target, mid + <span class="number">1</span>, right);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> findFirstPosition(nums, target, left, mid - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (left &gt;= <span class="number">0</span> &amp;&amp; left &lt; nums.length &amp;&amp; nums[left] == target) &#123;</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">findLastPosition</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left &lt;= right) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (right - left) / <span class="number">2</span> + left;</span><br><span class="line">        <span class="keyword">if</span> (nums[mid] == target) &#123;</span><br><span class="line">            <span class="keyword">return</span> findLastPosition(nums, target, mid + <span class="number">1</span>, right);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[mid] &lt; target) &#123;</span><br><span class="line">            <span class="keyword">return</span> findLastPosition(nums, target, mid + <span class="number">1</span>, right);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> findLastPosition(nums, target, left, mid - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (right &gt;= <span class="number">0</span> &amp;&amp; right &lt; nums.length &amp;&amp; nums[right] == target) &#123;</span><br><span class="line">        <span class="keyword">return</span> right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0035-æœç´¢æ’å…¥ä½ç½®"><a href="#0035-æœç´¢æ’å…¥ä½ç½®" class="headerlink" title="0035 æœç´¢æ’å…¥ä½ç½®"></a>0035 æœç´¢æ’å…¥ä½ç½®</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000711.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®šä¸€ä¸ªæ’åºæ•°ç»„å’Œä¸€ä¸ªç›®æ ‡å€¼ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œå¹¶è¿”å›å…¶ç´¢å¼•ã€‚å¦‚æœç›®æ ‡å€¼ä¸å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œè¿”å›å®ƒå°†ä¼šè¢«æŒ‰é¡ºåºæ’å…¥çš„ä½ç½®ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ•°ç»„ä¸­æ— é‡å¤å…ƒç´ ã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>è¾“å…¥: [1,3,5,6], 5<br>è¾“å‡º: 2</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>è¾“å…¥: [1,3,5,6], 2<br>è¾“å‡º: 1</p></blockquote><p>ç¤ºä¾‹ 3:</p><blockquote><p>è¾“å…¥: [1,3,5,6], 7<br>è¾“å‡º: 4</p></blockquote><p>ç¤ºä¾‹ 4:</p><blockquote><p>è¾“å…¥: [1,3,5,6], 0<br>è¾“å‡º: 0</p></blockquote><div class="tabs" id="0035"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0035-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0035-1"><p>é¢˜ç›®å¾ˆç®€å•ï¼Œæš´åŠ›å¾ªç¯å°±å¯ä»¥è§£å†³ï¼Œä½†æ˜¯å½“ç„¶ä¸èƒ½ç”¨è¿™ä¹ˆ<code>low</code>çš„æ–¹æ³•ã€‚æ—¢ç„¶æ•°ç»„æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ€¼äºŒåˆ†æœç´¢ï¼Œè¿™è¾¹é€šè¿‡äºŒåˆ†æœç´¢æ‰¾åˆ°ä¸€ä¸ªå°½å¯èƒ½æ¥è¿‘<code>target</code>çš„æ•°å°±å¯ä»¥äº†ã€‚</p><ol><li>å¦‚æœæ‰¾åˆ°çš„<code>nums[mid] == target</code>ï¼Œè¿™ä¸ªä½ç½®å°±æ˜¯è¦æ’å…¥çš„ä½ç½®ï¼ˆä¸å¯èƒ½æœ‰é‡å¤çš„æ•°æ®ï¼‰</li><li>å¦‚æœ<code>nums[mid] &gt; target</code>ï¼Œè¯´æ˜éœ€è¦åˆ°å·¦è¾¹å»æŸ¥æ‰¾ç¬¦åˆçš„æ•°</li><li>å¦‚æœ<code>nums[mid] &lt; target</code>ï¼Œé‚£ä¹ˆå°±å»å³è¾¹æ‰¾</li><li>æœ€åéå¸¸é‡è¦çš„ä¸€ç‚¹ï¼Œ<code>left &lt; right</code>è€Œä¸æ˜¯<code>lft &lt;= right</code></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">searchInsert</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = nums.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (right - left) / <span class="number">2</span> + left;</span><br><span class="line">        <span class="keyword">if</span> (nums[mid] == target) &#123;</span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nums[mid] &gt; target) &#123;</span><br><span class="line">            right = mid - <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> nums[left] &gt;= target ? left : left + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0039-ç»„åˆæ€»æ•°"><a href="#0039-ç»„åˆæ€»æ•°" class="headerlink" title="0039 ç»„åˆæ€»æ•°"></a>0039 ç»„åˆæ€»æ•°</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®šä¸€ä¸ªæ— é‡å¤å…ƒç´ çš„æ•°ç»„ candidates å’Œä¸€ä¸ªç›®æ ‡æ•° target ï¼Œæ‰¾å‡º candidates ä¸­æ‰€æœ‰å¯ä»¥ä½¿æ•°å­—å’Œä¸º target çš„ç»„åˆã€‚</p><p>candidates ä¸­çš„æ•°å­—å¯ä»¥æ— é™åˆ¶é‡å¤è¢«é€‰å–ã€‚</p><p>è¯´æ˜ï¼š</p><ul><li><p>æ‰€æœ‰æ•°å­—ï¼ˆåŒ…æ‹¬ targetï¼‰éƒ½æ˜¯æ­£æ•´æ•°ã€‚</p></li><li><p>è§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆã€‚ </p></li></ul><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šcandidates = [2,3,6,7], target = 7,<br>æ‰€æ±‚è§£é›†ä¸ºï¼š<br>[<br>  [7],<br>  [2,2,3]<br>]</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šcandidates = [2,3,5], target = 8,<br>æ‰€æ±‚è§£é›†ä¸ºï¼š<br>[<br>  [2,2,2,2],<br>  [2,3,3],<br>  [3,5]<br>]</p></blockquote><div class="note info simple"><p>æç¤ºï¼š</p><p>1 &lt;= candidates.length &lt;= 30<br>1 &lt;= candidates[i] &lt;= 200<br>candidate ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚<br>1 &lt;= target &lt;= 500</p></div><div class="tabs" id="0035"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0035-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0035-1"><p>é¢˜ç›®å¾ˆç®€å•ï¼Œç›´æ¥ç”¨DFSå°±å¯ä»¥å®Œç¾æå®šã€‚åªéœ€è¦è®¤ä¸ºæ˜¯åœ¨ä¸æ–­çš„æ‹¼å‡‘ä¸€ä¸ª<code>targer</code>ï¼Œä¸æ–­åœ°å°è¯•å°±å¥½äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum(<span class="keyword">int</span>[] candidates, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (candidates == <span class="keyword">null</span> || candidates.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(candidates);</span><br><span class="line">    <span class="keyword">if</span> (candidates[<span class="number">0</span>] &gt; target) &#123;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(candidates, target, <span class="number">0</span>, res, <span class="keyword">new</span> ArrayList&lt;&gt;());</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target, <span class="keyword">int</span> index, List&lt;List&lt;Integer&gt;&gt; res, List&lt;Integer&gt; temp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (target == <span class="number">0</span>) &#123;</span><br><span class="line">        res.add(<span class="keyword">new</span> ArrayList&lt;&gt;(temp));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = index; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[i] &gt; target) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        temp.add(nums[i]);</span><br><span class="line">        dfs(nums, target - nums[i], i, res, temp);</span><br><span class="line">        temp.remove(temp.size() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0040-ç»„åˆæ€»æ•°II"><a href="#0040-ç»„åˆæ€»æ•°II" class="headerlink" title="0040 ç»„åˆæ€»æ•°II"></a>0040 ç»„åˆæ€»æ•°II</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®šä¸€ä¸ªæ•°ç»„ candidates å’Œä¸€ä¸ªç›®æ ‡æ•° target ï¼Œæ‰¾å‡º candidates ä¸­æ‰€æœ‰å¯ä»¥ä½¿æ•°å­—å’Œä¸º target çš„ç»„åˆã€‚</p><p>candidates ä¸­çš„æ¯ä¸ªæ•°å­—åœ¨æ¯ä¸ªç»„åˆä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚</p><p>è¯´æ˜ï¼š</p><ul><li><p>æ‰€æœ‰æ•°å­—ï¼ˆåŒ…æ‹¬ç›®æ ‡æ•°ï¼‰éƒ½æ˜¯æ­£æ•´æ•°ã€‚</p></li><li><p>è§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆã€‚ </p></li></ul><p>ç¤ºä¾‹ 1:</p><blockquote><p>è¾“å…¥: candidates = [10,1,2,7,6,1,5], target = 8,<br>æ‰€æ±‚è§£é›†ä¸º:<br>[<br>  [1, 7],<br>  [1, 2, 5],<br>  [2, 6],<br>  [1, 1, 6]<br>]</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>è¾“å…¥: candidates = [2,5,2,1,2], target = 5,<br>æ‰€æ±‚è§£é›†ä¸º:<br>[<br>  [1,2,2],<br>  [5]<br>]</p></blockquote><div class="tabs" id="0040"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0040-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0040-1"><p>å’Œç»„åˆæ€»æ•°çš„æ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ä¸€ä¸ªæ•°åªèƒ½ç”¨ä¸€æ¬¡äº†ï¼Œä½†æ˜¯è¿™ä¸ªå…¶å®å¹¶ä¸å½±å“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum2(<span class="keyword">int</span>[] candidates, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    <span class="keyword">if</span> (candidates == <span class="keyword">null</span> || candidates.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    Arrays.sort(candidates);</span><br><span class="line">    dfs(candidates, target, <span class="number">0</span>, res, <span class="keyword">new</span> ArrayList&lt;&gt;());</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target, <span class="keyword">int</span> index, List&lt;List&lt;Integer&gt;&gt; res, List&lt;Integer&gt; temp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (target == <span class="number">0</span>) &#123;</span><br><span class="line">        res.add(<span class="keyword">new</span> ArrayList&lt;&gt;(temp));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = index; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (target &lt; nums[i]) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; index &amp;&amp; nums[i] == nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        temp.add(nums[i]);</span><br><span class="line">        dfs(nums, target - nums[i], i + <span class="number">1</span>, res, temp);</span><br><span class="line">        temp.remove(temp.size() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0041-ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°"><a href="#0041-ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°" class="headerlink" title="0041 ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°"></a>0041 ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001204.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™ä½ ä¸€ä¸ªæœªæ’åºçš„æ•´æ•°æ•°ç»„ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­æ²¡æœ‰å‡ºç°çš„æœ€å°çš„æ­£æ•´æ•°ã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>è¾“å…¥: [1,2,0]<br>è¾“å‡º: 3</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>è¾“å…¥: [3,4,-1,1]<br>è¾“å‡º: 2</p></blockquote><p>ç¤ºä¾‹ 3:</p><blockquote><p>è¾“å…¥: [7,8,9,11,12]<br>è¾“å‡º: 1</p></blockquote><div class="note info simple"><p>ä½ çš„ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åº”ä¸ºO(n)ï¼Œå¹¶ä¸”åªèƒ½ä½¿ç”¨å¸¸æ•°çº§åˆ«çš„é¢å¤–ç©ºé—´ã€‚</p></div><div class="tabs" id="0041"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0041-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0041-1"><p>ç”±äºåªèƒ½ç”¨åˆ°å¸¸æ•°çº§åˆ«çš„ç©ºé—´å¤æ‚åº¦ï¼Œé‚£ä¹ˆå°±åªå¥½å¤ç”¨åŸæ¥çš„æ•°ç»„äº†ï¼Œå‡å¦‚è¯´åœ¨<code>i</code>ä½ç½®çš„æ•°ä¸º<code>nums[i]</code>ï¼Œé‚£ä¹ˆå°†å¯¹åº”ä½ç½®çš„æ•°å˜æˆè´Ÿæ•°ï¼Œå³<code>nums[nums[i] - 1] = -nums[nums[i - 1]]</code>ï¼Œè¿™å°±ä»£è¡¨ç€ï¼Œæ•°å­—<code>nums[i]</code>å‡ºç°è¿‡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">firstMissingPositive</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[i] &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            nums[i] = nums.length + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> temp = Math.abs(nums[i]);</span><br><span class="line">        <span class="keyword">if</span> (temp &lt;= nums.length) &#123;</span><br><span class="line">            nums[temp - <span class="number">1</span>] = -Math.abs(nums[temp - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[i] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0042-æ¥é›¨æ°´"><a href="#0042-æ¥é›¨æ°´" class="headerlink" title="0042 æ¥é›¨æ°´"></a>0042 æ¥é›¨æ°´</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001204.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®š <em>n</em> ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¯ä¸ªå®½åº¦ä¸º 1 çš„æŸ±å­çš„é«˜åº¦å›¾ï¼Œè®¡ç®—æŒ‰æ­¤æ’åˆ—çš„æŸ±å­ï¼Œä¸‹é›¨ä¹‹åèƒ½æ¥å¤šå°‘é›¨æ°´ã€‚</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/10/22/rainwatertrap.png"></p><blockquote><p>è¾“å…¥ï¼šheight = [0,1,0,2,1,0,1,3,2,1,2,1]<br>è¾“å‡ºï¼š6<br>è§£é‡Šï¼šä¸Šé¢æ˜¯ç”±æ•°ç»„ [0,1,0,2,1,0,1,3,2,1,2,1] è¡¨ç¤ºçš„é«˜åº¦å›¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥æ¥ 6 ä¸ªå•ä½çš„é›¨æ°´ï¼ˆè“è‰²éƒ¨åˆ†è¡¨ç¤ºé›¨æ°´ï¼‰ã€‚ </p></blockquote><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><blockquote><p>è¾“å…¥ï¼šheight = [4,2,0,3,2,5]<br>è¾“å‡ºï¼š9</p></blockquote><div class="tabs" id="0042"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0042-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li><li class="tab"><button type="button" data-href="#0042-2"><i class="fas fa-pen"></i>è§£æ³•2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0042-1"><p>è¿™ä¸ªé¢˜ç›®å…¶å®ä¹Ÿä¸éš¾ï¼Œå¯¹äºæŸä¸€åˆ—<code>i</code>ï¼Œå¦‚æœè¿™ä¸ªåˆ—èƒ½å¤Ÿç§¯æ”’åˆ°é›¨æ°´ï¼Œé‚£ä¹ˆå¿…å®šå­˜åœ¨å·¦å³ä¸¤è¾¹çš„æœ€é«˜ç‚¹éƒ½æ¯”<code>i</code>åˆ—å¤§ï¼Œæ‰€ä»¥è¿™é“é¢˜å°±å˜æˆäº†æ‰¾åˆ°ç¬¬<code>i</code>åˆ—å’Œå·¦å³ä¸¤è¾¹æœ€é«˜ç‚¹çš„å·®ï¼Œç„¶åæ±‚å’Œçš„é¢˜ç›®äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">trap</span><span class="params">(<span class="keyword">int</span>[] height)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (height == <span class="keyword">null</span> || height.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; height.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> maxLeft = <span class="number">0</span>, maxRight = <span class="number">0</span>, min = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">            maxLeft = Math.max(maxLeft, height[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; height.length; j++) &#123;</span><br><span class="line">            maxRight = Math.max(maxRight, height[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        min = Math.min(maxLeft, maxRight);</span><br><span class="line">        <span class="keyword">if</span> (height[i] &lt; min) &#123;</span><br><span class="line">            res += min - height[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0042-2"><p>è¿™ä¸ªè§£æ³•åªæ˜¯å¯¹è§£æ³•1çš„ä¼˜åŒ–ï¼Œäº‹å®ä¸Šå¯ä»¥ä¸éœ€è¦æ¯æ¬¡éƒ½å»æŸ¥æ‰¾å·¦å³ä¸¤è¾¹çš„æœ€å¤§å€¼ï¼Œå®Œå…¨å¯ä»¥ä¿å­˜ä¸‹æ¥çš„ï¼Œè¿™æ ·å°±èŠ‚çœäº†å¾ˆå¤šçš„æ—¶é—´ã€‚</p><p>å¯¹äºä¸€ä¸ªå·²çŸ¥çš„åˆ—<code>i</code>è€Œè¨€ï¼Œå®ƒçš„ä½œè¾¹æœ€å¤§å€¼è¦ä¹ˆå°±æ˜¯ä»–å·¦è¾¹çš„é‚£ä¸ªå€¼ï¼Œè¦ä¹ˆå°±æ˜¯ä¸Šä¸€ä¸ªå·¦è¾¹çš„æœ€å¤§å€¼ã€‚</p><p>åŒç†ï¼Œå¯¹äºå·²çŸ¥åˆ—<code>i</code>è€Œè¨€ï¼Œå…¶å³è¾¹çš„æœ€å¤§å€¼è¦ä¹ˆæ˜¯å®ƒå³è¾¹çš„æ•°ï¼Œè¦ä¹ˆæ˜¯ä¸Šä¸€ä¸ªå³è¾¹çš„æœ€å¤§å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">trap</span><span class="params">(<span class="keyword">int</span>[] height)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (height == <span class="keyword">null</span> || height.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span>[] maxLeft = <span class="keyword">new</span> <span class="keyword">int</span>[height.length];</span><br><span class="line">    <span class="keyword">int</span>[] maxRight = <span class="keyword">new</span> <span class="keyword">int</span>[height.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; height.length; i++) &#123;</span><br><span class="line">        maxLeft[i] = Math.max(maxLeft[i - <span class="number">1</span>], height[i - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = height.length - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        maxRight[i] = Math.max(maxRight[i + <span class="number">1</span>], height[i + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; height.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> min = Math.min(maxLeft[i], maxRight[i]);</span><br><span class="line">        <span class="keyword">if</span> (min &gt; height[i]) &#123;</span><br><span class="line">            res += min - height[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0045-è·³è·ƒæ¸¸æˆII"><a href="#0045-è·³è·ƒæ¸¸æˆII" class="headerlink" title="0045 è·³è·ƒæ¸¸æˆII"></a>0045 è·³è·ƒæ¸¸æˆII</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001204.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ï¼Œä½ æœ€åˆä½äºæ•°ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚</p><p>æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä»£è¡¨ä½ åœ¨è¯¥ä½ç½®å¯ä»¥è·³è·ƒçš„æœ€å¤§é•¿åº¦ã€‚</p><p>ä½ çš„ç›®æ ‡æ˜¯ä½¿ç”¨æœ€å°‘çš„è·³è·ƒæ¬¡æ•°åˆ°è¾¾æ•°ç»„çš„æœ€åä¸€ä¸ªä½ç½®ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><blockquote><p>è¾“å…¥: [2,3,1,1,4]<br>è¾“å‡º: 2<br>è§£é‡Š: è·³åˆ°æœ€åä¸€ä¸ªä½ç½®çš„æœ€å°è·³è·ƒæ•°æ˜¯ 2ã€‚<br>     ä»ä¸‹æ ‡ä¸º 0 è·³åˆ°ä¸‹æ ‡ä¸º 1 çš„ä½ç½®ï¼Œè·³ 1 æ­¥ï¼Œç„¶åè·³ 3 æ­¥åˆ°è¾¾æ•°ç»„çš„æœ€åä¸€ä¸ªä½ç½®ã€‚</p></blockquote><p><strong>è¯´æ˜ï¼š</strong></p><p>å‡è®¾ä½ æ€»æ˜¯å¯ä»¥åˆ°è¾¾æ•°ç»„çš„æœ€åä¸€ä¸ªä½ç½®ã€‚</p><div class="tabs" id="0045"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0045-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li><li class="tab"><button type="button" data-href="#0045-2"><i class="fas fa-pen"></i>è§£æ³•2</button></li><li class="tab"><button type="button" data-href="#0045-3"><i class="fas fa-pen"></i>è§£æ³•3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0045-1"><p>ç¬¬ä¸€ä¸ªæƒ³æ³•æ˜¯ï¼šä»æœ€åä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œå› ä¸ºè¦èµ°åˆ°æœ€åä¸€ä¸ªä½ç½®å˜›ï¼Œé‚£æˆ‘å°±ä¸€ä¸ªä¸€ä¸ªè¯•å‘—ï¼Œå…ˆçœ‹çœ‹å‰é¢ä¸€ä¸ªèƒ½ä¸èƒ½èµ°åˆ°æˆ‘è¿™é‡Œæ¥ï¼Œå†çœ‹çœ‹æˆ‘å‰é¢çš„å‰é¢èƒ½ä¸èƒ½èµ°åˆ°æˆ‘è¿™é‡Œæ¥â€¦ä¾æ¬¡å¾ªç¯æŸ¥æ‰¾ï¼Œæœ€ç»ˆè¶…æ—¶äº†ğŸ˜‚ï¼Œä¸ç®¡æ€ä¹ˆæ ·ä¹Ÿç®—æ˜¯ä¸€ä¸ªæ€è·¯äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Integer res = Integer.MAX_VALUE;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">jump</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = nums.length - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">int</span> minStep = dfs(nums, i, nums.length - i - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        res = Math.min(res, minStep);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> curr, <span class="keyword">int</span> minLen, <span class="keyword">int</span> step)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums[curr] &gt;= minLen) &#123;</span><br><span class="line">        <span class="keyword">if</span> (curr == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> step;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= curr; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> minStep = dfs(nums, curr - i, i, step + <span class="number">1</span>);</span><br><span class="line">            res = Math.min(res, minStep);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Integer.MAX_VALUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0045-2"><p>å¬è¯´è¿™ç§æ–¹æ³•å«è´ªå¿ƒ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">jump</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> step = <span class="number">0</span>, position = nums.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (position &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; position; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i + nums[i] &gt;= position) &#123;</span><br><span class="line">                step++;</span><br><span class="line">                position = i;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> step;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0045-3"><p>å®åœ¨ä¸ä¼šï¼Œçœ‹çœ‹ç­”æ¡ˆåŒºçš„å¤§ç¥éƒ½æ˜¯è¿™ä¹ˆåšçš„å§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">jump</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> length = nums.length;</span><br><span class="line">        <span class="keyword">int</span> end = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> maxPosition = <span class="number">0</span>; </span><br><span class="line">        <span class="keyword">int</span> steps = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            maxPosition = Math.max(maxPosition, i + nums[i]); </span><br><span class="line">            <span class="keyword">if</span> (i == end) &#123;</span><br><span class="line">                end = maxPosition;</span><br><span class="line">                steps++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> steps;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0048-æ—‹è½¬æ•°ç»„"><a href="#0048-æ—‹è½¬æ•°ç»„" class="headerlink" title="0048 æ—‹è½¬æ•°ç»„"></a>0048 æ—‹è½¬æ•°ç»„</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®šä¸€ä¸ª n Ã— n çš„äºŒç»´çŸ©é˜µè¡¨ç¤ºä¸€ä¸ªå›¾åƒã€‚å°†å›¾åƒé¡ºæ—¶é’ˆæ—‹è½¬ 90 åº¦ã€‚</p><p>è¯´æ˜ï¼š</p><p>ä½ å¿…é¡»åœ¨åŸåœ°æ—‹è½¬å›¾åƒï¼Œè¿™æ„å‘³ç€ä½ éœ€è¦ç›´æ¥ä¿®æ”¹è¾“å…¥çš„äºŒç»´çŸ©é˜µã€‚è¯·ä¸è¦ä½¿ç”¨å¦ä¸€ä¸ªçŸ©é˜µæ¥æ—‹è½¬å›¾åƒã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p>ç»™å®š matrix =<br>[<br>  [1,2,3],<br>  [4,5,6],<br>  [7,8,9]<br>],</p><p>åŸåœ°æ—‹è½¬è¾“å…¥çŸ©é˜µï¼Œä½¿å…¶å˜ä¸º:<br>[<br>  [7,4,1],<br>  [8,5,2],<br>  [9,6,3]<br>]</p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p>ç»™å®š matrix =<br>[<br>  [ 5, 1, 9,11],<br>  [ 2, 4, 8,10],<br>  [13, 3, 6, 7],<br>  [15,14,12,16]<br>], </p><p>åŸåœ°æ—‹è½¬è¾“å…¥çŸ©é˜µï¼Œä½¿å…¶å˜ä¸º:<br>[<br>  [15,13, 2, 5],<br>  [14, 3, 4, 1],<br>  [12, 6, 8, 9],<br>  [16, 7,10,11]<br>]</p></blockquote><div class="tabs" id="0045"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0045-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0045-1"><p>å¾ˆç®€å•ï¼Œå…ˆæ±‚è¿™ä¸ªæ•°ç»„çš„è½¬ç½®ï¼Œç„¶åå†æŠŠæ¯è¡Œè¿›è¡Œé€†åºå°±å¥½äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span>[][] matrix)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = matrix.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; len; j++) &#123;</span><br><span class="line">            <span class="keyword">int</span> temp = matrix[i][j];</span><br><span class="line">            matrix[i][j] = matrix[j][i];</span><br><span class="line">            matrix[j][i] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span>[] ints : matrix) &#123;</span><br><span class="line">        reverse(ints);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = nums.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">        swap(nums, i++, j--);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = nums[i];</span><br><span class="line">    nums[i] = nums[j];</span><br><span class="line">    nums[j] = temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0053-æœ€å¤§å­åºå’Œ"><a href="#0053-æœ€å¤§å­åºå’Œ" class="headerlink" title="0053 æœ€å¤§å­åºå’Œ"></a>0053 æœ€å¤§å­åºå’Œ</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000711.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ï¼Œæ‰¾åˆ°ä¸€ä¸ªå…·æœ‰æœ€å¤§å’Œçš„è¿ç»­å­æ•°ç»„ï¼ˆå­æ•°ç»„æœ€å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œè¿”å›å…¶æœ€å¤§å’Œã€‚</p><p>ç¤ºä¾‹:</p><blockquote><p>è¾“å…¥: [-2,1,-3,4,-1,2,1,-5,4]<br>è¾“å‡º: 6<br>è§£é‡Š: è¿ç»­å­æ•°ç»„ [4,-1,2,1] çš„å’Œæœ€å¤§ï¼Œä¸º 6ã€‚</p></blockquote><p><strong>è¿›é˜¶:</strong></p><p>å¦‚æœä½ å·²ç»å®ç°å¤æ‚åº¦ä¸º O(n) çš„è§£æ³•ï¼Œå°è¯•ä½¿ç”¨æ›´ä¸ºç²¾å¦™çš„åˆ†æ²»æ³•æ±‚è§£ã€‚</p><div class="tabs" id="0053"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0053-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li><li class="tab"><button type="button" data-href="#0053-2"><i class="fas fa-pen"></i>è§£æ³•2</button></li><li class="tab"><button type="button" data-href="#0053-3"><i class="fas fa-pen"></i>è§£æ³•3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0053-1"><p>å¾ˆç®€å•ï¼Œå‡è®¾<code>i ~ j</code>æ˜¯ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„è¿ç»­å­åºåˆ—ï¼ˆæ­¤æ—¶è¯¥åºåˆ—çš„å’Œå¤§äº0ï¼‰ï¼Œå¦‚æœè¿™ä¸ªåºåˆ—å†åŠ ä¸Šä¸‹ä¸€ä¸ªæ•°<code>nums[k]</code>ä½¿å¾—åºåˆ—<code>i ~ k</code>çš„å’Œä¸ºä¸€ä¸ªè´Ÿæ•°ï¼Œé‚£ä¹ˆåºåˆ—<code>i ~ k</code>å°±ç»å¯¹ä¸å¯èƒ½æˆä¸ºæœ€å¤§å­åºåˆ—çš„ä¸€éƒ¨åˆ†äº†ï¼Œå¯ä»¥å‡è®¾æœ€å¤§å­åºåˆ—<code>i ~ n</code>ç”±<code>i ~ k</code> + <code>k + 1  ~ n</code>ç»„æˆï¼Œæ—¢ç„¶<code>i ~ k</code>ä¸ºä¸€ä¸ªè´Ÿæ•°ï¼Œé‚£ä¹ˆæ˜¾ç„¶<code>k + 1 ~ n</code>ä¼šæ¯”<code>i ~ k</code>å¤§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> res = Integer.MIN_VALUE, temp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        temp = temp + nums[i];</span><br><span class="line">        res = Math.max(res, temp);</span><br><span class="line">        <span class="keyword">if</span> (temp &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            temp = nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0053-2"><p>è¿˜æœ‰ä¸€ç§åŠ¨æ€è§„åˆ’çš„è§£æ³•ï¼Œå‡è®¾<code>dp[i]</code>è¡¨ç¤ºé•¿åº¦ä¸º<code>i + 1</code>çš„æ•°ç»„æœ€å¤§å­åºåˆ—çš„å’Œï¼Œé‚£ä¹ˆæ˜¾ç„¶<code>dp[i] = Math.max(nums[i], nums[i] + dp[i - 1])</code>ï¼Œæ ¹æ®è¿™ä¸ªå¼å­å¯ä»¥å†™å‡ºä»¥ä¸‹ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</span><br><span class="line">    dp[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">int</span> res = dp[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        dp[i] = Math.max(nums[i], nums[i] + dp[i - <span class="number">1</span>]);</span><br><span class="line">        res = Math.max(res, dp[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0053-3"><p>è¿˜æœ‰ä¸€ç§å¾ˆæœ‰æ„æ€çš„åˆ†æ²»ç®—æ³•ï¼Œå‡è®¾ç»“æœå­åºåˆ—æ˜¯<code>i ~ j</code>ï¼ŒåŸæ¥åºåˆ—çš„ä¸­ç‚¹æ˜¯<code>mid</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªå­åºåˆ—å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</p><ol><li>å­åºåˆ—åœ¨åŸæ¥åºåˆ—çš„å·¦è¾¹ï¼Œå³<code>j &lt; mid</code></li><li>å­åºåˆ—åœ¨åŸæ¥åºåˆ—çš„å³è¾¹ï¼Œå³<code>i &gt; mid</code></li><li>å­åºåˆ—åœ¨åŸæ¥åºåˆ—çš„ä¸­é—´ï¼Œå³<code>i ~ j</code> =  <code>i ~ mid</code> + <code>mid + 1 ~ j</code></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> findMaxWithoutMid(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">findMaxWithoutMid</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">        <span class="keyword">return</span> nums[left];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (right - left) / <span class="number">2</span> + left;</span><br><span class="line">    <span class="keyword">int</span> leftSum = findMaxWithoutMid(nums, left, mid);</span><br><span class="line">    <span class="keyword">int</span> rightSum = findMaxWithoutMid(nums, mid + <span class="number">1</span>, right);</span><br><span class="line">    <span class="keyword">int</span> midSum = findMaxWithMid(nums, left, mid, right);</span><br><span class="line">    <span class="keyword">return</span> Math.max(Math.max(leftSum, midSum), rightSum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">findMaxWithMid</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> left, <span class="keyword">int</span> mid, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> leftSum = Integer.MIN_VALUE, rightSum = Integer.MIN_VALUE, temp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = mid; i &gt;= left; i--) &#123;</span><br><span class="line">        temp = temp + nums[i];</span><br><span class="line">        leftSum = Math.max(leftSum, temp);</span><br><span class="line">    &#125;</span><br><span class="line">    temp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = mid + <span class="number">1</span>; i &lt;= right; i++) &#123;</span><br><span class="line">        temp = temp + nums[i];</span><br><span class="line">        rightSum = Math.max(rightSum, temp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> leftSum + rightSum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0054-èºæ—‹æ•°ç»„"><a href="#0054-èºæ—‹æ•°ç»„" class="headerlink" title="0054 èºæ—‹æ•°ç»„"></a>0054 èºæ—‹æ•°ç»„</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®šä¸€ä¸ªåŒ…å« m x n ä¸ªå…ƒç´ çš„çŸ©é˜µï¼ˆm è¡Œ, n åˆ—ï¼‰ï¼Œè¯·æŒ‰ç…§é¡ºæ—¶é’ˆèºæ—‹é¡ºåºï¼Œè¿”å›çŸ©é˜µä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p>è¾“å…¥:<br>[<br> [ 1, 2, 3 ],<br> [ 4, 5, 6 ],<br> [ 7, 8, 9 ]<br>]</p><p>è¾“å‡º: [1,2,3,6,9,8,7,4,5]</p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p>è¾“å…¥:<br>[<br>  [1, 2, 3, 4],<br>  [5, 6, 7, 8],<br>  [9,10,11,12]<br>]<br>è¾“å‡º: [1,2,3,4,8,12,11,10,9,5,6,7]</p></blockquote><div class="tabs" id="0054"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0054-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0054-1"><p>ç®€å•æ¨¡æ‹Ÿå°±å¥½äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">spiralOrder</span><span class="params">(<span class="keyword">int</span>[][] matrix)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (matrix == <span class="keyword">null</span> || matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> n = matrix.length, m = matrix[<span class="number">0</span>].length;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = m - <span class="number">1</span>, top = <span class="number">0</span>, bottom = n - <span class="number">1</span>;</span><br><span class="line">    List&lt;Integer&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">while</span> (left &lt;= right &amp;&amp; top &lt;= bottom) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = left; i &lt;= right; i++) &#123;</span><br><span class="line">            res.add(matrix[top][i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = top + <span class="number">1</span>; i &lt;= bottom; i++) &#123;</span><br><span class="line">            res.add(matrix[i][right]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (left &lt; right &amp;&amp; top &lt; bottom) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = right - <span class="number">1</span>; i &gt; left; i--) &#123;</span><br><span class="line">                res.add(matrix[bottom][i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = bottom; i &gt; top; i--) &#123;</span><br><span class="line">                res.add(matrix[i][left]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        left++;</span><br><span class="line">        right--;</span><br><span class="line">        top++;</span><br><span class="line">        bottom--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0055-è·³è·ƒæ¸¸æˆ"><a href="#0055-è·³è·ƒæ¸¸æˆ" class="headerlink" title="0055 è·³è·ƒæ¸¸æˆ"></a>0055 è·³è·ƒæ¸¸æˆ</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ï¼Œä½ æœ€åˆä½äºæ•°ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚</p><p>æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä»£è¡¨ä½ åœ¨è¯¥ä½ç½®å¯ä»¥è·³è·ƒçš„æœ€å¤§é•¿åº¦ã€‚</p><p>åˆ¤æ–­ä½ æ˜¯å¦èƒ½å¤Ÿåˆ°è¾¾æœ€åä¸€ä¸ªä½ç½®ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p>è¾“å…¥: [2,3,1,1,4]<br>è¾“å‡º: true<br>è§£é‡Š: æˆ‘ä»¬å¯ä»¥å…ˆè·³ 1 æ­¥ï¼Œä»ä½ç½® 0 åˆ°è¾¾ ä½ç½® 1, ç„¶åå†ä»ä½ç½® 1 è·³ 3 æ­¥åˆ°è¾¾æœ€åä¸€ä¸ªä½ç½®ã€‚</p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p>è¾“å…¥: [3,2,1,0,4]<br>è¾“å‡º: false<br>è§£é‡Š: æ— è®ºæ€æ ·ï¼Œä½ æ€»ä¼šåˆ°è¾¾ç´¢å¼•ä¸º 3 çš„ä½ç½®ã€‚ä½†è¯¥ä½ç½®çš„æœ€å¤§è·³è·ƒé•¿åº¦æ˜¯ 0 ï¼Œ æ‰€ä»¥ä½ æ°¸è¿œä¸å¯èƒ½åˆ°è¾¾æœ€åä¸€ä¸ªä½ç½®ã€‚</p></blockquote><div class="tabs" id="0055"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0055-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0055-1"><p>ä¹‹å‰å·²ç»åšè¿‡ç±»ä¼¼çš„é¢˜ç›®äº†â€¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canJump</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> maxPos = <span class="number">0</span>, end = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        maxPos = Math.max(maxPos, i + nums[i]);</span><br><span class="line">        <span class="keyword">if</span> (i == end) &#123;</span><br><span class="line">            end = maxPos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> end &gt;= nums.length - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="0056-åˆå¹¶åŒºé—´"><a href="#0056-åˆå¹¶åŒºé—´" class="headerlink" title="0056 åˆå¹¶åŒºé—´"></a>0056 åˆå¹¶åŒºé—´</h2><div class="leetcode">    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014001002.svg" />    <img style="float: left;" src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201014000748.svg" /></div><p>ç»™å‡ºä¸€ä¸ªåŒºé—´çš„é›†åˆï¼Œè¯·åˆå¹¶æ‰€æœ‰é‡å çš„åŒºé—´ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><blockquote><p>è¾“å…¥: intervals = [[1,3],[2,6],[8,10],[15,18]]<br>è¾“å‡º: [[1,6],[8,10],[15,18]]<br>è§£é‡Š: åŒºé—´ [1,3] å’Œ [2,6] é‡å , å°†å®ƒä»¬åˆå¹¶ä¸º [1,6].</p></blockquote><p><strong>ç¤ºä¾‹ 2:</strong></p><blockquote><p>è¾“å…¥: intervals = [[1,4],[4,5]]<br>è¾“å‡º: [[1,5]]<br>è§£é‡Š: åŒºé—´ [1,4] å’Œ [4,5] å¯è¢«è§†ä¸ºé‡å åŒºé—´ã€‚</p></blockquote><div class="tabs" id="0056"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0056-1"><i class="fas fa-pen"></i>è§£æ³•1</button></li><li class="tab"><button type="button" data-href="#0056-2"><i class="fas fa-pen"></i>è§£æ³•2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0056-1"><p>å…ˆæŠŠæ•°ç»„æ’åºï¼Œç„¶ååˆ¤æ–­ä¸¤ä¸ªåŒºé—´æ˜¯å¦æœ‰é‡å¤ï¼Œé‡å¤å°±è¦†ç›–ç»“æœçš„å‰ä¸€ä¸ªå…ƒç´ ï¼Œå¦åˆ™æ·»åŠ æ–°çš„å…ƒç´ ï¼Œæ¨¡æ‹Ÿä¸€éå°±å¥½äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[][] merge(<span class="keyword">int</span>[][] intervals) &#123;</span><br><span class="line">    <span class="keyword">if</span> (intervals == <span class="keyword">null</span> || intervals.length == <span class="number">0</span> || intervals[<span class="number">0</span>].length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> intervals;</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(intervals, Comparator.comparingInt(o -&gt; o[<span class="number">0</span>]));</span><br><span class="line">    List&lt;<span class="keyword">int</span>[]&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">1</span>;</span><br><span class="line">    res.add(intervals[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; intervals.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> preMin = res.get(index - <span class="number">1</span>)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> preMax = res.get(index - <span class="number">1</span>)[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> currMin = intervals[i][<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> currMax = intervals[i][<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (currMin &gt;= preMin &amp;&amp; currMin &lt;= preMax) &#123;</span><br><span class="line">            <span class="comment">// é‡åˆ</span></span><br><span class="line">            <span class="keyword">int</span> newMin = Math.min(preMin, currMin);</span><br><span class="line">            <span class="keyword">int</span> newMax = Math.max(preMax, currMax);</span><br><span class="line">            res.get(index - <span class="number">1</span>)[<span class="number">0</span>] = newMin;</span><br><span class="line">            res.get(index - <span class="number">1</span>)[<span class="number">1</span>] = newMax;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.add(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;currMin, currMax&#125;);</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.toArray(<span class="keyword">new</span> <span class="keyword">int</span>[res.size()][]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0056-2"><p>å‰ä¸€ç§ç›´æ¥æ¨¡æ‹Ÿçš„æ–¹æ³•åªèƒ½æ˜¯ä¸€ç§å¸¸è§„è§£æ³•ï¼Œè¿˜æœ‰å¤§ç¥çš„1msè§£æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[][] merge(<span class="keyword">int</span>[][] intervals) &#123;</span><br><span class="line">    <span class="keyword">if</span> (intervals == <span class="keyword">null</span> || intervals.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[][]&#123;&#125;;</span><br><span class="line">    <span class="keyword">int</span> n = intervals.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; intervals.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> l = intervals[i][<span class="number">0</span>], r = intervals[i][<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; intervals.length; j++) &#123;</span><br><span class="line">            <span class="keyword">int</span>[] temp = intervals[j];</span><br><span class="line">            <span class="keyword">if</span> (l &lt;= temp[<span class="number">1</span>] &amp;&amp; r &gt;= temp[<span class="number">0</span>]) &#123;</span><br><span class="line">                temp[<span class="number">0</span>] = Math.min(temp[<span class="number">0</span>], l);</span><br><span class="line">                temp[<span class="number">1</span>] = Math.max(temp[<span class="number">1</span>], r);</span><br><span class="line">                intervals[i] = <span class="keyword">null</span>;</span><br><span class="line">                n--;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[][] ans = <span class="keyword">new</span> <span class="keyword">int</span>[n][];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span>[] interval : intervals) &#123;</span><br><span class="line">        <span class="keyword">if</span> (interval != <span class="keyword">null</span>) &#123;</span><br><span class="line">            ans[--n] = interval;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> LeetCode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é›ªèŠ±ç®—æ³•å®ç°</title>
      <link href="2020/10/08/9f76ab7a.html"/>
      <url>2020/10/08/9f76ab7a.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç®—æ³•åŸç†"><a href="#ç®—æ³•åŸç†" class="headerlink" title="ç®—æ³•åŸç†"></a>ç®—æ³•åŸç†</h2><p>é›ªèŠ±ç®—æ³•ç”Ÿæˆçš„idæ€»å…±ç”±64ä½ç»„æˆï¼Œå…¶æ¯ä¸ªéƒ¨åˆ†å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src= "https://cdn.jsdelivr.net/gh/longhujing/assert/img/20201007015211.gif" data-lazy-src="https://i.loli.net/2020/09/17/9Iaefb4S8EwNL3F.png" alt="13382703-b64e38457ddd13e2.png"></p><p><code>1bit</code>: äºŒè¿›åˆ¶ä¸­æœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œç”¨äºç¡®å®šæ•°å€¼çš„æ­£è´Ÿï¼Œ0ä»£è¡¨æ­£æ•°ï¼Œ1ä»£è¡¨è´Ÿæ•°ã€‚ä¸€èˆ¬è€Œè¨€<code>id</code>éƒ½æ˜¯æ­£æ•°ï¼Œæ‰€ä»¥æœ€é«˜ä½è¿™è¾¹çš„<code>0</code>ä¸€èˆ¬æ˜¯ä¸ä¼šåŠ¨çš„ã€‚</p><p><code>41bit</code>: æ¥ä¸‹æ¥çš„<code>41bit</code>ç”¨äºè®°å½•æ—¶é—´æˆ³ï¼ˆæ¯«ç§’çº§ï¼‰ï¼Œ41ä½å¯ä»¥è¡¨ç¤º$2^{41} - 1$ä¸ªæ•°å­—ï¼Œæ¢ç®—æˆå¹´å°±æ˜¯$(2^{41} - 1) / (1000 * 60 * 60 * 60 * 24 * 365) = 69$å¹´</p><p><code>10bit</code>: æ¥ä¸‹æ¥çš„<code>10bit</code>ç”¨äºåŒºåˆ†ä¸åŒçš„æœºå™¨ï¼Œå› ä¸ºç³»ç»Ÿå¯èƒ½ä¸æ­¢ä¸€å°æœºå™¨ï¼Œæ¯ä¸€å°æœºå™¨ç”Ÿæˆ<code>id</code>çš„æ—¶é—´æˆ³æœ‰å¯èƒ½ç›¸åŒï¼Œå› æ­¤éœ€è¦æ ‡è®°ä¸åŒçš„æœºå™¨ã€‚<code>10bit</code>åˆ†<code>5bit</code>çš„<code>centerId</code>å’Œ<code>5bit</code>çš„<code>workerId</code>ã€‚</p><p><code>12bit</code>: åºåˆ—å·æ˜¯ç”¨æ¥è®°å½•åŒä¸€æ¯«ç§’å†…äº§ç”Ÿçš„ä¸åŒçš„idã€‚ä¸€å°æœºå™¨æœ‰å¯èƒ½åœ¨åŒä¸€æ¯«ç§’å†…ä¼šäº§ç”Ÿå¤šä¸ªidã€‚</p><h2 id="ç®—æ³•å®ç°"><a href="#ç®—æ³•å®ç°" class="headerlink" title="ç®—æ³•å®ç°"></a>ç®—æ³•å®ç°</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SnowFlake</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¼€å§‹æ—¶é—´æˆ³ 2020-01-01 00:00:00</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> startTimeStamp = <span class="number">1577808000000L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœºå™¨idå æ®çš„ä½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> workerIdBits = <span class="number">5L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®è¡¨æ—¶idæ‰€å ä½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> dataCenterIdBits = <span class="number">5L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ€å¤§æ”¯æŒçš„workerId 31</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> maxWorkerId = ~(-<span class="number">1L</span> &lt;&lt; workerIdBits);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ€å¤§æ”¯æŒçš„dataCenterId 31</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> maxDataCenterId = ~(-<span class="number">1L</span> &lt;&lt; dataCenterIdBits);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—å·æ‰€å ä½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> sequenceBits = <span class="number">12L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®æ ‡è¯†èµ·å§‹ä½ç½®ï¼ˆä»å³å¾€å·¦æ•°ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> dataCenterIdShift = sequenceBits + workerIdBits;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ—¶é—´æˆ³æ ‡è¯†èµ·å§‹ä½ç½®ï¼ˆä»å³å¾€å·¦æ•°ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> timeStampShift = sequenceBits + workerIdBits + dataCenterIdBits;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—å·æ©ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> sequenceMask = ~(-<span class="number">1L</span> &lt;&lt; sequenceBits);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœºå™¨id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> workerId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®ä¸­å¿ƒid</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> dataCenterId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—å·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> sequence = <span class="number">0L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¸€æ¬¡ç”Ÿæˆçš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> lastTimeStamp = -<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SnowFlake</span><span class="params">(<span class="keyword">long</span> workerId, <span class="keyword">long</span> dataCenterId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (workerId &gt; maxWorkerId || workerId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(String.format(<span class="string">&quot;WorkerId Can Not Greater Than %s Or Less Than 0&quot;</span>, workerId));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (dataCenterId &gt; maxDataCenterId || dataCenterId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(String.format(<span class="string">&quot;DataCenterId Can Not Greater Than %s Or Less Than 0&quot;</span>, dataCenterId));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.workerId = workerId;</span><br><span class="line">        <span class="keyword">this</span>.dataCenterId = dataCenterId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ä¸‹ä¸€ä¸ªid çº¿ç¨‹å®‰å…¨çš„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ä¸‹ä¸€ä¸ªid</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">long</span> <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–çš„æ—¶é—´æˆ³æœ‰ç²¾åº¦ç¼ºå¤±çš„é—®é¢˜</span></span><br><span class="line">        <span class="keyword">long</span> timestamp = SystemClock.now();</span><br><span class="line">        <span class="keyword">if</span> (timestamp &lt; lastTimeStamp) &#123;</span><br><span class="line">            <span class="comment">// æœ‰å¯èƒ½å‡ºç°äº†ç³»ç»Ÿæ—¶é’Ÿå›é€€</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;Clock Move Backwards, Refusing to generate id&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (timestamp == lastTimeStamp) &#123;</span><br><span class="line">            <span class="comment">// åŒä¸€æ¯«ç§’ï¼Œæ¯«ç§’å†…åºåˆ—åŒ–id</span></span><br><span class="line">            sequence = (sequence + <span class="number">1</span>) &amp; sequenceMask;</span><br><span class="line">            <span class="keyword">if</span> (sequence == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// åºåˆ—åŒ–è€—å°½ï¼Œé˜»å¡ç›´åˆ°è·å–åˆ°ä¸‹ä¸€ä¸ªæ—¶é—´æˆ³</span></span><br><span class="line">                timestamp = tilNextMillis(lastTimeStamp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// æ–°çš„æ¯«ç§’å€¼ é‡ç½®åºåˆ—å·</span></span><br><span class="line">            sequence = <span class="number">0L</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        lastTimeStamp = timestamp;</span><br><span class="line">        <span class="keyword">return</span> ((lastTimeStamp - startTimeStamp) &lt;&lt; timeStampShift)</span><br><span class="line">                | (dataCenterId &lt;&lt; dataCenterIdShift)</span><br><span class="line">                | (workerId &lt;&lt; workerIdBits)</span><br><span class="line">                | sequence;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é˜»å¡åˆ°ä¸‹ä¸€æ¯«ç§’ï¼Œè·å–æ–°çš„æ¯«ç§’å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> lastTimeStamp æœ€åä¸€æ¬¡è·å–åˆ°æ¯«ç§’å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ä¸‹ä¸€ä¸ªæ¯«ç§’å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">tilNextMillis</span><span class="params">(<span class="keyword">long</span> lastTimeStamp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> timestamp = -<span class="number">1L</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            timestamp = SystemClock.now();</span><br><span class="line">        &#125; <span class="keyword">while</span> (timestamp &lt;= lastTimeStamp);</span><br><span class="line">        <span class="keyword">return</span> timestamp;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>System.currentTimeMillisä¼˜åŒ–</title>
      <link href="2020/10/08/84d1ebba.html"/>
      <url>2020/10/08/84d1ebba.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»¥å‰å¼€å‘çš„æ—¶å€™ç»å¸¸ä½¿ç”¨<code>System.currentTimeMillis</code>æ¥è·å–å½“å‰çš„æ—¶é—´æˆ³ï¼Œåˆšå¥½è§£å†³é›ªèŠ±ç®—æ³•ç”Ÿæˆé‡å¤IDçš„æ—¶å€™çœ‹åˆ°äº†è¿™ä¸ªçš„ä¼˜åŒ–ï¼Œå¥½å¥‡ä¹‹ä¸‹å¯¹è¿™ä¸ªä¼˜åŒ–åŠè¿›è¡Œäº†æ¢ç´¢ã€‚</p><h2 id="System-currentTimeMillisä¸ºä»€ä¹ˆæ…¢"><a href="#System-currentTimeMillisä¸ºä»€ä¹ˆæ…¢" class="headerlink" title="System.currentTimeMillisä¸ºä»€ä¹ˆæ…¢"></a>System.currentTimeMillisä¸ºä»€ä¹ˆæ…¢</h2><p>ä¸ºä»€ä¹ˆ<code>System.currentTimeMillis</code>ä¼šè€—æ—¶å‘¢ï¼Ÿæœ‰ä¸€ç¯‡<a href="https://pzemtsov.github.io/2017/07/23/the-slow-currenttimemillis.html">æ–‡ç« </a>å¯¹è¿™ä¸ªåšäº†è§£é‡Šã€‚ç®€è€Œè¨€ä¹‹å°±æ˜¯ï¼šè°ƒç”¨åº•å±‚çš„è·å–æ—¶é—´æˆ³çš„æ–¹æ³•éœ€è¦<strong>ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€</strong>ï¼Œè€Œä¸”è¿™ä¸ªè·å–æ—¶é—´æˆ³çš„æ–¹æ³•è¿˜å—åˆ°Linuxè®¡æ—¶å™¨çš„å½±å“ï¼ˆLinuxç³»ç»Ÿä¸­åªæœ‰ä¸€ä¸ªè®¡æ—¶å™¨ï¼‰å¦‚æœå¹¶å‘è®¿é—®çš„æƒ…å†µä¸‹ï¼Œä¼šå‡ºç°èµ„æºäº‰æŠ¢æ¿€çƒˆçš„æƒ…å†µã€‚</p><p>Linuxè®¡æ—¶å™¨åˆ†ä¸ºä¸¤ç§ï¼šHPETå’ŒTSCï¼ŒHPETæ€§èƒ½è¾ƒå·®ï¼Œå› ä¸ºHPETé€šè¿‡ä¸²è¡Œæ¥å¤„ç†å¹¶å‘è¯·æ±‚ï¼ŒTSCæ€§èƒ½ç¨å¥½ä¸€ç‚¹ï¼Œä¼šæœ‰ä¸“é—¨çš„å¯„å­˜å™¨è®°å½•æ—¶é—´ï¼Œç¼ºç‚¹æ˜¯ç¨³å®šæ€§ä¸å¥½ï¼Œå› ä¸ºTSCæ˜¯å­˜ç¡¬ä»¶çš„è®¡æ—¶å™¨ï¼Œé¢‘ç‡å¯å˜ã€‚</p><p>åœ¨äº†è§£äº†<code>System.currentTimeMillis</code>ä¸ºä»€ä¹ˆæ…¢ä»¥åï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å®ƒåˆ°åº•æœ‰å¤šæ…¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> times = <span class="number">1000000000</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> start1 = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; times; i++) &#123;</span><br><span class="line">            <span class="keyword">long</span> t = System.currentTimeMillis();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> end1 = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;System.currentTimeMillis è€—æ—¶: &quot;</span> + (end1 - start1) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆ<code>10000</code>ã€<code>100000</code>ã€<code>1000000</code>åˆ†åˆ«è€—æ—¶<code>4ms</code>ã€<code>6ms</code>ã€<code>10ms</code>ï¼Œè€—æ—¶è¿˜æ˜¯æ¯”è¾ƒé•¿çš„ã€‚</p><h2 id="ä¼˜åŒ–æ€è·¯"><a href="#ä¼˜åŒ–æ€è·¯" class="headerlink" title="ä¼˜åŒ–æ€è·¯"></a>ä¼˜åŒ–æ€è·¯</h2><p><code>System.currentTimeMillis</code>æ…¢çš„åŸå› æ˜¯åº•å±‚è°ƒç”¨çš„ç³»ç»Ÿçº§åˆ«çš„è·å–æ—¶é—´æˆ³çš„æ–¹æ³•ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç»•å¼€ç³»ç»Ÿåº•å±‚ï¼Œæˆ‘ä»¬èµ°å†…å­˜ã€‚ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„æ–¹å¼æ˜¯ï¼šç¬¬ä¸€æ¬¡è°ƒç”¨<code>System.currentTimeMillis</code>æ–¹æ³•è®°å½•ä¸‹è¿™ä¸ªæ—¶é—´æˆ³ï¼Œç„¶åå¯åŠ¨ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ¯éš”<code>1ms</code>å»æ›´æ–°ä¸€ä¸‹è¿™ä¸ªæ—¶é—´æˆ³ï¼Œå½“æœ‰éœ€è¦è·å–è¿™ä¸ªæ—¶é—´æˆ³çš„æ—¶å€™å°±ç›´æ¥ä»å†…å­˜é‡Œé¢ æ‹¿ç°æˆçš„ï¼Œè€Œä¸ç”¨æ‰¾ç³»ç»Ÿè·å–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SystemClock</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœé¡¿æ—¶é—´é—´éš”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> period;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AtomicLong now;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SystemClock</span><span class="params">(<span class="keyword">long</span> period)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.period = period;</span><br><span class="line">        <span class="keyword">this</span>.now = <span class="keyword">new</span> AtomicLong(System.currentTimeMillis());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é™æ€å†…éƒ¨ç±»æŒæœ‰ å•ä¾‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">InstanceHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> SystemClock INSTANCE = <span class="keyword">new</span> SystemClock(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å•çº¿ç¨‹å®šæ—¶è½®è¯¢ä»»åŠ¡ï¼Œæ¯1æ¯«ç§’æ›´æ–°ä¸€æ¬¡æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">scheduleClockUpdating</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ScheduledExecutorService executorService = Executors.newSingleThreadScheduledExecutor(r -&gt; &#123;</span><br><span class="line">            Thread thread = <span class="keyword">new</span> Thread(r, <span class="string">&quot;System Clock&quot;</span>);</span><br><span class="line">            thread.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">            <span class="keyword">return</span> thread;</span><br><span class="line">        &#125;);</span><br><span class="line">        executorService.scheduleAtFixedRate(() -&gt; now.set(System.currentTimeMillis()), period, period, TimeUnit.MILLISECONDS);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å½“å‰æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½“å‰æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">currentTimeMillis</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> now.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å½“å‰æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½“å‰æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">now</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> InstanceHolder.INSTANCE.currentTimeMillis();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥çœ‹çœ‹æ—¶é—´å¯¹æ¯”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> times = <span class="number">100000</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> start1 = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; times; i++) &#123;</span><br><span class="line">            <span class="keyword">long</span> t = System.currentTimeMillis();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> end1 = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> start2 = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; times; i++) &#123;</span><br><span class="line">            <span class="keyword">long</span> t = SystemClock.now();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> end2 = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;System.currentTimeMillis è€—æ—¶: &quot;</span> + (end1 - start1) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;System Clock è€—æ—¶: &quot;</span> + (end2 - start2) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆ<code>100000</code>ã€<code>1000000</code>ã€<code>10000000</code>ã€<code>100000000</code>ä¸ªæ—¶é—´æˆ³è€—æ—¶å¯¹æ¯”</p><table><thead><tr><th>æ•°é‡</th><th>System.currentTimeMillis</th><th>SystemClock</th></tr></thead><tbody><tr><td>100000</td><td>7ms</td><td>2ms</td></tr><tr><td>1000000</td><td>13ms</td><td>4ms</td></tr><tr><td>10000000</td><td>45ms</td><td>7ms</td></tr><tr><td>100000000</td><td>485ms</td><td>41ms</td></tr></tbody></table><p>å¯è§åœ¨æ€§èƒ½ä¸Šï¼Œ<code>SystemClock</code>ç¡®å®å¼ºäº†å¾ˆå¤šã€‚</p><h2 id="ä¼˜åŒ–æ–¹æ¡ˆé—®é¢˜"><a href="#ä¼˜åŒ–æ–¹æ¡ˆé—®é¢˜" class="headerlink" title="ä¼˜åŒ–æ–¹æ¡ˆé—®é¢˜"></a>ä¼˜åŒ–æ–¹æ¡ˆé—®é¢˜</h2><p>è™½ç„¶ä¼˜åŒ–åçš„æ–¹æ¡ˆåœ¨æ€§èƒ½ä¸Šæ¯”åŸæ¥çš„ä¼ ç»Ÿæ–¹å¼å¿«äº†å¾ˆå¤šï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„é—®é¢˜ï¼š<strong>ç²¾åº¦ç¼ºå¤±</strong>ï¼Œæ–°æ–¹æ¡ˆå¹¶ä¸èƒ½ä¿è¯æ¯æ¬¡è·å–åˆ°çš„æ—¶é—´æˆ³éƒ½æ˜¯æœ€æ–°çš„ï¼Œå› æ­¤å¾ˆæœ‰å¯èƒ½å¤šä¸ªçº¿ç¨‹è·å–åˆ°çš„æ—¶é—´æˆ³æ˜¯åŒä¸€ä¸ªæ—¶é—´æˆ³ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
